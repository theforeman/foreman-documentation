:_mod-docs-content-type: PROCEDURE

[id="getting-scap-contents-from-upstream"]
= Getting SCAP contents from upstream

You can get the latest SCAP Security Guide (SSG) for various client operating systems from upstream.

.Procedure
. On your {ProjectServer}, download the SCAP contents from upstream:
+
[options="nowrap", subs="+quotes,attributes,verbatim"]
----
$ wget https://github.com/ComplianceAsCode/content/releases/download/v{ssg-version}/scap-security-guide-{ssg-version}.tar.gz && \
wget https://github.com/ComplianceAsCode/content/releases/download/v{ssg-version}/scap-security-guide-{ssg-version}.tar.gz.sha512
----
. Verify the downloaded archive:
+
[options="nowrap", subs="+quotes,attributes,verbatim"]
----
$ sha512sum --check scap-security-guide-{ssg-version}.tar.gz.sha512
----
+
Ensure that the `sha512sum` command returns `OK`.
. Extract the downloaded archive:
+
[options="nowrap", subs="+quotes,attributes,verbatim"]
----
$ tar xf scap-security-guide-{ssg-version}.tar.gz
----
. Optional: View all data-stream files:
+
[options="nowrap", subs="+quotes,attributes,verbatim"]
----
$ find scap-security-guide-{ssg-version}/ -type f -name "*-ds.xml"
----
. Create a directory for your custom SCAP cotents:
+
[options="nowrap", subs="+quotes,attributes,verbatim"]
----
# mkdir --parents /usr/share/xml/scap/custom-scap-contents/
----
. Copy the data-stream files to `/usr/share/xml/scap/custom-scap-contents/`.
* Copy data-stream files for all client operating systems:
+
[options="nowrap", subs="+quotes,attributes,verbatim"]
----
# find scap-security-guide-{ssg-version}/ -type f -name "*-ds.xml" -exec cp {} /usr/share/xml/scap/custom-scap-contents/ \;
----
* Copy data-stream files for specific client operating systems, for example, for Ubuntu 24.04:
+
[options="nowrap", subs="+quotes,attributes,verbatim"]
----
# cp scap-security-guide-{ssg-version}/ssg-ubuntu2404-ds.xml /usr/share/xml/scap/custom-scap-contents/
----
. Upload the data streams to {Project}:
+
[options="nowrap", subs="+quotes,attributes,verbatim"]
----
# hammer scap-content bulk-upload \
--directory /usr/share/xml/scap/custom-scap-contents/ \
--location "_My_Location_" \
--organization "_My_Organization_" \
--type directory
----
. Remove the archive and extracted archive directory:
+
[options="nowrap", subs="+quotes,attributes,verbatim"]
----
# rm -fr scap-security-guide-{ssg-version}.tar.gz scap-security-guide-{ssg-version}
----
