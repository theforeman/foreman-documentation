:_mod-docs-content-type: REFERENCE

[id="ref_ipxe-bootloaders_{context}"]
= iPXE / Grub2 UEFI HTTP(S) boot loaders

[role="_abstract"]
This section describes HTTP-based boot methods such as *iPXE*, *iPXE chainloading* and *Grub2 UEFI HTTP(S) Boot*, which use the {SmartProxy}’s HTTPBoot module to deliver bootloaders and installation files.

In addition to the *TFTP-based PXE* mechanism, {Project} supports boot methods that use *HTTP*.

HTTP-based boot methods include:

* *iPXE*
* *iPXE chainloading*
* *Grub2 UEFI HTTP Boot*

All of these methods leverage the {SmartProxy}’s HTTPBoot module to deliver bootloaders and installation files.

The *HTTPBoot* feature exposes the same files that are available via TFTP, but over the HTTP(S) protocol.
This can improve boot reliability in environments where TFTP is blocked, unreliable, or slow.

== Boot Methods

This section explains the two main boot workflows: *iPXE chainloading* and *iPXE*, *Grub2 UEFI HTTP(S) Boot*.
Each method offers advantages depending on the firmware type and network environment.

=== iPXE Chainloading (PXE → HTTP)

In this method, the boot process starts with a traditional PXE (TFTP) stage and then switches to HTTP for improved performance and flexibility.

*Workflow:*

1. The firmware downloads the appropriate iPXE loader via TFTP.
  * BIOS downloads `undionly-ipxe.0`.
  * UEFI downloads `ipxe.efi`.
2. iPXE then initializes the network and switches to HTTP, requesting an iPXE script such as `menu.ipxe`.

This hybrid approach enables existing PXE infrastructure to use HTTP for the later boot stages without requiring firmware-level HTTP support.

=== iPXE, Grub2 UEFI HTTP(S) Boot

In this method, UEFI firmware directly loads boot loaders using HTTP or HTTPS without any TFTP step.

*Workflow:*

1. UEFI firmware requests boot loader files from the {SmartProxy} via HTTP or HTTPS.
  * For example, it requests `ipxe-<__arch__>.efi`.
2. Grub2 then loads `grub.cfg` and starts the OS installer.

== File Locations and Roles

This section describes where iPXE and Grub2 HTTPBoot files are stored, what each file is used for,
and whether it must be provided manually or is created automatically.

. File Locations and Roles

[cols="1,1,1", options="header"]
|===
| Path
| Purpose / Usage
| User Action

| /var/lib/tftpboot/undionly-ipxe.0
| iPXE boot loader for **iPXE Chain BIOS**.
Used in BIOS environments as the first-stage loader that transitions from TFTP-based PXE to HTTP-based iPXE boot.
| Place the undionly-ipxe.0 binary in this directory.

| /var/lib/tftpboot/ipxe.efi
| iPXE boot loader for **iPXE Chain UEFI**.
Used in UEFI environments to chainload into iPXE for HTTP-based provisioning.
| Place the ipxe.efi binary in this directory.

| /var/lib/tftpboot/ipxe-<arch>.efi
| Architecture-specific iPXE binary for **iPXE UEFI HTTP** boot.
Used for direct iPXE boot via HTTP (without TFTP chainloading).
| Place the architecture-matched file (for example, ipxe-x64.efi) here.

| /var/lib/tftpboot/grub2/grub<arch>.efi
| Grub2 UEFI boot loader for **Grub2 UEFI HTTP** or **HTTPS Boot**.
Used to start UEFI installations via the {SmartProxy}’s HTTPBoot module.
| Place the corresponding architecture-specific file (for example, grubx64.efi) in this directory.

| /var/lib/tftpboot/grub2/shim<arch>.efi
| Secure Boot shim loader for Grub2.
Used when “Grub2 UEFI SecureBoot” or “Grub2 UEFI HTTPS SecureBoot” is selected.
| Place the matching shim binary (for example, shimx64.efi) in this directory.
|===

== Shared TFTP and HTTP Root

The {SmartProxy}’s *HTTPBoot* module and *TFTP* service share the same root directory. 
By default, this directory is `/var/lib/tftpboot/`.

[subs="+quotes"]
----
URL path:   http://<__smartproxy-example-com__>/httpboot/
Filesystem: /var/lib/tftpboot/
----

This mapping means that the HTTP URL path `/httpboot/` directly corresponds to the local filesystem under `/var/lib/tftpboot/`.
For example, a file located at:

----
/var/lib/tftpboot/pxegrub2/grubx64.efi
----

is available over HTTP at:
[subs="+quotes"]
----
http://<__smartproxy-example-com__>/httpboot/pxegrub2/grubx64.efi
----

This shared structure simplifies management by ensuring that both PXE (TFTP) and HTTP clients use the same set of boot loader binaries and configuration files.

== Example Directory Layout

This subsection provides an example layout of typical iPXE and HTTPBoot-related files under `/var/lib/tftpboot/`.

----
# tree /var/lib/tftpboot/
/var/lib/tftpboot/
 ├── undionly-ipxe.0
 ├── ipxe.efi
 ├── ipxe-x64.efi
 └── grub2/
      ├── grubx64.efi
      └── shimx64.efi
----

[NOTE]
====
Grub2 UEFI HTTPS Boot relies on the {SmartProxy}’s HTTPS service to securely deliver boot loader binaries (`boot.efi`, `shim*.efi`, and similar) to UEFI clients. 
The configuration for this HTTPS service is defined in the {SmartProxy}’s main settings file: 
`/etc/foreman-proxy/settings.yml`.
====
