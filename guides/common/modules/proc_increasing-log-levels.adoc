[id="Increasing_Log_Levels_{context}"]
= Increasing Log Levels

By default, {Project} comes with `:INFO` level logging enabled.
You can increase or decrease the log levels on your {Project}.

.Enabling debug level logging on all components
[options="nowrap" subs="+quotes"]
----
# hammer admin logging --all --level-debug
# {foreman-maintain} service restart
----

.Enabling debug level logging for a specific component
[options="nowrap" subs="+quotes"]
----
# hammer admin logging --components "_Component_" --level-debug
----

.Reverting debug level logging to `INFO`
[options="nowrap" subs="+quotes"]
----
# hammer admin logging --all --level-production
# {foreman-maintain} service restart
----

.Listing all components and changed configuration files
----
# hammer admin logging --list
-----------|-------------------------------------|-------------------------------------
COMPONENT  | AUTO-DETECTED BY EXISTENCE OF       | DESTINATIONS
-----------|-------------------------------------|-------------------------------------
dhcpd      | /etc/dhcp/dhcpd.conf                | syslog /var/log/dhcpd-debug.log
postgresql | /var/lib/pgsql/data/postgresql.conf | syslog /var/lib/pgsql/data/pg_log/
proxy      | /etc/foreman-proxy/settings.yml     | /var/log/foreman-proxy/proxy.log
qpidd      | /etc/qpid/qpidd.conf                | syslog
rails      | /etc/foreman/settings.yaml          | /var/log/foreman/production.log
tomcat     | /etc/candlepin/candlepin.conf       | /var/log/candlepin/ /var/log/tomcat/
virt-who   | /etc/sysconfig/virt-who             | syslog
-----------|-------------------------------------|-------------------------------------
----

== Hammer

You can find the log for Hammer in `~/.hammer/log/hammer.log`.

.Changing the log level
. Edit `/etc/hammer/cli_config.yml` and set the `:log_level:`:
+
----
:log_level: 'debug'
----

== {SmartProxy}

You can find the log for {SmartProxy} in `/var/log/foreman-proxy/proxy.log`.

.Changing the log level
. Uncomment the `DEBUG` line in `/etc/foreman-proxy/settings.yml`:
+
----
:log_level: DEBUG
----
. Restart the `foreman-proxy` service:
+
----
# systemctl restart foreman-proxy
----

[CAUTION]
====
Running the installer will revert this change back.
====

== Candlepin

You can find the log for Candlepin in `/var/log/candlepin/candlepin.log`.
Errors are also logged to a seperate file for easier debugging `/var/log/candlepin/error.log`

.Changing the log level
. Extend `/etc/candlepin/candlepin.conf`:
+
----
log4j.logger.org.candlepin=DEBUG
----
. Restart the `tomcat` service:
+
----
# systemctl restart tomcat
----
. If the candlepin log files are too verbose, you can decrease the default debug level:
+
----
log4j.logger.org.candlepin.resource.ConsumerResource=WARN
log4j.logger.org.candlepin.resource.HypervisorResource=WARN
----

== {Project}

You can find the log for {Project} in `/var/log/foreman/production.log`.

{Project} stores logs for Apache in:

* `/var/log/httpd/foreman_error.log`
* `/var/log/httpd/foreman_access.log`
* `/var/log/httpd/foreman_ssl_error.log`
* `/var/log/httpd/foreman_ssl_access.log`

.Changing the log level
. Set the logging level in `/etc/foreman/settings.yaml`:
+
----
:logging:
  :production:
    :type: file
    :layout: pattern
    :level: debug
----
. Enable selected loggers in `/etc/foreman/settings.yaml`:
+
----
:loggers:
  :ldap:
    :enabled: true
  :permissions:
    :enabled: true
  :sql:
    :enabled: true
----
+
Note that to see logging from some area, debug logging has to be set.
. Restart the {Project} services:
+
[options="nowrap" subs="+quotes"]
----
# {foreman-maintain} service restart
----

You can find the complete list of loggers with their default values in `/usr/share/foreman/config/application.rb` in the `Foreman::Logging.add_loggers` command.

== Qpid Dispatch Router

Qpid logs to syslog and can be viewed in `/var/log/messages` or with `journalctl`.

.Changing the log level
. Enable debug logging in `/etc/qpid-dispatch/qdrouterd.conf`:
+
----
enable: debug+
----
. Restart the Qpid Dispatch Router:
----
# systemctl restart qdrouterd
----

[CAUTION]
====
Running the installer will revert this change back.
====

== Qpid Broker

Qpid logs to syslog and can be viewed in `/var/log/messages` or with `journalctl`

.Changing the log level
. Set the log level in `/etc/qpid/qpidd.conf`:
+
----
log-enable=debug+
----
. Restart the Qpid Broker
+
----
# systemctl restart qpidd`
----

[CAUTION]
====
Running the installer will revert this change.
====

== Redis

You can find the log for Redis in `/var/log/redis/redis.log`.

.Changing the log level
. Set the log level in `/etc/opt/rh/rh-redis5/redis.conf`:
+
----
loglevel debug
----
. Restart the Redis service:
+
----
# systemctl restart rh-redis5-redis
----

== Postgres

You can find the log for Postgres in `/var/opt/rh/rh-postgresql12/lib/pgsql/data/log/`.

.Changing the log level
. Uncomment the `log_statement` in `/var/opt/rh/rh-postgresql12/lib/pgsql/data/postgresql.conf`:
+
----
log_statement = 'all'
----
. Restart the {Project} services:
----
# {foreman-maintain} service restart
----

[CAUTION]
====
Based on the size of your {Project} installation, this can cause disk space to fill up very quickly.
Only turn this on if absolutely needed.
====

For other debug log settings, refer to the https://www.postgresql.org/docs/current/runtime-config-logging.html[Postgresql documentation].

== {Project} Installer

You can find the log files in `/var/log/foreman-installer/`.

.To increase the log level of the {Project} Installer during an install
[options="nowrap" subs="+quotes"]
----
# {foreman-installer} --verbose-log-level debug
----

== Pulp

By default, Pulp logs to syslog and can be viewed in `/var/log/messages` or with `journalctl`.

.Changing the log level
. Add the following config to the `/etc/pulp/settings.py` file:
+
----
LOGGING = {"dynaconf_merge": True, "loggers": {'': {'handlers': ['console'], 'level': 'DEBUG'}}}
----
. Restart the Pulp services:
+
----
# systemctl restart \
pulpcore-api \
pulpcore-content \
pulpcore-resource-manager \
pulpcore-worker@1 \
pulpcore-worker@2 \
rh-redis5-redis
----
