[id="Upgrading_the_External_Database_{context}"]
= Upgrading the external database

If your {ProjectServer} uses an external database, the database will be upgraded when running `{foreman-installer}` on your {ProjectServer}.

.Prerequisites
* The external database host is running {EL} 9.
* PostgreSQL version 13 is installed on your {EL} host.

.Procedure
. Update permissions to prepare the `postgresql-evr` extension for removal:
+
[options="nowrap", subs="+quotes,verbatim,attributes"]
----
# runuser -l postgres -c \
"psql -d foreman -c \"UPDATE pg_extension SET extowner = (SELECT oid FROM pg_authid WHERE rolname='foreman') WHERE extname='evr';\""
----
. Verify that {Project} can reach the new database:
+
[options="nowrap", subs="+quotes,verbatim,attributes"]
----
# PGPASSWORD='_My_Foreman_Database_Password_' psql -h _postgres.example.com_ -p 5432 -U foreman -d foreman -c "SELECT 1 as ping"
----
ifdef::upgrading-connected[]
. Follow xref:upgrading_a_connected_{project-context}_server_{context}[].
endif::[]
ifdef::upgrading-disconnected[]
. Follow xref:upgrading_a_disconnected_{project-context}_server_{context}[].
endif::[]
