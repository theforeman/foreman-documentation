[id="Ports_and_Firewalls_Requirements_{context}"]
= Ports and Firewalls Requirements

For the components of {Project} architecture to communicate, ensure that the required network ports are open and free on the base operating system.
You must also ensure that the required network ports are open on any network-based firewalls.

Use this information to configure any network-based firewalls.
Note that some cloud solutions must be specifically configured to allow communications between machines because they isolate machines similarly to network-based firewalls.
If you use an application-based firewall, ensure that the application-based firewall permits all applications that are listed in the tables and known to your firewall.
If possible, disable the application checking and allow open port communication based on the protocol.

.Integrated {SmartProxy}
{ProjectServer} has an integrated {SmartProxy} and any host that is directly connected to {ProjectServer} is a Client of {Project} in the context of this section.
This includes the base operating system on which {SmartProxyServer} is running.

.Clients of {SmartProxy}
Hosts which are clients of {SmartProxies}, other than {Project}'s integrated {SmartProxy}, do not need access to {ProjectServer}.
ifdef::satellite[]
For more information on {Project} Topology and an illustration of port connections, see {PlanningDocURL}sect-Documentation-Architecture_Guide-Capsule_Networking[{SmartProxy} Networking] in _{PlanningDocTitle}_.
endif::[]

Required ports can change based on your configuration.

The following tables indicate the destination port and the direction of network traffic:

.{ProjectServer} incoming traffic
[cols="15%,15%,15%,15%,20%,20%",options="header]
|====
| Destination Port | Protocol | Service |Source| Required For | Description
| 53 | TCP and UDP | DNS | DNS Servers and clients | Name resolution | DNS (optional)
| 67 | UDP | DHCP | Client | Dynamic IP | DHCP (optional)
| 69 | UDP | TFTP | Client | TFTP Server (optional) |
| 443 | TCP | HTTPS | {SmartProxy} | {ProjectName} API | Communication from {SmartProxy}
ifdef::katello,satellite,orcharhino[]
| 443, 80 | TCP | HTTPS, HTTP | Client | Content Retrieval | Content
| 443, 80 | TCP | HTTPS, HTTP | {SmartProxy} | Content Retrieval | Content
| 443, 80 | TCP | HTTPS, HTTP| Client | Content Host Registration | {SmartProxy} CA RPM installation
| 443 | TCP | HTTPS | Client | Content Host registration | Initiation

Uploading facts

Sending installed packages and traces
| 443 | TCP | HTTPS | {ProjectName} | Content Mirroring | Management
| 443 | TCP | HTTPS | {ProjectName} | {SmartProxy} API | Smart Proxy functionality
| 1883 | TCP | MQTT | Client | Pull based REX (optional) | Content hosts for REX job notification (optional)
| 5646, 5647 | TCP | AMQP | {SmartProxy} | Katello agent | Forward message to Qpid dispatch router on {Project} (optional)
endif::[]
| 5910{range}5930 | TCP | HTTPS | Browsers | Compute Resource's virtual console |
| 8000 | TCP | HTTP | Client | Provisioning templates | Template retrieval for client installers, iPXE or UEFI HTTP Boot
| 8000 | TCP | HTTPS | Client | PXE Boot | Installation
| 8140 | TCP | HTTPS | Client | Puppet agent | Client updates (optional)
ifndef::katello,satellite,orcharhino[]
| 8443 | TCP | HTTPS | Client | OpenSCAP | Configure Client
| 8443 | TCP | HTTPS | {ProjectName} | {SmartProxy} API | Smart Proxy functionality
endif::[]
ifdef::katello,satellite,orcharhino[]
| 9090 | TCP | HTTPS | Client | OpenSCAP | Configure Client
| 9090 | TCP | HTTPS | Discovered Node|Discovery |Host discovery and provisioning
| 9090 | TCP | HTTPS | {ProjectName} | {SmartProxy} API | {SmartProxy} functionality
endif::[]
|====

Any managed host that is directly connected to {ProjectServer} is a client in this context because it is a client of the integrated {SmartProxy}.
This includes the base operating system on which a {SmartProxyServer} is running.

A DHCP {SmartProxy} performs ICMP ping or TCP echo connection attempts to hosts in subnets with DHCP IPAM set to find out if an IP address considered for use is free.
This behavior can be turned off using `{foreman-installer} --foreman-proxy-dhcp-ping-free-ip=false`.

NOTE: Some outgoing traffic returns to {Project} to enable internal communication and security operations.

.{ProjectServer} outgoing traffic
[cols="15%,15%,15%,15%,20%,20%",options="header"]

|====
| Destination Port | Protocol | Service | Destination | Required For | Description
| | ICMP | ping  | Client | DHCP | Free IP checking (optional)
| 7 | TCP | echo | Client | DHCP |Free IP checking (optional)
| 22 | TCP | SSH | Target host | Remote execution | Run jobs
| 22, 16514 | TCP | SSH SSH/TLS | Compute Resource | {Project} originated communications, for compute resources in libvirt |
| 53 | TCP and UDP | DNS | DNS Servers on the Internet | DNS Server | Resolve DNS records (optional)
| 53 | TCP and UDP | DNS | DNS Server | {SmartProxy} DNS | Validation of DNS conflicts (optional)
| 53 | TCP and UDP | DNS | DNS Server | Orchestration | Validation of DNS conflicts
| 68 | UDP | DHCP | Client | Dynamic IP | DHCP (optional)
| 80 | TCP | HTTP | Remote repository | Content Sync | Remote yum repository
| 389, 636 | TCP | LDAP, LDAPS | External LDAP Server | LDAP | LDAP authentication, necessary only if external authentication is enabled.
The port can be customized when `LDAPAuthSource` is defined
| 443 | TCP | HTTPS | {Project} | {SmartProxy} | {SmartProxy}

Configuration management

Template retrieval

OpenSCAP

Remote Execution result upload
| 443 | TCP | HTTPS | Amazon EC2, Azure, Google GCE | Compute resources | Virtual machine interactions (query/create/destroy) (optional)
ifdef::satellite[]
ifeval::["{mode}" == "connected"]
| 443 | TCP | HTTPS | console.redhat.com | Red{nbsp}Hat Cloud plugin API calls |
| 443 | TCP | HTTPS | Red{nbsp}Hat Portal | SOS report | Assisting support cases (optional)
| 443 | TCP | HTTPS | Red{nbsp}Hat CDN | Content Sync | Red{nbsp}Hat CDN
| 443 | TCP | HTTPS | cert-api.access.redhat.com | Telemetry data upload and report |
endif::[]
endif::[]
ifdef::katello,satellite,orcharhino[]
| 443 | TCP | HTTPS | {SmartProxy} | Content mirroring | Initiation
endif::[]
| 443 | TCP | HTTPS | Infoblox DHCP Server| DHCP management | When using Infoblox for DHCP, management of the DHCP leases (optional)
| 623 |  |  | Client | Power management | BMC On/Off/Cycle/Status
| 5000 | TCP | HTTPS | OpenStack Compute Resource | Compute resources | Virtual machine interactions (query/create/destroy) (optional)
ifdef::katello,satellite,orcharhino[]
| 5646 | TCP | AMQP | {ProjectServer} | Katello agent | Forward message to Qpid dispatch router on {SmartProxy} (optional)
| 5671 |  |  | Qpid |Remote install | Send install command to client
| 5671 |  |  | Dispatch router (hub) | Remote install | Forward message to dispatch router on {Project}
| 5671 | | | {ProjectServer} | Remote install for Katello agent | Send install command to client
| 5671 | | | {ProjectServer} | Remote install for Katello agent | Forward message to dispatch router on {Project}
endif::[]
| 5900{range}5930 | TCP | SSL/TLS | Hypervisor | noVNC console | Launch noVNC console
ifndef::satellite[]
| 5985 | TCP | HTTP | Client | WinRM | Configure Client running Windows
| 5986 | TCP | HTTPS | Client | WinRM | Configure Client running Windows
endif::[]
| 7911 | TCP | DHCP, OMAPI | DHCP Server| DHCP | The DHCP target is configured using `--foreman-proxy-dhcp-server` and defaults to localhost

ISC and `remote_isc` use a configurable port that defaults to 7911 and uses OMAPI
| 8443 | TCP | HTTPS | Client | Discovery | {SmartProxy} sends reboot command to the discovered host (optional)
ifndef::katello,satellite,orcharhino[]
| 8443 | TCP | HTTPS | {SmartProxy}| {SmartProxy} API | Management of {SmartProxies}
endif::[]
ifdef::katello,satellite,orcharhino[]
| 9090 | TCP | HTTPS | {SmartProxy}| {SmartProxy} API | Management of {SmartProxies}
endif::[]
|====
