[id="reclaiming-postgresql-space-after-an-upgrade_{context}"]
= Reclaiming PostgreSQL Space

The PostgreSQL database can use a large amount of disk space especially in heavily loaded deployments.
Use this procedure to reclaim some of this disk space on {Project}.

.Procedure

. Stop all services, except for the `postgresql` service:
+
[options="nowrap" subs="+quotes,attributes"]
----
# {foreman-maintain} service stop --exclude postgresql
----

. Switch to the `postgres` user and reclaim space on the database:
+
[options="nowrap"]
----
# su - postgres -c 'vacuumdb --full --dbname=foreman'
----

. Start the other services when the vacuum completes:
+
[options="nowrap" subs="+quotes,attributes"]
----
# {foreman-maintain} service start
----
. Confirm that the files exist in the `/var/lib/pgsql/` directory:
+
[options="nowrap" subs="+quotes,attributes"]
----
# ls -l /var/lib/pgsql/

# du -sh /var/lib/pgsq/
----

. Delete the data from the `/var/lib/pgsql/` directory:
+
[options="nowrap" subs="+quotes,attributes"]
----
# rm -rf /var/lib/pgsql/*
----
