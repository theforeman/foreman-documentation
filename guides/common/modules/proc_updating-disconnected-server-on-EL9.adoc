[id="Updating-Disconnected-{project-context}-on-EL9_{context}"]
= Updating a disconnected {ProjectServer} on {EL} 9

You can update your disconnected {Project} on {RHEL} 9 by synchronizing the required repositories on the connected {Project} and syncing the content to the disconnected {Project} using `syncable` exports.

.Procedure on the connected {ProjectServer}
. Synchronize the following repositories on your connected {ProjectServer}:
+
* {RepoRHEL9BaseOS}
* {RepoRHEL9AppStream}
* {RepoRHEL9ServerSatelliteServerProjectVersion}

. Export the repositories in the syncable format:
+
[options="nowrap" subs="+quotes,verbatim,attributes"]
----
$ hammer content-export complete repository \
--id=_Repo_ID_ --format=syncable
----
. Copy the exported directories to the disconnected {ProjectServer}.

.Procedure on the disconnected {ProjectServer}
. Locate the copied exported directories.
. Create the `/etc/yum.repos.d/upgrade.repo` file and update the `baseurl` values to point to the local file system:
+
[options="nowrap" subs="+quotes,verbatim,attributes"]
----
[{RepoRHEL9BaseOS}]
name=Red Hat Enterprise Linux 9 for x86_64 - BaseOS (RPMs)
metadata_expire=-1
gpgcheck=0
cost=500
baseurl=file:///<export baseos location>/content/dist/rhel9/9/x86_64/baseos/os
[{RepoRHEL9AppStream}]
name=Red Hat Enterprise Linux 9 for x86_64 - AppStream (RPMs)
mediaid=None
metadata_expire=-1
gpgcheck=0
cost=500
baseurl=file:///<export appstream location>/content/dist/rhel9/9/x86_64/appstream/os
[{Project}]
name={Project}
mediaid=None
metadata_expire=-1
gpgcheck=0
cost=500
baseurl=file:///<export location>/content/dist/layered/rhel8/x86_64/{project-context}/{ProjectVersion}/os/
----
+
. Upgrade {foreman-maintain} to the next version:
+
[options="nowrap" subs="attributes"]
----
# {foreman-maintain} self-upgrade --maintenance-repo-label={Project}
----
. Evaluate that the system is ready for update.
The first time you run this command, `{foreman-maintain}` prompts you to enter the hammer admin user credentials and saves them to `/etc/foreman-maintain/foreman-maintain-hammer.yml`.
+
[options="nowrap" subs="+quotes,verbatim,attributes"]
----
# {foreman-maintain} update check --whitelist="repositories-validate,repositories-setup" \
--target-version={ProjectVersion}
----
. Review the results and resolve any errors before proceeding with the update.
. Due to the lengthy update time, use a utility such as `tmux` to suspend and resume the session as needed.
Using such utility, you can monitor progress without maintaining a continuous connection to the command shell.
+
If the update process us interrupted, check `{installer-log-file}` to confirm whether the process completed successfully.
. Perform the update:
+
[options="nowrap" subs="+quotes,verbatim,attributes"]
----
# {foreman-maintain} update run --whitelist="repositories-validate,repositories-setup" \
--target-version={ProjectVersion}
----

include::snip_steps-needs-reboot.adoc[]

.Additional resources
* To restore a backup of the {ProjectServer} or {SmartProxyServer}, see {AdministeringDocURL}Restoring_from_a_Full_Backup_admin[Restoring {ProjectServer} or {SmartProxyServer} from a Backup].