:_mod-docs-content-type: PROCEDURE

[id="adding-{project-context}-server-ssh-key-to-authorized-keys"]
= Adding {ProjectServer} SSH key to authorized keys

[role="_abstract"]
If you want to run remote execution jobs on {ProjectServer} itself, add the following SSH key to authorized keys on your {ProjectServer}.

////
This should be possible with the command:
   {foreman-installer} --foreman-proxy-plugin-remote-execution-script-install-key
but the command does not do anything on an already installed {ProjectServer}
Bug: https://issues.redhat.com/browse/SAT-41239
////

.Prerequisites
* You can access your {ProjectServer} by using SSH as root.

.Procedure
. If the `/root/.ssh/authorized_keys` file does not exist, create it with restrictive ownership and permissions:
.. If the `/root/.ssh` directory does not exist, create it:
+
[options="nowrap", subs="+quotes,verbatim,attributes"]
----
# mkdir /root/.ssh
----
.. Ensure that the directory is owned by the `root` user:
+
[options="nowrap", subs="+quotes,verbatim,attributes"]
----
# chown root:root /root/.ssh
----
.. Ensure that the directory is accessible only to the `root` user:
+
[options="nowrap", subs="+quotes,verbatim,attributes"]
----
# chmod 700 /root/.ssh
----
.. Create the `authorized_keys` file:
+
[options="nowrap", subs="+quotes,verbatim,attributes"]
----
# touch /root/.ssh/authorized_keys
----
.. Ensure that the `authorized_keys` file is owned by the `root` user:
+
[options="nowrap", subs="+quotes,verbatim,attributes"]
----
# chown root:root /root/.ssh/authorized_keys
----
.. Ensure that the `authorized_keys` file is accessible only to the `root` user:
+
[options="nowrap", subs="+quotes,verbatim,attributes"]
----
# chmod 600 /root/.ssh/authorized_keys
----
. Add the SSH key of the `foreman-proxy` user to the `authorized_keys` file:
+
[options="nowrap", subs="+quotes,verbatim,attributes"]
----
# cat /var/lib/foreman-proxy/ssh/id_rsa_foreman_proxy.pub >>/root/.ssh/authorized_keys
----
