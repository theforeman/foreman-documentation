[[implementing-pxe-less-discovery]]
= Implementing PXE-less Discovery

{Project} provides a PXE-less Discovery service that operates without the need for PXE-based services (DHCP and TFTP). You accomplish this using {ProjectServer}'s Discovery image. Once a discovered node is scheduled for installation, it uses `kexec` command to reload Linux kernel with OS installer without rebooting the node.

ifeval::["{build}" == "satellite"]
[NOTE]
Discovery `kexec` is a Technology Preview feature.
endif::[]

image::PXEless-mode.png[]

If you have not yet installed the Discovery service or image, see xref:building-a-discovery-image[].

The ISO for the Discovery service resides at `/usr/share/foreman-discovery-image/` and is installed using the `foreman-discovery-image` package.

.Attended Use

This ISO acts as bootable media. Copy this media to either a CD, DVD, or a USB stick. For example, to copy to a USB stick at `/dev/sdb`:

[options="nowrap" subs="+quotes"]
----
# dd bs=4M \
if=/usr/share/foreman-discovery-image/foreman-discovery-image-3.4.4-5.iso \
of=/dev/sdb
----

. Insert the Discovery boot media into a bare metal host, start the host, and boot from the media. The Discovery Image displays an option for either *Manual network setup* or *Discovery with DHCP*:

  - If selecting *Manual network setup*, the Discovery image requests a set of network options. This includes the primary network interface that connects to {ProjectServer}. This Discovery image also asks for network interface configuration options, such as an *IPv4 Address*, *IPv4 Gateway*, and an *IPv4 DNS* server.
. After entering these details, select *Next*.
. If you select *Discovery with DHCP*, the Discovery image requests only the primary network interface that connects to {ProjectServer}. It attempts to automatically configure the network interface using a DHCP server, such as one that a {SmartProxyServer} provides.
. After the primary interface configuration, the Discovery image requests the *Server URL*, which is the URL of {ProjectServer} or {SmartProxyServer} offering the Discovery service. For example, to use the integrated {SmartProxy} on {ProjectServer}, use the following URL:
+
[options="nowrap" subs="+quotes,attributes"]
----
https://{foreman-example-com}:{smartproxy_port}
----
+
. Set the *Connection type* to `Proxy`, then select *Next*.

. Optional: The Discovery image also provides a set of fields to input *Custom facts* for the Facter tool to relay back to {ProjectServer}. These are entered in a *name*-*value* format. Provide any custom facts you require and select *Confirm* to continue.

The {Project} reports a successful communication with {ProjectServer}'s Discovery service. Navigate to *Hosts* > *Discovered Hosts* and view the newly discovered host.

For more information about provisioning discovered hosts, see xref:creating-hosts-from-discovered-hosts[].
