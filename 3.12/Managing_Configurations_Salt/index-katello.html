<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<title>Configuring hosts by using Salt</title>
<style>
﻿*,::before,::after{box-sizing:border-box}html{font-size:100%;-webkit-text-size-adjust:100%}body{background:#fff;color:rgba(0,0,0,0.8);padding:0;margin:0;font-family:"Noto Serif", "DejaVu Serif", serif;font-size:inherit;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,pre,p,blockquote,th,td{margin:0;padding:0}a{background:none;color:#2156a5;text-decoration:underline;line-height:inherit}a:active,a:hover{cursor:pointer;outline:0}a:focus{outline:thin dotted}a:hover,a:focus{color:#1d4b8f}abbr{font-size:0.9em}abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}b,strong{font-weight:bold;line-height:inherit}strong strong{font-weight:400}code,kbd,pre{font-family:"Droid Sans Mono", "DejaVu Sans Mono", monospace;font-size:1em}code{font-weight:400;color:rgba(0,0,0,0.9)}pre{color:rgba(0,0,0,0.9);line-height:1.45;text-rendering:optimizeSpeed;white-space:pre-wrap}dfn{font-style:italic}em,i{font-style:italic;line-height:inherit}em em{font-style:normal}hr{border:solid #dddddf;border-width:1px 0 0;clear:both;height:0;margin:1.25em 0 1.1875em}mark{background:#ff0;color:#000}p{line-height:1.6;margin-bottom:1.25rem;text-rendering:optimizeLegibility}q{quotes:"“" "”" "‘" "’"}small{font-size:60%;line-height:inherit}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-0.5em}sub{bottom:-0.25em}img,object[type^="image/"],svg{display:inline-block;height:auto;max-width:100%;vertical-align:middle}img{border:0;-ms-interpolation-mode:bicubic}object{max-width:100%}svg:not(:root){overflow:hidden}figure{margin:0}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}.left{float:left !important}.right{float:right !important}.text-left{text-align:left !important}.text-right{text-align:right !important}.text-center{text-align:center !important}.text-justify{text-align:justify !important}.hide{display:none}.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:0.25em}p aside{font-size:.875em;line-height:1.35;font-style:italic}h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans", "DejaVu Sans", sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.2;word-spacing:-0.05em}h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{color:#e99b8f;line-height:0}h1{font-size:2.125em}h2{font-size:1.6875em}h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}h4,h5{font-size:1.125em}h6{font-size:1em}ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}ul,ol{margin-left:1.5em}ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}ul.square{list-style-type:square}ul.circle{list-style-type:circle}ul.disc{list-style-type:disc}ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}dl dt{margin-bottom:.3125em;font-weight:bold}dl dd{margin-bottom:1.25em;margin-left:1.125em}blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,0.85)}@media screen and (min-width: 768px){h1{font-size:2.75em}h2{font-size:2.3125em}h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}h4{font-size:1.4375em}}table{background:#fff;border:1px solid #dedede;border-collapse:collapse;border-spacing:0;margin-bottom:1.25em;word-wrap:normal}table thead,table tfoot{background:#f7f8f7}table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,0.8);text-align:left}table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,0.8)}table tr.even,table tr.alt{background:#f8f8f7}table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}.center{margin-left:auto;margin-right:auto}.stretch{width:100%}.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:"";display:table}.clearfix::after,.float-group::after{clear:both}:not(pre).nobreak{word-wrap:normal}:not(pre).nowrap{white-space:nowrap}:not(pre).pre-wrap{white-space:pre-wrap}:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal !important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}pre>code{display:block}pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}.keyseq{color:rgba(51,51,51,0.8)}kbd{display:inline-block;color:rgba(0,0,0,0.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,0.2),inset 0 0 0 0.1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}.keyseq kbd:first-child{margin-left:0}.keyseq kbd:last-child{margin-right:0}.menuseq,.menuref{color:#000}.menuseq b:not(.caret),.menuref{font-weight:inherit}.menuseq{word-spacing:-0.02em}.menuseq b.caret{font-size:1.25em;line-height:0.8}.menuseq i.caret{font-weight:bold;text-align:center;width:0.45em}b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}b.button::before{content:"[";padding:0 3px 0 2px}b.button::after{content:"]";padding:0 2px 0 3px}p a>code:hover{color:rgba(0,0,0,0.9)}body>div[id]{margin:0 auto;max-width:62.5em;position:relative;padding-left:.9375em;padding-right:0.9375em}body>div[id]::before,body>div[id]::after,#content #footnotes::before{content:"";display:table;clear:both}#content{margin-top:1.25em;margin-bottom:0.625em}#content::before{content:none}#header>h1:first-child{color:rgba(0,0,0,0.85);margin-top:2.25rem;margin-bottom:0}#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,0.6);display:flex;flex-flow:row wrap}#header .details span:first-child{margin-left:-0.125em}#header .details span.email a{color:rgba(0,0,0,0.85)}#header .details br{display:none}#header .details br+span::before{content:" – "}#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,0.85)}#header .details br+span#revremark::before{content:" | "}#header #revnumber{text-transform:capitalize}#header #revnumber::after{content:" "}#content>h1:first-child:not([class]){color:rgba(0,0,0,0.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}#toc{border-bottom:1px solid #e7e7e9;padding-bottom:0.5em}#toc>ul{margin-left:0.125em}#toc ul.sectlevel0>li>a{font-style:italic}#toc ul.sectlevel0 ul.sectlevel1{margin:0.5em 0}#toc ul{font-family:"Open Sans", "DejaVu Sans", sans-serif;list-style-type:none}#toc li{line-height:1.3334;margin-top:0.3334em}#toc a{text-decoration:none}#toc a:active{text-decoration:underline}#toctitle{color:#7a2518;font-size:1.2em}@media screen and (min-width: 768px){#toctitle{font-size:1.375em}body.toc2{padding-left:15em;padding-right:0}#toc.toc2{margin-top:0 !important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0 !important;border-bottom-width:0 !important;z-index:1000;padding:1.25em 1em;height:calc(100% - (70px + 2.5em));overflow:auto}#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}#toc.toc2>ul{font-size:.9em;margin-bottom:0}#toc.toc2 ul ul{margin-left:0;padding-left:1em}#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:0.5em}body.toc2.toc-right{padding-left:0;padding-right:15em}body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}@media screen and (min-width: 1280px){body.toc2{padding-left:20em;padding-right:0}#toc.toc2{width:20em}#toc.toc2 #toctitle{font-size:1.375em}#toc.toc2>ul{font-size:0.95em}#toc.toc2 ul ul{padding-left:1.25em}body.toc2.toc-right{padding-left:0;padding-right:20em}}#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}#content #toc>:first-child{margin-top:0}#content #toc>:last-child{margin-bottom:0}#footer{max-width:none;background:#025d8c;padding:1.25em;margin-left:2em}#footer-text{color:rgba(255,255,255,0.8);line-height:1.44}.sect1{padding-bottom:0.625em}@media screen and (min-width: 768px){#content{margin-bottom:1.25em}.sect1{padding-bottom:1.25em}}.sect1:last-child{padding-bottom:0}.sect1+.sect1{border-top:1px solid #e7e7e9}#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none !important;visibility:hidden;text-align:center;font-weight:400}#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:0.1em}#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}details{margin-left:1.25rem}details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}details>summary::-webkit-details-marker{display:none}details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif", "DejaVu Serif", serif;font-size:1rem;font-style:italic}table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,0.85)}.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}.admonitionblock>table td.icon{text-align:center;width:80px}.admonitionblock>table td.icon img{max-width:none}.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans", "DejaVu Sans", sans-serif;text-transform:uppercase}.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,0.6);word-wrap:anywhere}.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}.exampleblock>.content{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#fffef7;border-radius:4px;box-shadow:0 1px 4px #e0e0dc}.exampleblock>.content>:first-child{margin-top:0}.exampleblock>.content>:last-child{margin-bottom:0}.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}.sidebarblock>:first-child{margin-top:0}.sidebarblock>:last-child{margin-bottom:0}.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:0.8125em}@media screen and (min-width: 768px){.literalblock pre,.listingblock>.content>pre{font-size:0.90625em}}@media screen and (min-width: 1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,0.9)}.listingblock>.content{position:relative}.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:0.5}.listingblock:hover code[data-lang]::before{display:block}.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:0.5}.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}.listingblock pre.highlightjs{padding:0}.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}.listingblock pre.prettyprint{border-width:0}.prettyprint{background:#f7f7f8}pre.prettyprint .linenums{line-height:1.45;margin-left:2em}pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}pre.prettyprint li code[data-lang]::before{opacity:1}pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}table.linenotable td.code{padding-left:0.75em}table.linenotable td.linenos{width:0.01%}table.linenotable td.linenos,pre.pygments .linenos,pre.rouge .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}pre.pygments span.linenos,pre.rouge span.linenos{display:inline-block;margin-right:0.75em}.quoteblock{margin:0 1em 1.25em 1.5em;display:table}.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:0.75em}.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,0.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}.quoteblock blockquote{margin:0;padding:0;border:0}.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,0.1)}.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}.verseblock{margin:0 1em 1.25em}.verseblock pre{font-family:"Open Sans", "DejaVu Sans", sans-serif;font-size:1.15rem;color:rgba(0,0,0,0.85);font-weight:300;text-rendering:optimizeLegibility}.verseblock pre strong{font-weight:400}.verseblock .attribution{margin-top:1.25rem;margin-left:0.5ex}.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}.quoteblock .attribution br,.verseblock .attribution br{display:none}.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,0.6)}.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}.quoteblock.abstract{margin:0 1em 1.25em;display:block}.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:0.25em solid #dddddf}.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}p.tableblock:last-child{margin-bottom:0}td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}td.tableblock>.content>:last-child{margin-bottom:-1.25em}table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}table.grid-all>*>tr>*{border-width:1px}table.grid-cols>*>tr>*{border-width:0 1px}table.grid-rows>*>tr>*{border-width:1px 0}table.frame-all{border-width:1px}table.frame-ends{border-width:1px 0}table.frame-sides{border-width:0 1px}table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}th.halign-left,td.halign-left{text-align:left}th.halign-right,td.halign-right{text-align:right}th.halign-center,td.halign-center{text-align:center}th.valign-top,td.valign-top{vertical-align:top}th.valign-bottom,td.valign-bottom{vertical-align:bottom}th.valign-middle,td.valign-middle{vertical-align:middle}table thead th,table tfoot th{font-weight:bold}tbody tr th{background:#f7f8f7}tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,0.8);font-weight:bold}p.tableblock>code:only-child{background:none;padding:0}p.tableblock{font-size:1em}ol{margin-left:1.75em}ul li ol{margin-left:1.5em}dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:0.625em}ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:0.625em}ul.unstyled,ol.unstyled{margin-left:0}li>p:empty:only-child::before{content:"";display:inline-block}ul.checklist>li>p:first-child{margin-left:-1em}ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:0.125em}ul.checklist>li>p:first-child>input[type=checkbox]:first-child{font:inherit;margin:0 .25em 0 0;padding:0}ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 0.625em -1.25em}ul.inline>li{margin-left:1.25em}.unstyled dl dt{font-weight:400;font-style:normal}ol.arabic{list-style-type:decimal}ol.decimal{list-style-type:decimal-leading-zero}ol.loweralpha{list-style-type:lower-alpha}ol.upperalpha{list-style-type:upper-alpha}ol.lowerroman{list-style-type:lower-roman}ol.upperroman{list-style-type:upper-roman}ol.lowergreek{list-style-type:lower-greek}.hdlist>table,.colist>table{border:0;background:none}.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}td.hdlist1,td.hdlist2{vertical-align:top;padding:0 0.625em}td.hdlist1{font-weight:bold;padding-bottom:1.25em}td.hdlist2{word-wrap:anywhere}.literalblock+.colist,.listingblock+.colist{margin-top:-0.5em}.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}.colist td:not([class]):first-child img{max-width:none}.colist td:not([class]):last-child{padding:0.25em 0}.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}.imageblock.left{margin:0.25em 0.625em 1.25em 0}.imageblock.right{margin:0.25em 0 1.25em 0.625em}.imageblock>.title{margin-bottom:0}.imageblock.thumb,.imageblock.th{border-width:6px}.imageblock.thumb>.title,.imageblock.th>.title{padding:0 0.125em}.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}.image.left{margin-right:0.625em}.image.right{margin-left:0.625em}a.image{text-decoration:none;display:inline-block}a.image object{pointer-events:none}sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}sup.footnote a,sup.footnoteref a{text-decoration:none}sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:0.625em}#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:0.2em}#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}#footnotes .footnote:last-of-type{margin-bottom:0}#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:0.75em 0}div.page-break{display:none}div.unbreakable{page-break-inside:avoid}.big{font-size:larger}.small{font-size:smaller}.underline{text-decoration:underline}.overline{text-decoration:overline}.line-through{text-decoration:line-through}.aqua{color:#00bfbf}.aqua-background{background:#00fafa}.black{color:#000}.black-background{background:#000}.blue{color:#0000bf}.blue-background{background:#0000fa}.fuchsia{color:#bf00bf}.fuchsia-background{background:#fa00fa}.gray{color:#606060}.gray-background{background:#7d7d7d}.green{color:#006000}.green-background{background:#007d00}.lime{color:#00bf00}.lime-background{background:#00fa00}.maroon{color:#600000}.maroon-background{background:#7d0000}.navy{color:#000060}.navy-background{background:#00007d}.olive{color:#606000}.olive-background{background:#7d7d00}.purple{color:#600060}.purple-background{background:#7d007d}.red{color:#bf0000}.red-background{background:#fa0000}.silver{color:#909090}.silver-background{background:#bcbcbc}.teal{color:#006060}.teal-background{background:#007d7d}.white{color:#bfbfbf}.white-background{background:#fafafa}.yellow{color:#bfbf00}.yellow-background{background:#fafa00}span.icon>.fa{cursor:default}a span.icon>.fa{cursor:inherit}.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,0.5);cursor:default}.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,0.8);color:#111}.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}.conum[data-value]{display:inline-block;color:#fff !important;background:rgba(0,0,0,0.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans", "DejaVu Sans", sans-serif;font-style:normal;font-weight:bold}.conum[data-value] *{color:#fff !important}.conum[data-value]+b{display:none}.conum[data-value]::after{content:attr(data-value)}pre .conum[data-value]{position:relative;top:-0.125em}b.conum *{color:inherit !important}.conum:not([data-value]):empty{display:none}dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}h1,h2,p,td.content,span.alt,summary{letter-spacing:-0.01em}p strong,td.content strong,div.footnote strong{letter-spacing:-0.005em}p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}.print-only{display:none !important}@page{margin:1.25cm 0.75cm}@media print{*{box-shadow:none !important;text-shadow:none !important}html{font-size:80%}a{color:inherit !important;text-decoration:underline !important}a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none !important}a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:0.25em}abbr[title]{border-bottom:1px dotted}abbr[title]::after{content:" (" attr(title) ")"}pre,blockquote,tr,img,object,svg{page-break-inside:avoid}thead{display:table-header-group}p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}body>div[id]{max-width:none}#toc,.sidebarblock,.exampleblock>.content{background:none !important}#toc{border-bottom:1px solid #dddddf !important;padding-bottom:0 !important}body.book #header{text-align:center}body.book #header>h1:first-child{border:0 !important;margin:2.5em 0 1em}body.book #header .details{border:0 !important;display:block;padding:0 !important}body.book #header .details span:first-child{margin-left:0 !important}body.book #header .details br{display:block}body.book #header .details br+span::before{content:none !important}body.book #toc{border:0 !important;text-align:left !important;padding:0 !important;margin:0 !important}body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}.listingblock code[data-lang]::before{display:block}div.page-break{display:block;page-break-after:always}#footer{padding:0 0.9375em}.hide-on-print{display:none !important}.print-only{display:block !important}.hide-for-print{display:none !important}.show-for-print{display:inherit !important}}@media amzn-kf8, print{#header>h1:first-child{margin-top:1.25rem}.sect1{padding:0 !important}.sect1+.sect1{border:0}#footer{background:none}#footer-text{color:rgba(0,0,0,0.6);font-size:0.9em}}@media amzn-kf8{body>div[id]{padding:0}}body{padding:0;margin:0;margin-top:70px !important}.container{position:relative;z-index:1;padding-top:50px;min-height:100%}.container p{font-family:sans-serif;font-size:1.2em}nav{position:fixed;z-index:9999;left:0;right:0;top:0;height:70px;padding:0 1.5em;background-color:#025d8c;font-family:sans-serif;line-height:70px}nav .logo{width:50px;vertical-align:middle}nav .nav-menu{position:absolute;right:0.3em;top:0;padding:0;margin:0;list-style:none}nav .nav-item{display:inline-block}nav .nav-item>a{display:inline-block;padding:0 2.5em;line-height:70px;color:#fff;text-decoration:none}nav .dropdown{position:relative}nav .dropdown a::after{content:"";display:inline-block;margin-left:0.5em;vertical-align:middle;border-top:0.3em solid #fff;border-right:0.3em solid transparent;border-left:0.3em solid transparent}nav .dropdown.show a::after{transform:rotate(180deg)}nav .dropdown-menu{display:none;position:absolute;left:0;right:0;top:100%;padding:0.5em 0;margin-top:-0.5em;border:1px solid rgba(0,0,0,0.3);border-radius:0.5em;background-color:#fff;width:max-content}nav .dropdown-menu-left{left:auto;right:0}nav .dropdown.show .dropdown-menu{display:block}nav .dropdown-div{display:block;padding:0.4em 0;line-height:4em}nav .dropdown-div a::after{content:none;margin-left:0;border-top:0;border-right:0;border-left:0}nav .dropdown-item{display:block;padding:0 1.5em;font-size:0.875em;color:#000;line-height:1.6em;text-decoration:none}nav .btn-hamburger{display:none;position:absolute;right:1.5em;top:50%;background-color:transparent;border:0;cursor:pointer;outline:none;transform:translateY(-50%)}nav .btn-hamburger span{display:block;width:30px;height:4px;background-color:#fff;margin:6px;border-radius:2px;transition:0.3s ease-in-out}nav .btn-hamburger span:nth-child(4),nav .btn-hamburger span:nth-child(5){position:absolute;top:10px;opacity:0.5}nav .btn-hamburger span:nth-child(4){transform:rotate(45deg) scale(0)}nav .btn-hamburger span:nth-child(5){transform:rotate(-45deg) scale(0)}nav.opened .btn-hamburger span:nth-child(4){opacity:1;transform:rotate(45deg) scale(1)}nav.opened .btn-hamburger span:nth-child(5){opacity:1;transform:rotate(-45deg) scale(1)}nav.opened .btn-hamburger span:nth-child(1),nav.opened .btn-hamburger span:nth-child(2),nav.opened .btn-hamburger span:nth-child(3){opacity:0}@media screen and (max-width: 768px){nav .nav-menu{position:fixed;left:0;right:0;top:70px;bottom:100%;display:flex;flex-direction:column;justify-content:start;background-color:#363d4e;transition:bottom 0.5s ease-in-out;overflow:hidden}nav.opened .nav-menu{bottom:0}nav .nav-item>a{display:block}nav .dropdown-menu{position:relative;top:0;margin:0 1.5em}nav .btn-hamburger{display:block}}@media screen{div.narrow{max-width:1080px;margin:0 auto !important;margin-top:70px auto !important;float:none !important}#toc.toc2{margin-top:70px !important}}

</style>
<!-- docinfo -->
</head>
<body class="book toc2 toc-left">
    <div id="wrap">
      <script src="/js/versions.js"></script>
      <script src="/js/nav.js"></script>
      <script>
        document.open();
        document.write(buildNavigation());
        addNavbarListeners();
        document.close();
      </script>
    </div>
<div id="header">
<h1>Configuring hosts by using Salt</h1>
<div class="details">
<span id="revnumber">version 3.12 (unsupported),</span>
<span id="revdate">published Sep 05 2024</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#Introduction_to_Salt_managing-configurations-salt">1. Introduction to Salt</a></li>
<li><a href="#Salt_Architecture_managing-configurations-salt">2. Salt architecture</a></li>
<li><a href="#Installing_the_Salt_plugin_managing-configurations-salt">3. Installing the Salt plugin</a></li>
<li><a href="#Configuring_Salt_managing-configurations-salt">4. Configuring Salt</a>
<ul class="sectlevel2">
<li><a href="#Configuring_Salt_on_foreman_Server_managing-configurations-salt">4.1. Configuring Salt on Foreman&#160;server</a></li>
<li><a href="#Authenticating_Salt_Minions_Using_Salt_Autosign_Grains_managing-configurations-salt">4.2. Authenticating Salt Minions using Salt autosign Grains</a></li>
<li><a href="#Authenticating_Salt_Minions_Using_Host_Names_managing-configurations-salt">4.3. Authenticating Salt Minions using host names</a></li>
<li><a href="#Enabling_Salt_Grain_Uploads_managing-configurations-salt">4.4. Enabling Salt Grain uploads</a></li>
<li><a href="#Configuring_the_Salt_API_managing-configurations-salt">4.5. Configuring the Salt API</a></li>
<li><a href="#Activating_Salt_managing-configurations-salt">4.6. Activating Salt</a></li>
</ul>
</li>
<li><a href="#Setting_Up_Salt_Minions_managing-configurations-salt">5. Setting up Salt Minions</a>
<ul class="sectlevel2">
<li><a href="#Providing_the_Salt_Client_to_Salt_Minions_managing-configurations-salt">5.1. Providing the Salt Client to Salt Minions</a></li>
<li><a href="#Creating_a_Host_Group_with_Salt_managing-configurations-salt">5.2. Creating a host group with Salt</a></li>
<li><a href="#Deploying_Salt_Minion_Hosts_managing-configurations-salt">5.3. Deploying Salt Minion hosts</a></li>
<li><a href="#Verifying_the_Connection_between_Salt_Master_and_Salt_Minions_managing-configurations-salt">5.4. Verifying the connection between Salt Master and Salt Minions</a></li>
</ul>
</li>
<li><a href="#Using_Salt_managing-configurations-salt">6. Using Salt</a>
<ul class="sectlevel2">
<li><a href="#Using_the_Salt_Hammer_CLI_managing-configurations-salt">6.1. Using the Salt Hammer CLI</a></li>
<li><a href="#Using_the_Salt_API_managing-configurations-salt">6.2. Using the Salt API</a></li>
<li><a href="#Importing_Salt_States_managing-configurations-salt">6.3. Importing Salt States</a></li>
<li><a href="#Viewing_Salt_Autosign_Keys_managing-configurations-salt">6.4. Viewing Salt autosign keys</a></li>
<li><a href="#Enabling_Salt_Report_Uploads_managing-configurations-salt">6.5. Enabling Salt report uploads</a></li>
<li><a href="#Viewing_Salt_Reports_managing-configurations-salt">6.6. Viewing Salt reports</a></li>
<li><a href="#Salt_Variables_managing-configurations-salt">6.7. Salt variables</a></li>
<li><a href="#Viewing_ENC_Parameters_managing-configurations-salt">6.8. Viewing ENC parameters</a></li>
<li><a href="#Running_Salt_managing-configurations-salt">6.9. Running Salt</a></li>
</ul>
</li>
<li><a href="#Salt_Example_managing-configurations-salt">7. Salt example</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="Introduction_to_Salt_managing-configurations-salt"><a class="anchor" href="#Introduction_to_Salt_managing-configurations-salt"></a>1. Introduction to Salt</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can use Salt as a configuration management tool similar to <a href="https://docs.theforeman.org/3.12/Managing_Configurations_Ansible/index-katello.html#">Ansible</a> or <a href="https://docs.theforeman.org/3.12/Managing_Configurations_Puppet/index-katello.html#">Puppet</a>.</p>
</div>
<div class="paragraph">
<p>This guide describes how to use Salt for configuration management in Foreman.
This guide contains information about how to install the Salt plugin, how to integrate Foreman with an existing Salt Master, and how to configure hosts with Salt.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Salt offers two distinct modes of operation:
Clientless by using SSH or the Salt Minion client software.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p>The <a href="https://docs.saltproject.io/en/latest/">official Salt documentation</a> is a good entry point when starting with Salt.</p>
</li>
<li>
<p>You can download the Salt packages from the <a href="https://repo.saltproject.io/">official Salt package repository</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Salt_Architecture_managing-configurations-salt"><a class="anchor" href="#Salt_Architecture_managing-configurations-salt"></a>2. Salt architecture</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You need a Salt Master that either runs on your Foreman&#160;server or Smart&#160;Proxy&#160;server with the Salt plugin enabled.
You can also use an existing Salt Master by installing and configuring the relevant Smart&#160;Proxy features on the existing Salt Master host.</p>
</div>
<div class="paragraph">
<p>For more information on installing a Salt Master, consult the <a href="https://docs.saltproject.io/en/latest/">official Salt documentation</a>.
Alternatively, use the bootstrap instructions found in the <a href="https://repo.saltproject.io/">official Salt package repository</a>.</p>
</div>
<div class="ulist">
<div class="title">Terminology</div>
<ul>
<li>
<p>Hosts are referred to as <em>Salt Minions</em>.</p>
</li>
<li>
<p>Information in form of key-value pairs gathered from Salt Minions is referred to as <em>Salt Grains</em>.</p>
</li>
<li>
<p>Configuration templates are referred to as <em>Salt States</em>.</p>
</li>
<li>
<p>Bundles of Salt States are referred to as <em>Salt Environments</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Use the same Salt version on the Salt Master as you are using on your Salt Minions.
You can use content management in Foreman to provide hosts with the correct version of the Salt Minion client software.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Required ports from Salt Master to Salt Minions</caption>
<colgroup>
<col style="width: 24%;">
<col style="width: 20%;">
<col style="width: 18%;">
<col style="width: 38%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Port</th>
<th class="tableblock halign-left valign-top">Protocol</th>
<th class="tableblock halign-left valign-top">Service</th>
<th class="tableblock halign-left valign-top">Required For</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4505 and 4506</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTPS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Salt Master to Salt Minions</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9191</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTPS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Salt API</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="Installing_the_Salt_plugin_managing-configurations-salt"><a class="anchor" href="#Installing_the_Salt_plugin_managing-configurations-salt"></a>3. Installing the Salt plugin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To configure hosts with Salt, you must install the Salt plugin.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>On your Foreman&#160;server, install the Salt plugin:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-installer \
--enable-foreman-plugin-salt \
--enable-foreman-proxy-plugin-salt</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Configuring_Salt_managing-configurations-salt"><a class="anchor" href="#Configuring_Salt_managing-configurations-salt"></a>4. Configuring Salt</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After you have installed the Salt plugin, you need to connect it to a Salt Master.
This is required when adding Salt support to an existing Foreman installation, when adding an existing Salt Master to Foreman, or when setting up Salt on Smart&#160;Proxy.</p>
</div>
<div class="paragraph">
<p>Perform all actions on your Salt Master unless noted otherwise.
This is either your Foreman&#160;server or Smart&#160;Proxy&#160;server with Salt enabled.</p>
</div>
<div class="sect2">
<h3 id="Configuring_Salt_on_foreman_Server_managing-configurations-salt"><a class="anchor" href="#Configuring_Salt_on_foreman_Server_managing-configurations-salt"></a>4.1. Configuring Salt on Foreman&#160;server</h3>
<div class="paragraph">
<p>You need to configure Foreman&#160;server to use the Salt plugin.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>On your Foreman&#160;server, extend the <code>/etc/sudoers</code> file to allow the <code>foreman-proxy</code> user to run Salt:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">Cmd_Alias SALT = /usr/bin/salt, /usr/bin/salt-key
foreman-proxy ALL = NOPASSWD: SALT
Defaults:foreman-proxy !requiretty</pre>
</div>
</div>
</li>
<li>
<p>On your Foreman&#160;server, add a user called <code>saltuser</code> to access the Salt API:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># adduser --no-create-home --shell /bin/false --home-dir / saltuser
# passwd saltuser</pre>
</div>
</div>
<div class="paragraph">
<p>Enter the password for the Salt user twice.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The command <code>adduser saltuser -p password</code> does not work.
Using it prevents you from importing Salt States.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Authenticating_Salt_Minions_Using_Salt_Autosign_Grains_managing-configurations-salt"><a class="anchor" href="#Authenticating_Salt_Minions_Using_Salt_Autosign_Grains_managing-configurations-salt"></a>4.2. Authenticating Salt Minions using Salt autosign Grains</h3>
<div class="paragraph">
<p>Configure Foreman to automatically accept Salt Minions using Salt autosign Grains.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add the reactor to the <code>salt/auth</code> event.</p>
</li>
<li>
<p>Copy the Salt runners into your <code>file_roots</code> runners directory.
The directory depends on your <code>/etc/salt/master</code> config.
If it is configured to use <code>/srv/salt</code>, create the runners folder <code>/srv/salt/_runners</code> and copy the Salt runners into it.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># mkdir -p /srv/salt/_runners
# cp /usr/share/foreman-proxy/salt/runners/* /srv/salt/_runners/</pre>
</div>
</div>
</li>
<li>
<p>Restart the Salt Master service:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl restart salt-master</pre>
</div>
</div>
</li>
<li>
<p>Enable the Salt reactors and runners in your Salt Environment:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># salt-run saltutil.sync_all</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Authenticating_Salt_Minions_Using_Host_Names_managing-configurations-salt"><a class="anchor" href="#Authenticating_Salt_Minions_Using_Host_Names_managing-configurations-salt"></a>4.3. Authenticating Salt Minions using host names</h3>
<div class="paragraph">
<p>Configure Foreman to authenticate Salt Minions based on their host names.
This relies on the <code>autosign.conf</code> file that stores the host names of Salt Minions the Salt Master accepts.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>On your Salt Master, add the <code>foreman-proxy</code> user that is running Salt to the <code>root</code> user group:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># usermod -a -G foreman-proxy root</pre>
</div>
</div>
</li>
<li>
<p>On your Salt Master, enable the <code>autosign.conf</code> file in <code>/etc/salt/master</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">autosign_file: /etc/salt/autosign.conf
permissive_pki_access: True</pre>
</div>
</div>
</li>
<li>
<p>On your Salt Master, create the <code>/etc/salt/autosign.conf</code> file and set appropriate ownership and permissions:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># touch /etc/salt/autosign.conf
# chown root:foreman-proxy /etc/salt/autosign.conf
# chmod 660 /etc/salt/autosign.conf</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Enabling_Salt_Grain_Uploads_managing-configurations-salt"><a class="anchor" href="#Enabling_Salt_Grain_Uploads_managing-configurations-salt"></a>4.4. Enabling Salt Grain uploads</h3>
<div class="paragraph">
<p>Hosts running the Salt Minion client software can upload Salt Grains to Foreman&#160;server or Smart&#160;Proxy&#160;server.
Salt Grains are collected system properties, for example the operating system or IP address of a Salt Minion.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>On your Salt Master, edit <code>/etc/salt/foreman.yaml</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">:proto: https
:host: foreman.example.com
:port: 443
:ssl_ca: "/etc/puppetlabs/puppet/ssl/ssl_ca.pem"
:ssl_cert: "/etc/puppetlabs/puppet/ssl/client_cert.pem"
:ssl_key: "/etc/puppetlabs/puppet/ssl/client_key.pem"
:timeout: 10
:salt: /usr/bin/salt
:upload_grains: true</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Configuring_the_Salt_API_managing-configurations-salt"><a class="anchor" href="#Configuring_the_Salt_API_managing-configurations-salt"></a>4.5. Configuring the Salt API</h3>
<div class="paragraph">
<p>Configure the Salt API on your Salt Master.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>On your Salt master, edit <code>/etc/foreman-proxy/settings.d/salt.yml</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">:use_api: true
:api_auth: pam
:api_url: https://foreman.example.com:9191
:api_username: saltuser
:api_password: password</pre>
</div>
</div>
<div class="paragraph">
<p>Ensure to use the password of the previously created <code>saltuser</code>.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Activating_Salt_managing-configurations-salt"><a class="anchor" href="#Activating_Salt_managing-configurations-salt"></a>4.6. Activating Salt</h3>
<div class="paragraph">
<p>Use this procedure to activate Salt plugin on your Foreman.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>On your Salt Master, restart all Salt services:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl restart salt-master salt-api</pre>
</div>
</div>
</li>
<li>
<p>On your Foreman&#160;server, restart all Foreman services:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-maintain service restart</pre>
</div>
</div>
</li>
<li>
<p>In the Foreman web UI, navigate to <strong>Infrastructure</strong> &gt; <strong>Smart&#160;Proxies</strong>.</p>
</li>
<li>
<p>Click <strong>Refresh</strong> for the relevant Smart&#160;Proxy.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Setting_Up_Salt_Minions_managing-configurations-salt"><a class="anchor" href="#Setting_Up_Salt_Minions_managing-configurations-salt"></a>5. Setting up Salt Minions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Salt Minions require the Salt Minion client software to interact with your Salt Master.</p>
</div>
<div class="sect2">
<h3 id="Providing_the_Salt_Client_to_Salt_Minions_managing-configurations-salt"><a class="anchor" href="#Providing_the_Salt_Client_to_Salt_Minions_managing-configurations-salt"></a>5.1. Providing the Salt Client to Salt Minions</h3>
<div class="paragraph">
<p>Provide the Salt Client to your hosts.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create a product called <code>Salt</code>.
For more information, see <a href="https://docs.theforeman.org/3.12/Managing_Content/index-katello.html#Creating_a_Custom_Product_content-management">Creating a product</a>.</p>
</li>
<li>
<p>Create a repository within the <em>Salt</em> product for each operating system supported by Foreman that you want to install the Salt Minion client software on.
For more information, see <a href="https://docs.theforeman.org/3.12/Managing_Content/index-katello.html#Adding_Custom_Deb_Repositories_content-management">Adding Deb repositories</a>.
For more information, see <a href="https://docs.theforeman.org/3.12/Managing_Content/index-katello.html#Adding_Custom_RPM_Repositories_content-management">Adding RPM repositories</a>.</p>
<div class="paragraph">
<p>Add the operating system to the name of the repository, for example <code>Salt for Enterprise Linux 8</code>.</p>
</div>
<div class="paragraph">
<p>You can find the <em>upstream URL</em> for the Salt packages on the <a href="https://repo.saltproject.io/">official Salt package repository</a>.
The URL depends on both the Salt version and the operating system, for example <code><a href="https://repo.saltproject.io/py3/" class="bare">https://repo.saltproject.io/py3/</a></code>.</p>
</div>
</li>
<li>
<p>Synchronize the previously created products.
For more information, see <a href="https://docs.theforeman.org/3.12/Managing_Content/index-katello.html#Synchronizing_Repositories_content-management">Synchronizing repositories</a>.</p>
</li>
<li>
<p>Create a content view for each repository.
For more information, see <a href="https://docs.theforeman.org/3.12/Managing_Content/index-katello.html#Creating_a_Content_View_content-management">Creating a content view</a>.</p>
</li>
<li>
<p>Create a composite content view for each major version of each operating system to make the new content available.
For more information, see <a href="https://docs.theforeman.org/3.12/Managing_Content/index-katello.html#Creating_a_Composite_Content_View_content-management">Create a composite content view</a>.</p>
</li>
<li>
<p>Add each of your operating system specific Salt content views to your main composite content view for that operating system and version.</p>
</li>
<li>
<p>Publish a new version of the composite content view from the previous step.</p>
</li>
<li>
<p>Promote the content view from the previous step to your lifecycle environments as appropriate.
For more information, see <a href="https://docs.theforeman.org/3.12/Managing_Content/index-katello.html#Promoting_a_Content_View_content-management">Promoting a content view</a>.</p>
</li>
<li>
<p>Optional: Create activation keys for your composite content view and lifecycle environment combinations.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Creating_a_Host_Group_with_Salt_managing-configurations-salt"><a class="anchor" href="#Creating_a_Host_Group_with_Salt_managing-configurations-salt"></a>5.2. Creating a host group with Salt</h3>
<div class="paragraph">
<p>You can create a host group with Salt enabled to bundle provisioning and configuration settings for hosts.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Configure</strong> &gt; <strong>Host Groups</strong>.</p>
</li>
<li>
<p>Click <strong>Create Host Group</strong>.</p>
</li>
<li>
<p>Click the <strong>Host Group</strong> tab and select a <strong>Salt Environment</strong> and a <strong>Salt Master</strong>.</p>
</li>
<li>
<p>Click the <strong>Salt States</strong> tab and assign <strong>Salt States</strong> to your host group.</p>
</li>
<li>
<p>Click the <strong>Activation Keys</strong> tab and select an activation key containing the Salt Minion client software.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to save your host group.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Hosts deployed using this host group automatically install and configure the required Salt Minion client software and register with your Salt Master.
For more information, see <a href="https://docs.theforeman.org/3.12/Managing_Hosts/index-katello.html#Creating_a_Host_Group_managing-hosts">Creating a Host Group</a> <em>Managing hosts</em>.</p>
</div>
</div>
<div class="sect2">
<h3 id="Deploying_Salt_Minion_Hosts_managing-configurations-salt"><a class="anchor" href="#Deploying_Salt_Minion_Hosts_managing-configurations-salt"></a>5.3. Deploying Salt Minion hosts</h3>
<div class="paragraph">
<p>Deploy hosts that are fully provisioned and configured for Salt usage.</p>
</div>
<div class="olist arabic">
<div class="title">Prerequisites</div>
<ol class="arabic">
<li>
<p>A Salt Master</p>
</li>
<li>
<p>A Salt Environment</p>
</li>
<li>
<p>A content view containing the required Salt Minion client software</p>
</li>
<li>
<p>An activation key</p>
</li>
<li>
<p>A lifecycle environment</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>Create Host</strong>.</p>
</li>
<li>
<p>Select the previously created host group with Salt enabled.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to deploy a host.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Verifying_the_Connection_between_Salt_Master_and_Salt_Minions_managing-configurations-salt"><a class="anchor" href="#Verifying_the_Connection_between_Salt_Master_and_Salt_Minions_managing-configurations-salt"></a>5.4. Verifying the connection between Salt Master and Salt Minions</h3>
<div class="paragraph">
<p>Verify the connection between your Salt Master and Salt Minions.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Connect to your Salt Master using SSH:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># ssh root@salt-master.example.com</pre>
</div>
</div>
</li>
<li>
<p>Ping your Salt Minions:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># salt "*" test.ping</pre>
</div>
</div>
</li>
<li>
<p>Display all Salt Grains of all connected Salt Minions:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># salt "*" grains.items</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Using_Salt_managing-configurations-salt"><a class="anchor" href="#Using_Salt_managing-configurations-salt"></a>6. Using Salt</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Salt Minions managed by Foreman are associated with a Salt Master and a Salt Environment.
The associated Salt Environment within Foreman must match the actual Salt Environment from the <code>file_roots</code> option in the <code>/etc/salt/master</code> file.
You can configure hosts with Salt after they are associated with your Foreman&#160;server or Smart&#160;Proxy&#160;server and the Salt Minion client software is installed.</p>
</div>
<div class="sect2">
<h3 id="Using_the_Salt_Hammer_CLI_managing-configurations-salt"><a class="anchor" href="#Using_the_Salt_Hammer_CLI_managing-configurations-salt"></a>6.1. Using the Salt Hammer CLI</h3>
<div class="paragraph">
<p>You can use Hammer CLI to configure hosts using Salt.
Run <code>hammer --help</code> for more information.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Install <code>hammer_cli_foreman_salt</code> on your Foreman&#160;server</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Examples</div>
<ul>
<li>
<p>Creating a Salt State:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># hammer salt-state create \
--name <em>My_Salt_State</em></pre>
</div>
</div>
</li>
<li>
<p>Viewing information about a Salt Minion:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># hammer salt-minion info \
--name salt-minion.example.com</pre>
</div>
</div>
</li>
<li>
<p>Adding Salt States to a Salt Minion:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># hammer salt-minion update \
--name salt-minion.example.com \
--salt-states <em>My_Salt_State</em></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Using_the_Salt_API_managing-configurations-salt"><a class="anchor" href="#Using_the_Salt_API_managing-configurations-salt"></a>6.2. Using the Salt API</h3>
<div class="paragraph">
<p>Foreman Salt extends the Foreman REST API with Salt-specific features.
View the full API documentation on your Foreman&#160;server at <code>http://foreman.example.com/apidoc/v2.html</code>.</p>
</div>
<div class="ulist">
<div class="title">Example</div>
<ul>
<li>
<p>Use <code>curl</code> to get a list of keys from smartproxy.example.com:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># curl -u <em>My_User_Name</em>:<em>My_Password</em> \
-H "Accept: version=2,application/json" \
https://foreman.example.com/salt/api/v2/salt_keys/smartproxy.example.com</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Importing_Salt_States_managing-configurations-salt"><a class="anchor" href="#Importing_Salt_States_managing-configurations-salt"></a>6.3. Importing Salt States</h3>
<div class="paragraph">
<p>A Salt State configures parts of a host, for example, a service or the installation of a package.
You can import Salt States from your Salt Master to Foreman.
The Salt Master configuration in this guide uses a Salt Environment called <code>base</code> that includes the Salt States stored in <code>/srv/salt/</code>.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Configure</strong> &gt; <strong>Salt</strong> &gt; <strong>States</strong>.</p>
</li>
<li>
<p>Click <strong>Import from FQDN</strong>.</p>
</li>
<li>
<p>Optional: Click <strong>Edit</strong> to assign Salt States to Salt Environments.</p>
</li>
<li>
<p>Optional: Click <strong>Delete</strong> to remove a Salt State from your Foreman.
This only removes the Salt State from Foreman, not from the disk of your Salt Master.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to import the Salt States.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>After you have imported Salt States, you can assign them to hosts or Host Groups.
Salt applies these Salt States to any hosts they are assigned to every time you run <code>state.highstate</code>.
For more information, see <a href="#Running_Salt_managing-configurations-salt">Running Salt</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Configure the paths for Salt States and Salt Pillars in <code>/etc/salt/master</code>.
By default, Salt States are located in <code>/srv/salt</code> and and Salt Pillars in <code>/srv/pillar</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="Viewing_Salt_Autosign_Keys_managing-configurations-salt"><a class="anchor" href="#Viewing_Salt_Autosign_Keys_managing-configurations-salt"></a>6.4. Viewing Salt autosign keys</h3>
<div class="paragraph">
<p>The Salt Keys page lists hosts and their Salt keys.
You can manually accept, reject, or delete keys.</p>
</div>
<div class="paragraph">
<p>Use the Salt Autosign feature to automatically accept signing requests from hosts.
By default, hosts are supplied with a Salt key during host provisioning.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>This feature only covers the Salt Autosign using the <code>autosign.conf</code> authentication.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Infrastructure</strong> &gt; <strong>Smart&#160;Proxies</strong>.</p>
</li>
<li>
<p>Select a Smart&#160;Proxy.</p>
</li>
<li>
<p>In the <strong>Actions</strong> drop down menu, click <strong>Salt Keys</strong>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Enabling_Salt_Report_Uploads_managing-configurations-salt"><a class="anchor" href="#Enabling_Salt_Report_Uploads_managing-configurations-salt"></a>6.5. Enabling Salt report uploads</h3>
<div class="paragraph">
<p>The Salt Master can directly upload Salt reports to Foreman.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Connect to your Salt Master using SSH:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-none" data-lang="none"># ssh root@salt-master.example.com</code></pre>
</div>
</div>
</li>
<li>
<p>Ensure that the Salt reactor is present:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-none" data-lang="none"># file /usr/share/foreman-proxy/salt/reactors/foreman_report_upload.sls</code></pre>
</div>
</div>
</li>
<li>
<p>Copy report upload script:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-none" data-lang="none"># cp /usr/share/foreman-proxy/salt/runners/foreman_report_upload.py /srv/salt/_runners/</code></pre>
</div>
</div>
</li>
<li>
<p>Restart the Salt Master service:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-none" data-lang="none"># systemctl restart salt-master</code></pre>
</div>
</div>
</li>
<li>
<p>Enable the new runner:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-none" data-lang="none"># salt-run saltutil.sync_all</code></pre>
</div>
</div>
</li>
<li>
<p>If you use a cron job to upload facts from your Salt Master to Foreman, disable the cron job:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-none" data-lang="none"># rm -f /etc/cron.d/smart_proxy_salt</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Alternatively, you can upload Salt reports from your Salt Master to Foreman manually:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># /usr/sbin/upload-salt-reports</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Viewing_Salt_Reports_managing-configurations-salt"><a class="anchor" href="#Viewing_Salt_Reports_managing-configurations-salt"></a>6.6. Viewing Salt reports</h3>
<div class="paragraph">
<p>You can view uploaded Salt reports from Salt Minions in Foreman.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>To view all Salt reports, in the Foreman web UI, navigate to <strong>Monitor</strong> &gt; <strong>Reports</strong> &gt; <strong>Config Management</strong>.</p>
</li>
<li>
<p>To view Salt reports associated with a host, in the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>All Hosts</strong>, select a host, and click the <strong>Reports</strong> tab.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Salt_Variables_managing-configurations-salt"><a class="anchor" href="#Salt_Variables_managing-configurations-salt"></a>6.7. Salt variables</h3>
<div class="paragraph">
<p>You can configure Salt Variables within Foreman.
The configured values are available as Salt Pillar data.</p>
</div>
</div>
<div class="sect2">
<h3 id="Viewing_ENC_Parameters_managing-configurations-salt"><a class="anchor" href="#Viewing_ENC_Parameters_managing-configurations-salt"></a>6.8. Viewing ENC parameters</h3>
<div class="paragraph">
<p>You can use Foreman as an external node classifier for Salt.
Click <strong>Salt ENC</strong> on the host overview page to view assigned Salt States.
This shows a list of parameters that are made available for Salt usage as Salt Pillar data.</p>
</div>
<div class="paragraph">
<p>You can check what parameters are truly available on the Salt side by completing the following procedure.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Connect to your Salt Master using SSH:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># ssh root@salt-master.example.com</pre>
</div>
</div>
</li>
<li>
<p>View available ENC parameters:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># salt '*' pillar.items</pre>
</div>
</div>
</li>
<li>
<p>Optional: Refresh the Salt Pillar data if a parameter is missing:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># salt '*' saltutil.refresh_pillar</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Running_Salt_managing-configurations-salt"><a class="anchor" href="#Running_Salt_managing-configurations-salt"></a>6.9. Running Salt</h3>
<div class="paragraph">
<p>You can run arbitrary Salt functions, such as <code>salt.highstate</code>, using remote execution on one or more Salt Minions.
This applies all relevant Salt States on your hosts.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Monitor</strong> &gt; <strong>Jobs</strong> and click <strong>Run job</strong>.</p>
<div class="ulist">
<ul>
<li>
<p>If you want to run Salt highstate, select <strong>Salt</strong> as <strong>Job category</strong> and <strong>Salt Run state.highstate &#8211; Salt default</strong> as <strong>Job template</strong> and click <strong>Next</strong>.</p>
</li>
<li>
<p>If you want to run a Salt function, select <strong>Salt-Call</strong> as <strong>Job category</strong> and <strong>Salt Run function &#8211; SSH default</strong> as <strong>Job template</strong> and click <strong>Next</strong>.</p>
<div class="paragraph">
<p>In the <strong>Function</strong> field, enter the name of the function that you want to trigger, for example, <code>pillar.items</code> or <code>test.ping</code>.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Select hosts on which you want to run the job.
If you do not select any hosts, the job will run on all hosts you can see in the current context.</p>
</li>
<li>
<p>Click <strong>Next</strong>.</p>
</li>
<li>
<p>Optional: To configure advanced settings for the job, fill in the <strong>Advanced fields</strong>.
To learn more about advanced settings, see <a href="https://docs.theforeman.org/3.12/Managing_Hosts/index-katello.html#advanced-settings-in-the-job-wizard_managing-hosts">Advanced Settings in the Job Wizard</a> in <em>Managing hosts</em>.</p>
</li>
<li>
<p>Click <strong>Next</strong>.</p>
</li>
<li>
<p>Select <strong>Immediate execution</strong> to execute the job immediately and click <strong>Next</strong>.</p>
</li>
<li>
<p>Review job details.
You have the option to return to any part of the job wizard and edit the information.</p>
</li>
<li>
<p>Click <strong>Run</strong> to schedule the job for execution.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Alternatively, you can define recurrent actions using the native Salt way.
For example, you can schedule hourly <code>state.highstate</code> runs on individual Salt Minions by extending <code>/etc/salt/minion</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">schedule:
  highstate:
    function: state.highstate
    minutes: 60</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Salt_Example_managing-configurations-salt"><a class="anchor" href="#Salt_Example_managing-configurations-salt"></a>7. Salt example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This example uses a Salt State to manage the <code>/etc/motd</code> file on one or more Salt Minions.
It demonstrates the use of Foreman as an external node classifier and the use of Salt Grains.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create a global parameter called <code>vendor_name</code> with the string <code>Foreman</code> as its value.</p>
</li>
<li>
<p>Add a new Salt State called <code>motd</code> to your Salt Master.</p>
</li>
<li>
<p>Create the <code>/srv/salt/motd/</code> directory:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># mkdir -p /srv/salt/motd/</pre>
</div>
</div>
</li>
<li>
<p>Create <code>/srv/salt/motd/init.sls</code> as a Salt State file:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">/etc/motd:
  file.managed:
    - user: root
    - group: root
    - mode: 0644
    - source: salt://motd/motd.template
    - template: jinja</pre>
</div>
</div>
</li>
<li>
<p>Create <code>/srv/salt/motd/motd.template</code> as a template referenced by the Salt State file:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">Welcome to {{ grains['fqdn'] }} Powered by {{ salt['pillar.get']('vendor_name') }}</pre>
</div>
</div>
<div class="paragraph">
<p>Access the <code>fqdn</code> Salt Grain from within this template and retrieve the <code>vendor_name</code> parameter from the Salt Pillar.</p>
</div>
</li>
<li>
<p>Import the <code>motd</code> Salt State into Foreman.
For more information, see <a href="#Importing_Salt_States_managing-configurations-salt">Importing Salt States</a>.</p>
</li>
<li>
<p>Verify that Salt has been given access to the <code>vendor_name</code> parameter by running either of the following commands on your Salt Master:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># salt '*' pillar.items | grep -A 1 vendor_name
# salt '*' pillar.get vendor_name</pre>
</div>
</div>
<div class="paragraph">
<p>If the output does not include the value of the <code>vendor_name</code> parameter, you must refresh the Salt Pillar data first:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># salt '*' saltutil.refresh_pillar</pre>
</div>
</div>
<div class="paragraph">
<p>For information about how to refresh Salt Pillar data, see <a href="#Viewing_ENC_Parameters_managing-configurations-salt">Viewing ENC parameters</a>.</p>
</div>
</li>
<li>
<p>Add the <code>motd</code> Salt State to your Salt Minions or a host group.</p>
</li>
<li>
<p>Run <code>state.highstate</code> to apply the Salt State.
For more information, see <a href="#Running_Salt_managing-configurations-salt">Running Salt</a>.</p>
</li>
<li>
<p>Optional: Verify the contents of <code>/etc/motd</code> on a Salt Minion.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 3.12 (unsupported)<br>
Last updated Sep 2024
</div>
</div>
</body>
</html>