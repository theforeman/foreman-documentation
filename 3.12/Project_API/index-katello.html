<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<title>Using the Foreman REST API</title>
<style>
﻿*,::before,::after{box-sizing:border-box}html{font-size:100%;-webkit-text-size-adjust:100%}body{background:#fff;color:rgba(0,0,0,0.8);padding:0;margin:0;font-family:"Noto Serif", "DejaVu Serif", serif;font-size:inherit;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,pre,p,blockquote,th,td{margin:0;padding:0}a{background:none;color:#2156a5;text-decoration:underline;line-height:inherit}a:active,a:hover{cursor:pointer;outline:0}a:focus{outline:thin dotted}a:hover,a:focus{color:#1d4b8f}abbr{font-size:0.9em}abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}b,strong{font-weight:bold;line-height:inherit}strong strong{font-weight:400}code,kbd,pre{font-family:"Droid Sans Mono", "DejaVu Sans Mono", monospace;font-size:1em}code{font-weight:400;color:rgba(0,0,0,0.9)}pre{color:rgba(0,0,0,0.9);line-height:1.45;text-rendering:optimizeSpeed;white-space:pre-wrap}dfn{font-style:italic}em,i{font-style:italic;line-height:inherit}em em{font-style:normal}hr{border:solid #dddddf;border-width:1px 0 0;clear:both;height:0;margin:1.25em 0 1.1875em}mark{background:#ff0;color:#000}p{line-height:1.6;margin-bottom:1.25rem;text-rendering:optimizeLegibility}q{quotes:"“" "”" "‘" "’"}small{font-size:60%;line-height:inherit}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-0.5em}sub{bottom:-0.25em}img,object[type^="image/"],svg{display:inline-block;height:auto;max-width:100%;vertical-align:middle}img{border:0;-ms-interpolation-mode:bicubic}object{max-width:100%}svg:not(:root){overflow:hidden}figure{margin:0}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}.left{float:left !important}.right{float:right !important}.text-left{text-align:left !important}.text-right{text-align:right !important}.text-center{text-align:center !important}.text-justify{text-align:justify !important}.hide{display:none}.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:0.25em}p aside{font-size:.875em;line-height:1.35;font-style:italic}h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans", "DejaVu Sans", sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.2;word-spacing:-0.05em}h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{color:#e99b8f;line-height:0}h1{font-size:2.125em}h2{font-size:1.6875em}h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}h4,h5{font-size:1.125em}h6{font-size:1em}ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}ul,ol{margin-left:1.5em}ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}ul.square{list-style-type:square}ul.circle{list-style-type:circle}ul.disc{list-style-type:disc}ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}dl dt{margin-bottom:.3125em;font-weight:bold}dl dd{margin-bottom:1.25em;margin-left:1.125em}blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,0.85)}@media screen and (min-width: 768px){h1{font-size:2.75em}h2{font-size:2.3125em}h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}h4{font-size:1.4375em}}table{background:#fff;border:1px solid #dedede;border-collapse:collapse;border-spacing:0;margin-bottom:1.25em;word-wrap:normal}table thead,table tfoot{background:#f7f8f7}table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,0.8);text-align:left}table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,0.8)}table tr.even,table tr.alt{background:#f8f8f7}table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}.center{margin-left:auto;margin-right:auto}.stretch{width:100%}.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:"";display:table}.clearfix::after,.float-group::after{clear:both}:not(pre).nobreak{word-wrap:normal}:not(pre).nowrap{white-space:nowrap}:not(pre).pre-wrap{white-space:pre-wrap}:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal !important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}pre>code{display:block}pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}.keyseq{color:rgba(51,51,51,0.8)}kbd{display:inline-block;color:rgba(0,0,0,0.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,0.2),inset 0 0 0 0.1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}.keyseq kbd:first-child{margin-left:0}.keyseq kbd:last-child{margin-right:0}.menuseq,.menuref{color:#000}.menuseq b:not(.caret),.menuref{font-weight:inherit}.menuseq{word-spacing:-0.02em}.menuseq b.caret{font-size:1.25em;line-height:0.8}.menuseq i.caret{font-weight:bold;text-align:center;width:0.45em}b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}b.button::before{content:"[";padding:0 3px 0 2px}b.button::after{content:"]";padding:0 2px 0 3px}p a>code:hover{color:rgba(0,0,0,0.9)}body>div[id]{margin:0 auto;max-width:62.5em;position:relative;padding-left:.9375em;padding-right:0.9375em}body>div[id]::before,body>div[id]::after,#content #footnotes::before{content:"";display:table;clear:both}#content{margin-top:1.25em;margin-bottom:0.625em}#content::before{content:none}#header>h1:first-child{color:rgba(0,0,0,0.85);margin-top:2.25rem;margin-bottom:0}#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,0.6);display:flex;flex-flow:row wrap}#header .details span:first-child{margin-left:-0.125em}#header .details span.email a{color:rgba(0,0,0,0.85)}#header .details br{display:none}#header .details br+span::before{content:" – "}#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,0.85)}#header .details br+span#revremark::before{content:" | "}#header #revnumber{text-transform:capitalize}#header #revnumber::after{content:" "}#content>h1:first-child:not([class]){color:rgba(0,0,0,0.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}#toc{border-bottom:1px solid #e7e7e9;padding-bottom:0.5em}#toc>ul{margin-left:0.125em}#toc ul.sectlevel0>li>a{font-style:italic}#toc ul.sectlevel0 ul.sectlevel1{margin:0.5em 0}#toc ul{font-family:"Open Sans", "DejaVu Sans", sans-serif;list-style-type:none}#toc li{line-height:1.3334;margin-top:0.3334em}#toc a{text-decoration:none}#toc a:active{text-decoration:underline}#toctitle{color:#7a2518;font-size:1.2em}@media screen and (min-width: 768px){#toctitle{font-size:1.375em}body.toc2{padding-left:15em;padding-right:0}#toc.toc2{margin-top:0 !important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0 !important;border-bottom-width:0 !important;z-index:1000;padding:1.25em 1em;height:calc(100% - (70px + 2.5em));overflow:auto}#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}#toc.toc2>ul{font-size:.9em;margin-bottom:0}#toc.toc2 ul ul{margin-left:0;padding-left:1em}#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:0.5em}body.toc2.toc-right{padding-left:0;padding-right:15em}body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}@media screen and (min-width: 1280px){body.toc2{padding-left:20em;padding-right:0}#toc.toc2{width:20em}#toc.toc2 #toctitle{font-size:1.375em}#toc.toc2>ul{font-size:0.95em}#toc.toc2 ul ul{padding-left:1.25em}body.toc2.toc-right{padding-left:0;padding-right:20em}}#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}#content #toc>:first-child{margin-top:0}#content #toc>:last-child{margin-bottom:0}#footer{max-width:none;background:#025d8c;padding:1.25em;margin-left:2em}#footer-text{color:rgba(255,255,255,0.8);line-height:1.44}.sect1{padding-bottom:0.625em}@media screen and (min-width: 768px){#content{margin-bottom:1.25em}.sect1{padding-bottom:1.25em}}.sect1:last-child{padding-bottom:0}.sect1+.sect1{border-top:1px solid #e7e7e9}#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none !important;visibility:hidden;text-align:center;font-weight:400}#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:0.1em}#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}details{margin-left:1.25rem}details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}details>summary::-webkit-details-marker{display:none}details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif", "DejaVu Serif", serif;font-size:1rem;font-style:italic}table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,0.85)}.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}.admonitionblock>table td.icon{text-align:center;width:80px}.admonitionblock>table td.icon img{max-width:none}.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans", "DejaVu Sans", sans-serif;text-transform:uppercase}.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,0.6);word-wrap:anywhere}.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}.exampleblock>.content{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#fffef7;border-radius:4px;box-shadow:0 1px 4px #e0e0dc}.exampleblock>.content>:first-child{margin-top:0}.exampleblock>.content>:last-child{margin-bottom:0}.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}.sidebarblock>:first-child{margin-top:0}.sidebarblock>:last-child{margin-bottom:0}.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:0.8125em}@media screen and (min-width: 768px){.literalblock pre,.listingblock>.content>pre{font-size:0.90625em}}@media screen and (min-width: 1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,0.9)}.listingblock>.content{position:relative}.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:0.5}.listingblock:hover code[data-lang]::before{display:block}.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:0.5}.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}.listingblock pre.highlightjs{padding:0}.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}.listingblock pre.prettyprint{border-width:0}.prettyprint{background:#f7f7f8}pre.prettyprint .linenums{line-height:1.45;margin-left:2em}pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}pre.prettyprint li code[data-lang]::before{opacity:1}pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}table.linenotable td.code{padding-left:0.75em}table.linenotable td.linenos{width:0.01%}table.linenotable td.linenos,pre.pygments .linenos,pre.rouge .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}pre.pygments span.linenos,pre.rouge span.linenos{display:inline-block;margin-right:0.75em}.quoteblock{margin:0 1em 1.25em 1.5em;display:table}.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:0.75em}.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,0.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}.quoteblock blockquote{margin:0;padding:0;border:0}.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,0.1)}.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}.verseblock{margin:0 1em 1.25em}.verseblock pre{font-family:"Open Sans", "DejaVu Sans", sans-serif;font-size:1.15rem;color:rgba(0,0,0,0.85);font-weight:300;text-rendering:optimizeLegibility}.verseblock pre strong{font-weight:400}.verseblock .attribution{margin-top:1.25rem;margin-left:0.5ex}.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}.quoteblock .attribution br,.verseblock .attribution br{display:none}.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,0.6)}.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}.quoteblock.abstract{margin:0 1em 1.25em;display:block}.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:0.25em solid #dddddf}.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}p.tableblock:last-child{margin-bottom:0}td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}td.tableblock>.content>:last-child{margin-bottom:-1.25em}table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}table.grid-all>*>tr>*{border-width:1px}table.grid-cols>*>tr>*{border-width:0 1px}table.grid-rows>*>tr>*{border-width:1px 0}table.frame-all{border-width:1px}table.frame-ends{border-width:1px 0}table.frame-sides{border-width:0 1px}table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}th.halign-left,td.halign-left{text-align:left}th.halign-right,td.halign-right{text-align:right}th.halign-center,td.halign-center{text-align:center}th.valign-top,td.valign-top{vertical-align:top}th.valign-bottom,td.valign-bottom{vertical-align:bottom}th.valign-middle,td.valign-middle{vertical-align:middle}table thead th,table tfoot th{font-weight:bold}tbody tr th{background:#f7f8f7}tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,0.8);font-weight:bold}p.tableblock>code:only-child{background:none;padding:0}p.tableblock{font-size:1em}ol{margin-left:1.75em}ul li ol{margin-left:1.5em}dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:0.625em}ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:0.625em}ul.unstyled,ol.unstyled{margin-left:0}li>p:empty:only-child::before{content:"";display:inline-block}ul.checklist>li>p:first-child{margin-left:-1em}ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:0.125em}ul.checklist>li>p:first-child>input[type=checkbox]:first-child{font:inherit;margin:0 .25em 0 0;padding:0}ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 0.625em -1.25em}ul.inline>li{margin-left:1.25em}.unstyled dl dt{font-weight:400;font-style:normal}ol.arabic{list-style-type:decimal}ol.decimal{list-style-type:decimal-leading-zero}ol.loweralpha{list-style-type:lower-alpha}ol.upperalpha{list-style-type:upper-alpha}ol.lowerroman{list-style-type:lower-roman}ol.upperroman{list-style-type:upper-roman}ol.lowergreek{list-style-type:lower-greek}.hdlist>table,.colist>table{border:0;background:none}.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}td.hdlist1,td.hdlist2{vertical-align:top;padding:0 0.625em}td.hdlist1{font-weight:bold;padding-bottom:1.25em}td.hdlist2{word-wrap:anywhere}.literalblock+.colist,.listingblock+.colist{margin-top:-0.5em}.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}.colist td:not([class]):first-child img{max-width:none}.colist td:not([class]):last-child{padding:0.25em 0}.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}.imageblock.left{margin:0.25em 0.625em 1.25em 0}.imageblock.right{margin:0.25em 0 1.25em 0.625em}.imageblock>.title{margin-bottom:0}.imageblock.thumb,.imageblock.th{border-width:6px}.imageblock.thumb>.title,.imageblock.th>.title{padding:0 0.125em}.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}.image.left{margin-right:0.625em}.image.right{margin-left:0.625em}a.image{text-decoration:none;display:inline-block}a.image object{pointer-events:none}sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}sup.footnote a,sup.footnoteref a{text-decoration:none}sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:0.625em}#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:0.2em}#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}#footnotes .footnote:last-of-type{margin-bottom:0}#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:0.75em 0}div.page-break{display:none}div.unbreakable{page-break-inside:avoid}.big{font-size:larger}.small{font-size:smaller}.underline{text-decoration:underline}.overline{text-decoration:overline}.line-through{text-decoration:line-through}.aqua{color:#00bfbf}.aqua-background{background:#00fafa}.black{color:#000}.black-background{background:#000}.blue{color:#0000bf}.blue-background{background:#0000fa}.fuchsia{color:#bf00bf}.fuchsia-background{background:#fa00fa}.gray{color:#606060}.gray-background{background:#7d7d7d}.green{color:#006000}.green-background{background:#007d00}.lime{color:#00bf00}.lime-background{background:#00fa00}.maroon{color:#600000}.maroon-background{background:#7d0000}.navy{color:#000060}.navy-background{background:#00007d}.olive{color:#606000}.olive-background{background:#7d7d00}.purple{color:#600060}.purple-background{background:#7d007d}.red{color:#bf0000}.red-background{background:#fa0000}.silver{color:#909090}.silver-background{background:#bcbcbc}.teal{color:#006060}.teal-background{background:#007d7d}.white{color:#bfbfbf}.white-background{background:#fafafa}.yellow{color:#bfbf00}.yellow-background{background:#fafa00}span.icon>.fa{cursor:default}a span.icon>.fa{cursor:inherit}.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,0.5);cursor:default}.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,0.8);color:#111}.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}.conum[data-value]{display:inline-block;color:#fff !important;background:rgba(0,0,0,0.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans", "DejaVu Sans", sans-serif;font-style:normal;font-weight:bold}.conum[data-value] *{color:#fff !important}.conum[data-value]+b{display:none}.conum[data-value]::after{content:attr(data-value)}pre .conum[data-value]{position:relative;top:-0.125em}b.conum *{color:inherit !important}.conum:not([data-value]):empty{display:none}dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}h1,h2,p,td.content,span.alt,summary{letter-spacing:-0.01em}p strong,td.content strong,div.footnote strong{letter-spacing:-0.005em}p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}.print-only{display:none !important}@page{margin:1.25cm 0.75cm}@media print{*{box-shadow:none !important;text-shadow:none !important}html{font-size:80%}a{color:inherit !important;text-decoration:underline !important}a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none !important}a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:0.25em}abbr[title]{border-bottom:1px dotted}abbr[title]::after{content:" (" attr(title) ")"}pre,blockquote,tr,img,object,svg{page-break-inside:avoid}thead{display:table-header-group}p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}body>div[id]{max-width:none}#toc,.sidebarblock,.exampleblock>.content{background:none !important}#toc{border-bottom:1px solid #dddddf !important;padding-bottom:0 !important}body.book #header{text-align:center}body.book #header>h1:first-child{border:0 !important;margin:2.5em 0 1em}body.book #header .details{border:0 !important;display:block;padding:0 !important}body.book #header .details span:first-child{margin-left:0 !important}body.book #header .details br{display:block}body.book #header .details br+span::before{content:none !important}body.book #toc{border:0 !important;text-align:left !important;padding:0 !important;margin:0 !important}body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}.listingblock code[data-lang]::before{display:block}div.page-break{display:block;page-break-after:always}#footer{padding:0 0.9375em}.hide-on-print{display:none !important}.print-only{display:block !important}.hide-for-print{display:none !important}.show-for-print{display:inherit !important}}@media amzn-kf8, print{#header>h1:first-child{margin-top:1.25rem}.sect1{padding:0 !important}.sect1+.sect1{border:0}#footer{background:none}#footer-text{color:rgba(0,0,0,0.6);font-size:0.9em}}@media amzn-kf8{body>div[id]{padding:0}}body{padding:0;margin:0;margin-top:70px !important}.container{position:relative;z-index:1;padding-top:50px;min-height:100%}.container p{font-family:sans-serif;font-size:1.2em}nav{position:fixed;z-index:9999;left:0;right:0;top:0;height:70px;padding:0 1.5em;background-color:#025d8c;font-family:sans-serif;line-height:70px}nav .logo{width:50px;vertical-align:middle}nav .nav-menu{position:absolute;right:0.3em;top:0;padding:0;margin:0;list-style:none}nav .nav-item{display:inline-block}nav .nav-item>a{display:inline-block;padding:0 2.5em;line-height:70px;color:#fff;text-decoration:none}nav .dropdown{position:relative}nav .dropdown a::after{content:"";display:inline-block;margin-left:0.5em;vertical-align:middle;border-top:0.3em solid #fff;border-right:0.3em solid transparent;border-left:0.3em solid transparent}nav .dropdown.show a::after{transform:rotate(180deg)}nav .dropdown-menu{display:none;position:absolute;left:0;right:0;top:100%;padding:0.5em 0;margin-top:-0.5em;border:1px solid rgba(0,0,0,0.3);border-radius:0.5em;background-color:#fff;width:max-content}nav .dropdown-menu-left{left:auto;right:0}nav .dropdown.show .dropdown-menu{display:block}nav .dropdown-div{display:block;padding:0.4em 0;line-height:4em}nav .dropdown-div a::after{content:none;margin-left:0;border-top:0;border-right:0;border-left:0}nav .dropdown-item{display:block;padding:0 1.5em;font-size:0.875em;color:#000;line-height:1.6em;text-decoration:none}nav .btn-hamburger{display:none;position:absolute;right:1.5em;top:50%;background-color:transparent;border:0;cursor:pointer;outline:none;transform:translateY(-50%)}nav .btn-hamburger span{display:block;width:30px;height:4px;background-color:#fff;margin:6px;border-radius:2px;transition:0.3s ease-in-out}nav .btn-hamburger span:nth-child(4),nav .btn-hamburger span:nth-child(5){position:absolute;top:10px;opacity:0.5}nav .btn-hamburger span:nth-child(4){transform:rotate(45deg) scale(0)}nav .btn-hamburger span:nth-child(5){transform:rotate(-45deg) scale(0)}nav.opened .btn-hamburger span:nth-child(4){opacity:1;transform:rotate(45deg) scale(1)}nav.opened .btn-hamburger span:nth-child(5){opacity:1;transform:rotate(-45deg) scale(1)}nav.opened .btn-hamburger span:nth-child(1),nav.opened .btn-hamburger span:nth-child(2),nav.opened .btn-hamburger span:nth-child(3){opacity:0}@media screen and (max-width: 768px){nav .nav-menu{position:fixed;left:0;right:0;top:70px;bottom:100%;display:flex;flex-direction:column;justify-content:start;background-color:#363d4e;transition:bottom 0.5s ease-in-out;overflow:hidden}nav.opened .nav-menu{bottom:0}nav .nav-item>a{display:block}nav .dropdown-menu{position:relative;top:0;margin:0 1.5em}nav .btn-hamburger{display:block}}@media screen{div.narrow{max-width:1080px;margin:0 auto !important;margin-top:70px auto !important;float:none !important}#toc.toc2{margin-top:70px !important}}

</style>
<!-- docinfo -->
</head>
<body class="book toc2 toc-left">
    <div id="wrap">
      <script src="/js/versions.js"></script>
      <script src="/js/nav.js"></script>
      <script>
        document.open();
        document.write(buildNavigation());
        addNavbarListeners();
        document.close();
      </script>
    </div>
<div id="header">
<h1>Using the Foreman REST API</h1>
<div class="details">
<span id="revnumber">version 3.12,</span>
<span id="revdate">published Oct 07 2024</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#introduction-to-foreman-api">1. Introduction to Foreman API</a>
<ul class="sectlevel2">
<li><a href="#overview-of-the-foreman-api_rest-api">1.1. Overview of the Foreman API</a></li>
<li><a href="#foreman-api-compared-to-hammer-cli_rest-api">1.2. Foreman API compared to Hammer CLI</a></li>
</ul>
</li>
<li><a href="#accessing-the-built-in-api-reference">2. Accessing the built-in API reference</a></li>
<li><a href="#api-syntax">3. API syntax</a>
<ul class="sectlevel2">
<li><a href="#api-request-composition">3.1. API request composition</a></li>
<li><a href="#json-response-format">3.2. JSON response format</a></li>
<li><a href="#relating-api-error-messages-to-the-api-reference">3.3. Relating API error messages to the API reference</a></li>
</ul>
</li>
<li><a href="#api-call-authentication">4. API call authentication</a>
<ul class="sectlevel2">
<li><a href="#ssl-authentication-overview">4.1. SSL authentication overview</a></li>
<li><a href="#http-authentication-overview">4.2. HTTP authentication overview</a></li>
<li><a href="#token-authentication-overview">4.3. Token authentication overview</a></li>
<li><a href="#oauth-authentication-overview">4.4. OAuth authentication overview</a></li>
</ul>
</li>
<li><a href="#api-requests-in-various-languages">5. API requests in various languages</a>
<ul class="sectlevel2">
<li><a href="#calling-the-api-in-curl">5.1. Calling the API in curl</a></li>
<li><a href="#calling-the-api-in-ruby">5.2. Calling the API in Ruby</a></li>
<li><a href="#calling-the-api-in-python">5.3. Calling the API in Python</a></li>
</ul>
</li>
<li><a href="#api-cheat-sheet">6. API cheat sheet</a>
<ul class="sectlevel2">
<li><a href="#working-with-hosts">6.1. Working with hosts</a></li>
<li><a href="#working-with-lifecycle-environments">6.2. Working with lifecycle environments</a></li>
<li><a href="#uploading-content-to-foreman-server">6.3. Uploading Content to Foreman&#160;server</a></li>
<li><a href="#applying-errata-to-hosts">6.4. Applying errata to hosts</a></li>
<li><a href="#using-extended-searches">6.5. Using extended searches</a></li>
<li><a href="#using-searches-with-pagination-control">6.6. Using searches with pagination control</a></li>
<li><a href="#overriding-smart-class-parameters">6.7. Overriding Smart Class parameters</a></li>
<li><a href="#modifying-a-smart-class-parameter-by-using-an-external-file">6.8. Modifying a Smart Class parameter by using an external file</a></li>
<li><a href="#deleting-openscap-reports">6.9. Deleting OpenSCAP reports</a></li>
</ul>
</li>
<li><a href="#api-response_codes">Appendix A: API response codes</a></li>
<li><a href="#Creating_a_Complete_Permission_Table_rest-api">Appendix B: Creating a complete permission table</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="introduction-to-foreman-api"><a class="anchor" href="#introduction-to-foreman-api"></a>1. Introduction to Foreman API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Foreman provides a Representational State Transfer (REST) API.
The API provides software developers and system administrators with control over their Foreman environment outside of the standard web interface.
The REST API is useful for developers and administrators who aim to integrate the functionality of Foreman with custom scripts or external applications that access the API over HTTP.</p>
</div>
<div class="sect2">
<h3 id="overview-of-the-foreman-api_rest-api"><a class="anchor" href="#overview-of-the-foreman-api_rest-api"></a>1.1. Overview of the Foreman API</h3>
<div class="paragraph">
<p>The benefits of using the REST API are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Broad client support &#8211; any programming language, framework, or system with support for HTTP protocol can use the API.</p>
</li>
<li>
<p>Self-descriptive &#8211; client applications require minimal knowledge of the Foreman infrastructure because a user discovers many details at runtime.</p>
</li>
<li>
<p>Resource-based model &#8211; the resource-based REST model provides a natural way to manage a virtualization platform.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can use the REST API to perform the following tasks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Integrate with enterprise IT systems.</p>
</li>
<li>
<p>Integrate with third-party applications.</p>
</li>
<li>
<p>Perform automated maintenance or error checking tasks.</p>
</li>
<li>
<p>Automate repetitive tasks with scripts.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="foreman-api-compared-to-hammer-cli_rest-api"><a class="anchor" href="#foreman-api-compared-to-hammer-cli_rest-api"></a>1.2. Foreman API compared to Hammer CLI</h3>
<div class="paragraph">
<p>For many tasks, you can use both Hammer and Foreman API.
You can use Hammer as a human-friendly interface to Foreman API.
For example, to test responses to API calls before applying them in a script, use the <code>--debug</code> option to inspect API calls that Hammer issues: <code>hammer --debug organization list</code>.
In contrast, scripts that use API commands communicate directly with the Foreman API.</p>
</div>
<div class="paragraph">
<p>For more information, see the <a href="https://docs.theforeman.org/3.12/Hammer_CLI/index-katello.html#"><em>Using the Hammer CLI tool</em></a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="accessing-the-built-in-api-reference"><a class="anchor" href="#accessing-the-built-in-api-reference"></a>2. Accessing the built-in API reference</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can access the full API reference on your Foreman&#160;server.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>In your browser, access the following URL:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">https://<em>foreman.example.com</em>/apidoc/v2.html</pre>
</div>
</div>
<div class="paragraph">
<p>Replace <em>foreman.example.com</em> with the FQDN of your Foreman&#160;server.</p>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="api-syntax"><a class="anchor" href="#api-syntax"></a>3. API syntax</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can review the basic syntax of API requests and JSON responses.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>Even though versions 1 and 2 of the Foreman API are available, Foreman community only supports version 2.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="api-request-composition"><a class="anchor" href="#api-request-composition"></a>3.1. API request composition</h3>
<div class="paragraph">
<p>The built-in API reference shows the API route, or path, preceded by an HTTP method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>HTTP_METHOD API_ROUTE</pre>
</div>
</div>
<div class="paragraph">
<p>To work with the API, construct a command by using the <code>curl</code> command syntax and the API route from the reference document:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --request <em>HTTP_METHOD</em> \         #<b class="conum">(1)</b>
--insecure \                           #<b class="conum">(2)</b>
--user <em>My_User_Name</em>:<em>My_Password</em> \      #<b class="conum">(3)</b>
--data @<em>input_file</em>.json \              #<b class="conum">(4)</b>
--header "Accept:application/json" \       #<b class="conum">(5)</b>
--header "Content-Type:application/json" \ #<b class="conum">(5)</b>
--output <em>output_file</em>                    #<b class="conum">(6)</b>
<em>API_ROUTE</em> \                             #<b class="conum">(7)</b>
| python3 -m json.tool                  #<b class="conum">(8)</b></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>To use <code>curl</code> for the API call, specify an HTTP method with the <code>--request</code> option.
For example, <code>--request POST</code>.</p>
</li>
<li>
<p>Add the <code>--insecure</code> option to skip SSL peer certificate verification check.
Foreman community recommends you to configure SSL authentication and use secured calls.
For more information, see <a href="#ssl-authentication-overview">SSL authentication overview</a>.</p>
</li>
<li>
<p>Provide Foreman user credentials with the <code>--user</code> option.</p>
</li>
<li>
<p>For <code>POST</code> and <code>PUT</code> requests, use the <code>--data</code> option to pass JSON-formatted data.
For more information, see <a href="#sect-API_Guide-Passing_JSON_Data_with_the_API_Request">Passing JSON data to the API request</a>.</p>
</li>
<li>
<p>When passing the JSON data with the <code>--data</code> option, you must specify the following headers with the <code>--header</code> option.
For more information, see <a href="#sect-API_Guide-Passing_JSON_Data_with_the_API_Request">Passing JSON data to the API request</a>.</p>
</li>
<li>
<p>When downloading content from Foreman&#160;server, specify the output file with the <code>--output</code> option.</p>
</li>
<li>
<p>Use the API route in the following format: <code>https://<em>foreman.example.com</em>/katello/api/activation_keys</code>.
In Foreman, version 2 of the API is the default.
Therefore, it is not necessary to use <code>v2</code> in the URL for API calls.</p>
</li>
<li>
<p>Redirect the output to the Python <code>json.tool</code> module to make the output easier to read.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="using-the-get-http-method"><a class="anchor" href="#using-the-get-http-method"></a>3.1.1. Using the GET HTTP method</h4>
<div class="paragraph">
<p>Use the GET HTTP method to get data from the API about an existing entry or resource.</p>
</div>
<div class="paragraph">
<div class="title">Example</div>
<p>This example requests the amount of Foreman hosts:</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --request GET --user <em>My_User_Name</em>:<em>My_Password</em> \
https://<em>foreman.example.com</em>/api/hosts | python3 -m json.tool</pre>
</div>
</div>
<div class="paragraph">
<p>Example response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">{
  "total": 2,
  "subtotal": 2,
  "page": 1,
  "per_page": 20,
  "search": null,
  "sort": {
    "by": null,
    "order": null
  },
  "results":
<em>output truncated</em></pre>
</div>
</div>
<div class="paragraph">
<p>The response from the API indicates that there are two results in total, this is the first page of the results, and the maximum results per page is set to 20.
For more information, see <a href="#json-response-format">JSON response format</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="using-the-post-http-method"><a class="anchor" href="#using-the-post-http-method"></a>3.1.2. Using the POST HTTP method</h4>
<div class="paragraph">
<p>Use the POST HTTP verb to submit data to the API to create an entry or resource.
You must submit the data in JSON format.
For more information, see <a href="#sect-API_Guide-Passing_JSON_Data_with_the_API_Request">Passing JSON data to the API request</a>.</p>
</div>
<div class="olist arabic">
<div class="title">Example to create an activation key</div>
<ol class="arabic">
<li>
<p>Create a test file, for example, <code>activation-key.json</code>, with the following content:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">{"organization_id":1, "name":"TestKey", "description":"Just for testing"}</pre>
</div>
</div>
</li>
<li>
<p>Create an activation key by applying the data in the <code>activation-key.json</code> file:</p>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --header "Accept:application/json" \
--header "Content-Type:application/json" --request POST \
--user <em>My_User_Name</em>:<em>My_Password</em> \
--data @activation-key.json \
https://<em>foreman.example.com</em>/katello/api/activation_keys \
| python3 -m json.tool</pre>
</div>
</div>
<div class="paragraph">
<p>Example response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">{
    "id": 2,
    "name": "TestKey",
    "description": "Just for testing",
    "unlimited_hosts": true,
    "auto_attach": true,
    "content_view_id": null,
    "environment_id": null,
    "usage_count": 0,
    "user_id": 3,
    "max_hosts": null,
    "release_version": null,
    "service_level": null,
    "content_overrides": [

    ],
    "organization": {
        "name": "Default Organization",
        "label": "Default_Organization",
        "id": 1
    },
    "created_at": "2017-02-16 12:37:47 UTC",
    "updated_at": "2017-02-16 12:37:48 UTC",
    "content_view": null,
    "environment": null,
    "products": null,
    "host_collections": [

    ],
    "permissions": {
        "view_activation_keys": true,
        "edit_activation_keys": true,
        "destroy_activation_keys": true
    }
}</pre>
</div>
</div>
</li>
<li>
<p>Verify that the new activation key is present.
In the Foreman web UI, navigate to <strong>Content</strong> &gt; <strong>Lifecycle</strong> &gt; <strong>Activation Keys</strong> to view your activation keys.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="using-the-put-http-method"><a class="anchor" href="#using-the-put-http-method"></a>3.1.3. Using the PUT HTTP method</h4>
<div class="paragraph">
<p>Use the PUT HTTP method to change an existing value or append to an existing resource.
You must submit the data in JSON format.
For more information, see <a href="#sect-API_Guide-Passing_JSON_Data_with_the_API_Request">Passing JSON data to the API request</a>.</p>
</div>
<div class="paragraph">
<div class="title">Example</div>
<p>This example updates the <code>TestKey</code> activation key created in the previous example.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Edit the <code>activation-key.json</code> file created previously as follows:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">{"organization_id":1, "name":"TestKey", "description":"Just for testing","max_hosts":"10" }</pre>
</div>
</div>
</li>
<li>
<p>Apply the changes in the JSON file:</p>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl  --request PUT \
--header "Accept:application/json" \
--header "Content-Type:application/json" \
--user <em>My_User_Name</em>:<em>My_Password</em> \
--data @activation-key.json \
https://<em>foreman.example.com</em>/katello/api/activation_keys/2 \
| python3 -m json.tool</pre>
</div>
</div>
<div class="paragraph">
<p>Example response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">{
    "id": 2,
    "name": "TestKey",
    "description": "Just for testing",
    "unlimited_hosts": false,
    "auto_attach": true,
    "content_view_id": null,
    "environment_id": null,
    "usage_count": 0,
    "user_id": 3,
    "max_hosts": 10,
    "release_version": null,
    "service_level": null,
    "content_overrides": [

    ],
    "organization": {
        "name": "Default Organization",
        "label": "Default_Organization",
        "id": 1
    },
    "created_at": "2017-02-16 12:37:47 UTC",
    "updated_at": "2017-02-16 12:46:17 UTC",
    "content_view": null,
    "environment": null,
    "products": null,
    "host_collections": [

    ],
    "permissions": {
        "view_activation_keys": true,
        "edit_activation_keys": true,
        "destroy_activation_keys": true
    }
}</pre>
</div>
</div>
</li>
<li>
<p>In the Foreman web UI, verify the changes by navigating to <strong>Content</strong> &gt; <strong>Lifecycle</strong> &gt; <strong>Activation Keys</strong>.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="using-the-delete-http-method"><a class="anchor" href="#using-the-delete-http-method"></a>3.1.4. Using the DELETE HTTP method</h4>
<div class="paragraph">
<p>To delete a resource, use the DELETE method with an API route that includes the ID of the resource you want to delete.</p>
</div>
<div class="paragraph">
<div class="title">Example</div>
<p>This example deletes the <code>TestKey</code> activation key which ID is 2:</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl  \
--header "Accept:application/json" \
--header "Content-Type:application/json" \
--request DELETE \
--user <em>My_User_Name</em>:<em>My_Password</em> \
https://<em>foreman.example.com</em>/katello/api/activation_keys/2 \
| python3 -m json.tool</pre>
</div>
</div>
<div class="paragraph">
<p>Example response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"><em>output omitted</em>
    "started_at": "2017-02-16 12:58:17 UTC",
    "ended_at": "2017-02-16 12:58:18 UTC",
    "state": "stopped",
    "result": "success",
    "progress": 1.0,
    "input": {
        "activation_key": {
            "id": 2,
            "name": "TestKey"
<em>output truncated</em></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="json-response-format"><a class="anchor" href="#json-response-format"></a>3.2. JSON response format</h3>
<div class="paragraph">
<p>Calls to the API return results in JSON format.
The API call returns the result for a single-option response or for responses collections.</p>
</div>
<div class="paragraph">
<div class="title">JSON response format for single objects</div>
<p>You can use single-object JSON responses to work with a single object.
API requests to a single object require the unique identifier <code>:id</code> of the object.</p>
</div>
<div class="paragraph">
<p>This is an example of the format for a single-object request for the Foreman domain which ID is 23:</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --request GET --user <em>My_User_Name</em>:<em>My_Password</em> \
https://<em>foreman.example.com</em>/api/domains/23 | python3 -m json.tool</pre>
</div>
</div>
<div class="paragraph">
<p>Example response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">{
    "id": 23,
    "name": "qa.lab.example.com",
    "fullname": "QA",
    "dns_id": 10,
    "created_at": "2024-08-13T09:02:31Z",
    "updated_at": "2024-08-13T09:02:31Z"
}</pre>
</div>
</div>
<div class="paragraph">
<div class="title">JSON response format for collections</div>
<p>Collections are a list of objects such as hosts and domains.
The format for a collection JSON response consists of a metadata fields section and a results section.</p>
</div>
<div class="paragraph">
<p>This is an example of the format for a collection request for a list of Foreman domains:</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --request GET --user <em>My_User_Name</em>:<em>My_Password</em> \
https://<em>foreman.example.com</em>/api/domains | python3 -m json.tool</pre>
</div>
</div>
<div class="paragraph">
<p>Example response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">{
    "total": 3,
    "subtotal": 3,
    "page": 1,
    "per_page": 20,
    "search": null,
    "sort": {
        "by": null,
        "order": null
    },
    "results": [
        {
            "id": 23,
            "name": "qa.lab.example.com",
            "fullname": "QA",
            "dns_id": 10,
            "created_at": "2024-08-13T09:02:31Z",
            "updated_at": "2024-08-13T09:02:31Z"
        },
        {
            "id": 25,
            "name": "dev.lab.example.com",
            "fullname": "DEVEL",
            "dns_id": 8,
            "created_at": "2024-08-13T08:32:48Z",
            "updated_at": "2024-08-14T07:04:03Z"
        },
        {
            "id": 32,
            "name": "hr.lab.example.com",
            "fullname": "HR",
            "dns_id": 8,
            "created_at": "2024-08-16T08:32:48Z",
            "updated_at": "2024-08-16T07:04:03Z"
        }
    ]
}</pre>
</div>
</div>
<div class="paragraph">
<div class="title">JSON response metadata</div>
<p>API response uses the following metadata fields:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>total</code> &#8211; The total number of objects without any search parameters.</p>
</li>
<li>
<p><code>subtotal</code> &#8211; The number of objects returned with the given search parameters.
If there is no search, then subtotal is equal to total.</p>
</li>
<li>
<p><code>page</code> &#8211; The page number.</p>
</li>
<li>
<p><code>per_page</code> &#8211; The maximum number of objects returned per page.</p>
</li>
<li>
<p><code>limit</code> &#8211; The specified number of objects to return in a collection response.</p>
</li>
<li>
<p><code>offset</code> &#8211; The number of objects skipped before returning a collection.</p>
</li>
<li>
<p><code>search</code> &#8211; The search string based on <code>scoped_scoped</code> syntax.</p>
</li>
<li>
<p><code>sort</code></p>
<div class="ulist">
<ul>
<li>
<p><code>by</code> &#8211; Specifies by what field the API sorts the collection.</p>
</li>
<li>
<p><code>order</code> &#8211; The sort order, either ASC for ascending or DESC for descending.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>results</code> &#8211; The collection of objects.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="relating-api-error-messages-to-the-api-reference"><a class="anchor" href="#relating-api-error-messages-to-the-api-reference"></a>3.3. Relating API error messages to the API reference</h3>
<div class="paragraph">
<p>The API uses a RAILs format to indicate an error:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"><em>Nested_Resource</em>.<em>Attribute_Name</em></pre>
</div>
</div>
<div class="paragraph">
<p>This translates to the following format used in the API reference:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"><em>Resource</em>[<em>Nested_Resource_attributes</em>][<em>Attribute_Name_id</em>]</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="api-call-authentication"><a class="anchor" href="#api-call-authentication"></a>4. API call authentication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Interaction with the Foreman API requires SSL authentication with Foreman&#160;server CA certificate and authentication with valid Foreman user credentials.
You can use the following authentication methods.</p>
</div>
<div class="sect2">
<h3 id="ssl-authentication-overview"><a class="anchor" href="#ssl-authentication-overview"></a>4.1. SSL authentication overview</h3>
<div class="paragraph">
<p>Foreman uses HTTPS, which provides a degree of encryption and identity verification when communicating with Foreman&#160;server.
Foreman 3.12 does not support non-SSL communications.</p>
</div>
<div class="paragraph">
<p>By default, Foreman&#160;server uses a self-signed certificate.
This certificate acts as both the server certificate to verify the encryption key and the certificate authority (CA) to trust the identity of Foreman&#160;server.</p>
</div>
<div class="paragraph">
<p>You can configure Foreman&#160;server to use a custom SSL certificate.
For more information, see <a href="https://docs.theforeman.org/3.12/Installing_Server/index-katello.html#Configuring_Server_with_a_Custom_SSL_Certificate_foreman">Configuring Foreman&#160;server with a custom SSL certificate</a> in <em>Installing Foreman&#160;Server with Katello 4.14 plugin on Enterprise Linux</em>.</p>
</div>
<div class="sect3">
<h4 id="configuring-ssl-authentication"><a class="anchor" href="#configuring-ssl-authentication"></a>4.1.1. Configuring SSL authentication</h4>
<div class="paragraph">
<p>Configure an SSL authentication for the API requests to Foreman&#160;server.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Obtain a certificate from your Foreman&#160;server by using one of the following options:</p>
<div class="ulist">
<ul>
<li>
<p>If you plan to call the API from a remote server, download the CA certificate:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># curl -o /etc/pki/ca-trust/source/anchors/<em>foreman.example.com</em>-katello-server-ca.crt \
http://foreman.example.com/pub/katello-server-ca.crt</pre>
</div>
</div>
</li>
<li>
<p>If you plan to call the API directly on your Foreman&#160;server, copy the certificate to the <code>/etc/pki/ca-trust/source/anchors</code> directory:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># cp /var/www/html/pub/katello-server-ca.crt \
/etc/pki/ca-trust/source/anchors/<em>foreman.example.com</em>-katello-server-ca.crt</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Add the certificate to the list of trusted CAs:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ update-ca-trust extract</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Verification</div>
<ul>
<li>
<p>Verify that your client trusts the Foreman SSL certificate by entering the API request without the <code>--cacert</code> option:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --request GET \
--user <em>My_User_Name</em>:<em>My_Password</em> \
https://<em>foreman.example.com</em>/api/v2/hosts</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="http-authentication-overview"><a class="anchor" href="#http-authentication-overview"></a>4.2. HTTP authentication overview</h3>
<div class="paragraph">
<p>All requests to the Foreman API require a valid Foreman user name and password.
The API uses Basic HTTP authentication to encode these credentials and add to the <code>Authorization</code> header.
For more information about Basic authentication, see <a href="http://tools.ietf.org/html/rfc2617">RFC 2617 HTTP Authentication: Basic and Digest Access Authentication</a>.
If a request does not include an appropriate <code>Authorization</code> header, the API returns a <code>401 Authorization Required</code> error.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>Basic authentication involves potentially sensitive information, for example, it sends passwords as plain text.
The REST API requires HTTPS for transport-level encryption of plain text requests.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Some base64 libraries break encoded credentials into multiple lines and terminate each line with a newline character.
This invalidates the header and causes a faulty request.
The <code>Authorization</code> header requires the encoded credentials to be on a single line within the header.</p>
</div>
</div>
<div class="sect2">
<h3 id="token-authentication-overview"><a class="anchor" href="#token-authentication-overview"></a>4.3. Token authentication overview</h3>
<div class="paragraph">
<p>Foreman supports Personal Access Tokens that you can use to authenticate API requests instead of using your password.
You can set an expiration date for your Personal Access Token and you can revoke it if you decide it should expire before the expiration date.</p>
</div>
<div class="sect3">
<h4 id="creating-a-personal-access-token_rest-api"><a class="anchor" href="#creating-a-personal-access-token_rest-api"></a>4.3.1. Creating a Personal Access Token</h4>
<div class="paragraph">
<p>Use this procedure to create a Personal Access Token.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Administer</strong> &gt; <strong>Users</strong>.</p>
</li>
<li>
<p>Select a user for which you want to create a Personal Access Token.</p>
</li>
<li>
<p>On the <strong>Personal Access Tokens</strong> tab, click <strong>Add Personal Access Token</strong>.</p>
</li>
<li>
<p>Enter a <strong>Name</strong> for you Personal Access Token.</p>
</li>
<li>
<p>Optional: Select the <strong>Expires</strong> date to set an expiration date.
If you do not set an expiration date, your Personal Access Token will never expire unless revoked.</p>
</li>
<li>
<p>Click Submit.
You now have the Personal Access Token available to you on the <strong>Personal Access Tokens</strong> tab.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>Ensure to store your Personal Access Token as you will not be able to access it again after you leave the page or create a new Personal Access Token.
You can click <strong>Copy to clipboard</strong> to copy your Personal Access Token.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Verification</div>
<ol class="arabic">
<li>
<p>Make an API request to your Foreman&#160;server and authenticate with your Personal Access Token:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># curl https://<em>foreman.example.com</em>/api/status --user <em>My_Username</em>:<em>My_Personal_Access_Token</em></pre>
</div>
</div>
</li>
<li>
<p>You should receive a response with status <code>200</code>, for example:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">{"foreman_version":"3.12.0","result":"ok","status":200,"version":"3.5.1.10","api_version":2}</pre>
</div>
</div>
<div class="paragraph">
<p>If you go back to <strong>Personal Access Tokens</strong> tab, you can see the updated <strong>Last Used</strong> time next to your Personal Access Token.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="revoking-a-personal-access-token_rest-api"><a class="anchor" href="#revoking-a-personal-access-token_rest-api"></a>4.3.2. Revoking a Personal Access Token</h4>
<div class="paragraph">
<p>Use this procedure to revoke a Personal Access Token before its expiration date.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Administer</strong> &gt; <strong>Users</strong>.</p>
</li>
<li>
<p>Select a user for which you want to revoke the Personal Access Token.</p>
</li>
<li>
<p>On the <strong>Personal Access Tokens</strong> tab, locate the Personal Access Token you want to revoke.</p>
</li>
<li>
<p>Click <strong>Revoke</strong> in the <strong>Actions</strong> column next to the Personal Access Token you want to revoke.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Verification</div>
<ol class="arabic">
<li>
<p>Make an API request to your Foreman&#160;server and try to authenticate with the revoked Personal Access Token:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># curl https://<em>foreman.example.com</em>/api/status --user <em>My_Username</em>:<em>My_Personal_Access_Token</em></pre>
</div>
</div>
</li>
<li>
<p>You receive the following error message:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">{
  "error": {"message":"Unable to authenticate user <em>My_Username</em>"}
}</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="oauth-authentication-overview"><a class="anchor" href="#oauth-authentication-overview"></a>4.4. OAuth authentication overview</h3>
<div class="paragraph">
<p>As an alternative to Basic authentication, you can use limited OAuth 1.0a authentication.
This is sometimes referred to as <em>1-legged OAuth</em>.</p>
</div>
<div class="paragraph">
<p>To view OAuth settings, in the Foreman web UI, navigate to <strong>Administer</strong> &gt; <strong>Settings</strong> &gt; <strong>Authentication</strong>.
The <strong>OAuth consumer key</strong> is the token to be used by all OAuth clients.</p>
</div>
<div class="paragraph">
<p>Foreman stores OAuth settings in the <code>/etc/foreman/settings.yaml</code> file.
Use the <code>foreman-installer</code> script to configure these settings.</p>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://oauth.net/core/1.0a/">OAuth Core 1.0 specification, Revision A</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="configuring-oauth"><a class="anchor" href="#configuring-oauth"></a>4.4.1. Configuring OAuth</h4>
<div class="paragraph">
<p>Use <code>foreman-installer</code> to change OAuth settings on Foreman&#160;server.
Enter the following command to list all OAuth-related installer options:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-installer --full-help | grep oauth</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Enabling OAuth user mapping</div>
<p>By default, Foreman authorizes all OAuth API requests as the built-in anonymous API administrator account.
Therefore, API responses include all Foreman data.
However, you can also specify the Foreman user that makes the request and restrict access to data to that user.</p>
</div>
<div class="paragraph">
<p>To enable OAuth user mapping, enter the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-installer --foreman-oauth-map-users true</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>Foreman does not sign the header in an OAuth request.
Anyone with a valid consumer key can impersonate any Foreman user.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="oauth-request-format"><a class="anchor" href="#oauth-request-format"></a>4.4.2. OAuth request format</h4>
<div class="paragraph">
<p>Every OAuth API request requires the <code>FOREMAN-USER</code> header with the login of an existing Foreman user and the <code>Authorization</code> header in the following format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">--header 'FOREMAN-USER: <em>My_User_Name</em>' \
--header 'Authorization: OAuth oauth_version="1.0",oauth_consumer_key="<em>secretkey</em>",oauth_signature_method="hmac-sha1",oauth_timestamp=<em>timestamp</em>,oauth_signature=<em>signature</em>'</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Use an OAuth client library to construct all OAuth parameters.
For an example that uses the <strong>requests_oauthlib</strong> Python module, see <a href="https://access.redhat.com/solutions/4240401">How to execute an API call by using the OAuth authentication method via python script in Foreman?</a> in the <em>Red&#160;Hat Knowledgebase</em>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">Example</div>
<p>This example lists architectures by using OAuth for authentication.
The request uses a <em>My_User_Name</em> username in the <code>FOREMAN-USER</code> header.
With the <code>--foreman-oauth-map-users</code> set to <code>true</code>, the response includes only architectures that the user has access to view.
The signature reflects every parameter, HTTP method, and URI change.</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl 'https://<em>foreman.example.com</em>/api/architectures' \
--header 'Content-Type: application/json' \
--header 'Accept:application/json' \
--header 'FOREMAN-USER: <em>My_User_Name</em>' \
--header 'Authorization: OAuth oauth_version="1.0",oauth_consumer_key="<em>secretkey</em>",oauth_signature_method="hmac-sha1",oauth_timestamp=<em>1321473112</em>,oauth_signature=<em>Il8hR8/ogj/XVuOqMPB9qNjSy6E=</em>'</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="api-requests-in-various-languages"><a class="anchor" href="#api-requests-in-various-languages"></a>5. API requests in various languages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can review the following examples of sending API requests to Foreman from curl, Ruby, or Python.</p>
</div>
<div class="sect2">
<h3 id="calling-the-api-in-curl"><a class="anchor" href="#calling-the-api-in-curl"></a>5.1. Calling the API in curl</h3>
<div class="paragraph">
<p>You can use <code>curl</code> with the Foreman API to perform various tasks.</p>
</div>
<div class="paragraph">
<p>Foreman requires the use of HTTPS, and by default a certificate for host identification.
If you have not added the Foreman&#160;server certificate as described in <a href="#ssl-authentication-overview">SSL authentication overview</a>, then you can use the <code>--insecure</code> option to bypass certificate checks.</p>
</div>
<div class="paragraph">
<p>For user authentication, you can use the <code>--user</code> option to provide Foreman user credentials in the form <code>--user <em>username:password</em></code> or, if you do not include the password, the command prompts you to enter it.
To reduce security risks, do not include the password as part of the command, because it then becomes part of your shell history.
Examples in this section include the password only for the sake of simplicity.</p>
</div>
<div class="paragraph">
<p>Be aware that if you use the <code>--silent</code> option, <code>curl</code> does not display a progress meter or any error messages.</p>
</div>
<div class="paragraph">
<p>Examples in this chapter use the Python <code>json.tool</code> module to format the output.</p>
</div>
<div class="sect3">
<h4 id="sect-API_Guide-Passing_JSON_Data_with_the_API_Request"><a class="anchor" href="#sect-API_Guide-Passing_JSON_Data_with_the_API_Request"></a>5.1.1. Passing JSON data to the API request</h4>
<div class="paragraph">
<p>You can pass data to Foreman&#160;server with the API request.
The data must be in JSON format.
When specifying JSON data with the <code>--data</code> option, you must set the following HTTP headers with the <code>--header</code> option:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>--header "Accept:application/json" \
--header "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>Use one of the following options to include data with the <code>--data</code> option.</p>
</div>
<div class="paragraph">
<div class="title">JSON-formatted string</div>
<p>Enclose the quoted JSON-formatted data in curly braces <code>{}</code>.
When passing a value for a JSON type parameter, you must escape quotation marks <code>"</code> with backslashes <code>\</code>.
For example, within curly braces, you must format <code>"Example JSON Variable"</code> as <code>\"Example JSON Variable\"</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">--data {"id":44, "smart_class_parameter":{"override":"true", "parameter_type":"json", "default_value":"{\"GRUB_CMDLINE_LINUX\": {\"audit\":\"1\",\"crashkernel\":\"true\"}}"}}</pre>
</div>
</div>
<div class="paragraph">
<div class="title">JSON-formatted file</div>
<p>The unquoted JSON-formatted data enclosed in a file and specified by the <code>@</code> sign and the filename.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">--data @<em>file</em>.json</pre>
</div>
</div>
<div class="paragraph">
<p>Using external files for JSON formatted data has the following advantages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You can use your favorite text editor.</p>
</li>
<li>
<p>You can use syntax checker to find and avoid mistakes.</p>
</li>
<li>
<p>You can use tools to check the validity of JSON data or to reformat it.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Use the <code>json_verify</code> tool to check the validity of the JSON file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ json_verify &lt; <em>file</em>.json</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sect-API_Guide-Performing_Simple_Queries"><a class="anchor" href="#sect-API_Guide-Performing_Simple_Queries"></a>5.1.2. Retrieving a list of resources</h4>
<div class="paragraph">
<p>This section outlines how to use <code>curl</code> with the Foreman API to request information from Foreman.
These examples include both requests and responses.
Expect different results for each deployment.</p>
</div>
<div class="paragraph">
<div class="title">Listing users</div>
<p>This example is a basic request that returns a list of Foreman resources, Foreman users in this case.
Such requests return a list of data wrapped in metadata, while other request types only return the actual object.</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --request GET --user <em>My_User_Name</em>:<em>My_Password</em> \
https://<em>foreman.example.com</em>/api/users | python3 -m json.tool</pre>
</div>
</div>
<div class="paragraph">
<p>Example response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">{
    "page": 1,
    "per_page": 20,
    "results": [
        {
            "admin": false,
            "auth_source_id": 1,
            "auth_source_name": "Internal",
            "created_at": "2018-09-21 08:59:22 UTC",
            "default_location": null,
            "default_organization": null,
            "description": "",
            "effective_admin": false,
            "firstname": "",
            "id": 5,
            "last_login_on": "2018-09-21 09:03:25 UTC",
            "lastname": "",
            "locale": null,
            "locations": [],
            "login": "test",
            "mail": "example@domain.com",
            "organizations": [
                {
                    "id": 1,
                    "name": "Default Organization"
                }
            ],
            "ssh_keys": [],
            "timezone": null,
            "updated_at": "2018-09-21 09:04:45 UTC"
        },
        {
            "admin": true,
            "auth_source_id": 1,
            "auth_source_name": "Internal",
            "created_at": "2018-09-20 07:09:41 UTC",
            "default_location": null,
            "default_organization": {
                "description": null,
                "id": 1,
                "name": "Default Organization",
                "title": "Default Organization"
            },
            "description": "",
            "effective_admin": true,
            "firstname": "Admin",
            "id": 4,
            "last_login_on": "2018-12-07 07:31:09 UTC",
            "lastname": "User",
            "locale": null,
            "locations": [
                {
                    "id": 2,
                    "name": "Default Location"
                }
            ],
            "login": "admin",
            "mail": "root@example.com",
            "organizations": [
                {
                    "id": 1,
                    "name": "Default Organization"
                }
            ],
            "ssh_keys": [],
            "timezone": null,
            "updated_at": "2018-11-14 08:19:46 UTC"
        }
    ],
    "search": null,
    "sort": {
        "by": null,
        "order": null
    },
    "subtotal": 2,
    "total": 2
}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sect-API_Guide-Creating_and_Modifying_Resources"><a class="anchor" href="#sect-API_Guide-Creating_and_Modifying_Resources"></a>5.1.3. Creating and modifying resources</h4>
<div class="paragraph">
<p>You can use <code>curl</code> to manipulate resources on your Foreman&#160;server.
API calls to Foreman require data in <code>json</code> format.
For more information, see <a href="#sect-API_Guide-Passing_JSON_Data_with_the_API_Request">Passing JSON data to the API request</a>.</p>
</div>
<div id="ex-API_Guide-Creating_a_New_User" class="paragraph">
<div class="title">Creating a user</div>
<p>This example creates a user by providing required information in the <code>--data</code> option.</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --header "Accept:application/json" \
--header "Content-Type:application/json" --request POST \
--user <em>My_User_Name</em>:<em>My_Password</em> \
--data "{\"firstname\":\"<em>Test Name</em>\",\"mail\":\"<em>test@example.com</em>\",\"login\":\"<em>test_user</em>\",\"password\":\"<em>password123</em>\",\"auth_source_id\":<em>1</em>}" \
https://<em>foreman.example.com</em>/api/users | python3 -m json.tool</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Modifying a user</div>
<p>This example modifies given name and login of the <code>test_user</code> that was created in <a href="#ex-API_Guide-Creating_a_New_User">Creating a user</a>.</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --header "Accept:application/json" \
--header "Content-Type:application/json" --request PUT \
--user <em>My_User_Name</em>:<em>My_Password</em> \
--data "{\"firstname\":\"<em>New Test Name</em>\",\"mail\":\"<em>test@example.com</em>\",\"login\":\"<em>new_test_user</em>\",\"password\":\"<em>password123</em>\",\"auth_source_id\":<em>1</em>}" \
https://<em>foreman.example.com</em>/api/users/<em>8</em> | python3 -m json.tool</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="calling-the-api-in-ruby"><a class="anchor" href="#calling-the-api-in-ruby"></a>5.2. Calling the API in Ruby</h3>
<div class="paragraph">
<p>You can use Ruby with the Foreman API to perform various tasks.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>These are example scripts and commands.
Ensure you review these scripts carefully before use, and replace any variables, user names, passwords, and other information to suit your own deployment.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="sect-API_Guide-Creating_Objects_Using_Ruby"><a class="anchor" href="#sect-API_Guide-Creating_Objects_Using_Ruby"></a>5.2.1. Creating objects by using Ruby</h4>
<div class="paragraph">
<p>This script connects to the Foreman API and creates an organization, and then creates three lifecycle environments in the organization.
If the organization already exists, the script uses that organization.
If any of the lifecycle environments already exist in the organization, the script raises an error and quits.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">#!/usr/bin/ruby

require 'rest-client'
require 'json'

url = 'https://foreman.example.com/api/v2/'
katello_url = "#{url}/katello/api/v2/"

$username = 'admin'
$password = 'changeme'

org_name = "MyOrg"
environments = [ "Development", "Testing", "Production" ]

# Performs a GET by using the passed URL location
def get_json(location)
  response = RestClient::Request.new(
    :method => :get,
    :url => location,
    :user => $username,
    :password => $password,
    :headers => { :accept => :json,
    :content_type => :json }
  ).execute
  JSON.parse(response.to_str)
end

# Performs a POST and passes the data to the URL location
def post_json(location, json_data)
  response = RestClient::Request.new(
    :method => :post,
    :url => location,
    :user => $username,
    :password => $password,
    :headers => { :accept => :json,
    :content_type => :json},
    :payload => json_data
  ).execute
  JSON.parse(response.to_str)
end

# Creates a hash with ids mapping to names for an array of records
def id_name_map(records)
  records.inject({}) do |map, record|
    map.update(record['id'] => record['name'])
  end
end

# Get list of existing organizations
orgs = get_json("#{katello_url}/organizations")
org_list = id_name_map(orgs['results'])

if !org_list.has_value?(org_name)
  # If our organization is not found, create it
  puts "Creating organization: \t#{org_name}"
  org_id = post_json("#{katello_url}/organizations", JSON.generate({"name"=> org_name}))["id"]
else
  # Our organization exists, so let's grab it
  org_id = org_list.key(org_name)
  puts "Organization \"#{org_name}\" exists"
end

# Get list of organization's lifecycle environments
envs = get_json("#{katello_url}/organizations/#{org_id}/environments")
env_list = id_name_map(envs['results'])
prior_env_id = env_list.key("Library")

# Exit the script if at least one life cycle environment already exists
environments.each do |e|
  if env_list.has_value?(e)
    puts "ERROR: One of the Environments is not unique to organization"
    exit
  end
end

 # Create life cycle environments
environments.each do |environment|
  puts "Creating environment: \t#{environment}"
  prior_env_id = post_json("#{katello_url}/organizations/#{org_id}/environments", JSON.generate({"name" => environment, "organization_id" => org_id, "prior_id" => prior_env_id}))["id"]
end</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sect-API_Guide-API_Using_Apipie_Bindings"><a class="anchor" href="#sect-API_Guide-API_Using_Apipie_Bindings"></a>5.2.2. Using apipie bindings with Ruby</h4>
<div class="paragraph">
<p>Apipie bindings are the Ruby bindings for apipie documented API calls.
They fetch and cache the API definition from Foreman and then generate API calls as needed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">#!/usr/bin/ruby

require 'apipie-bindings'

org_name = "MyOrg"
environments = [ "Development", "Testing", "Production" ]

# Create an instance of apipie bindings
@api = ApipieBindings::API.new({
  :uri => 'https://foreman.example.com/',
  :username => 'admin',
  :password => 'changeme',
  :api_version => 2
})

# Performs an API call with default options
def call_api(resource_name, action_name, params = {})
  http_headers = {}
  apipie_options = { :skip_validation => true }
  @api.resource(resource_name).call(action_name, params, http_headers, apipie_options)
end

# Creates a hash with IDs mapping to names for an array of records
def id_name_map(records)
  records.inject({}) do |map, record|
    map.update(record['id'] => record['name'])
  end
end

# Get list of existing organizations
orgs = call_api(:organizations, :index)
org_list = id_name_map(orgs['results'])

if !org_list.has_value?(org_name)
  # If our organization is not found, create it
  puts "Creating organization: \t#{org_name}"
  org_id = call_api(:organizations, :create, {'organization' => { :name => org_name }})['id']
else
  # Our organization exists, so let's grab it
  org_id = org_list.key(org_name)
  puts "Organization \"#{org_name}\" exists"
end

# Get list of organization's life cycle environments
envs = call_api(:lifecycle_environments, :index, {'organization_id' => org_id})
env_list = id_name_map(envs['results'])
prior_env_id = env_list.key("Library")

# Exit the script if at least one life cycle environment already exists
environments.each do |e|
  if env_list.has_value?(e)
    puts "ERROR: One of the Environments is not unique to organization"
    exit
  end
end

 # Create life cycle environments
environments.each do |environment|
  puts "Creating environment: \t#{environment}"
  prior_env_id = call_api(:lifecycle_environments, :create, {"name" => environment, "organization_id" => org_id, "prior_id" => prior_env_id })['id']
end</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="calling-the-api-in-python"><a class="anchor" href="#calling-the-api-in-python"></a>5.3. Calling the API in Python</h3>
<div class="paragraph">
<p>You can use Python with the Foreman API to perform various tasks.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>These are example scripts and commands.
Ensure you review these scripts carefully before use, and replace any variables, user names, passwords, and other information to suit your own deployment.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Example scripts in this section do not use SSL verification for interacting with the REST API.</p>
</div>
<div class="sect3">
<h4 id="sect-API_Guide-Creating_Objects_Using_Python"><a class="anchor" href="#sect-API_Guide-Creating_Objects_Using_Python"></a>5.3.1. Creating objects by using Python</h4>
<div class="paragraph">
<p>This script connects to the Foreman API and creates an organization, and then creates three environments in the organization.
If the organization already exists, the script uses that organization.
If any of the environments already exist in the organization, the script raises an error and quits.</p>
</div>
<div class="listingblock">
<div class="title">Python 3 example</div>
<div class="content">
<pre class="highlight"><code class="language-Python" data-lang="Python">#!/usr/bin/python3

import json
import sys

try:
    import requests
except ImportError:
    print("Please install the python-requests module.")
    sys.exit(-1)

# URL to your Foreman server
URL = "https://foreman.example.com"
# URL for the API to your deployed Foreman server
FOREMAN_API = f"{URL}/katello/api/v2/"
# Katello-specific API
KATELLO_API = f"{URL}/katello/api/"
POST_HEADERS = {'content-type': 'application/json'}
# Default credentials to login to Foreman
USERNAME = "admin"
PASSWORD = "changeme"
# Ignore SSL for now
SSL_VERIFY = False

# Name of the organization to be either created or used
ORG_NAME = "MyOrg"
# Name for life cycle environments to be either created or used
ENVIRONMENTS = ["Development", "Testing", "Production"]


def get_json(location):
    """
    Performs a GET by using the passed URL location
    """
    r = requests.get(location, auth=(USERNAME, PASSWORD), verify=SSL_VERIFY)
    return r.json()


def post_json(location, json_data):
    """
    Performs a POST and passes the data to the URL location
    """
    result = requests.post(
        location,
        data=json_data,
        auth=(USERNAME, PASSWORD),
        verify=SSL_VERIFY,
        headers=POST_HEADERS
    )
    return result.json()


def main():
    """
    Main routine that creates or re-uses an organization and
    life cycle environments.
    If life cycle environments already
    exist, exit out.
    """

    # Check if our organization already exists
    org = get_json(f"{FOREMAN_API}/organizations/{ORG_NAME}")

    # If our organization is not found, create it
    if org.get('error', None):
        org_id = post_json(
            f"{FOREMAN_API}/organizations/",
            json.dumps({"name": ORG_NAME})
        )["id"]
        print("Creating organization:\t" + ORG_NAME)
    else:
        # Our organization exists, so let's grab it
        org_id = org['id']
        print(f"Organization '{ORG_NAME}' exists.")

    # Now, let's fetch all available life cycle environments for this org...
    envs = get_json(
        f"{FOREMAN_API}/organizations/{org_id}/environments/"
    )

    # ...and add them to a dictionary, with respective 'Prior' environment
    prior_env_id = 0
    env_list = {}
    for env in envs['results']:
        env_list[env['id']] = env['name']
        prior_env_id = env['id'] if env['name'] == "Library" else prior_env_id

    # Exit the script if at least one life cycle environment already exists
    if all(environment in env_list.values() for environment in ENVIRONMENTS):
        print("ERROR: One of the Environments is not unique to organization")
        sys.exit(-1)

    # Create life cycle environments
    for environment in ENVIRONMENTS:
        new_env_id = post_json(
            f"{FOREMAN_API}/organizations/{org_id}/environments/",
            json.dumps({
                "name": environment,
                "organization_id": org_id,
                "prior": prior_env_id
            })
        )["id"]

        print("Creating environment:\t" + environment)
        prior_env_id = new_env_id


if __name__ == "__main__":
    main()</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sect-API_Guide-Requesting_information_from_the_API_using_Python"><a class="anchor" href="#sect-API_Guide-Requesting_information_from_the_API_using_Python"></a>5.3.2. Requesting information from the API by using Python</h4>
<div class="paragraph">
<p>This is an example script that uses Python for various API requests.</p>
</div>
<div class="listingblock">
<div class="title">Python 3 example</div>
<div class="content">
<pre class="highlight"><code class="language-Python" data-lang="Python">#!/usr/bin/env python3

import json
import sys

try:
    import requests
except ImportError:
    print("Please install the python-requests module.")
    sys.exit(-1)

SAT = "foreman.example.com"
# URL for the API to your deployed Foreman server
FOREMAN_API = f"https://{SAT}/api/"
KATELLO_API = f"https://{SAT}/katello/api/v2/"

POST_HEADERS = {'content-type': 'application/json'}
# Default credentials to login to Foreman
USERNAME = "admin"
PASSWORD = "password"
# Ignore SSL for now
SSL_VERIFY = False
#SSL_VERIFY = "./path/to/CA-certificate.crt" # Put the path to your CA certificate here to allow SSL_VERIFY


def get_json(url):
    # Performs a GET by using the passed URL location
    r = requests.get(url, auth=(USERNAME, PASSWORD), verify=SSL_VERIFY)
    return r.json()

def get_results(url):
    jsn = get_json(url)
    if jsn.get('error'):
        print("Error: " + jsn['error']['message'])
    else:
        if jsn.get('results'):
            return jsn['results']
        elif 'results' not in jsn:
            return jsn
        else:
            print("No results found")
    return None

def display_all_results(url):
    results = get_results(url)
    if results:
        print(json.dumps(results, indent=4, sort_keys=True))

def display_info_for_hosts(url):
    hosts = get_results(url)
    if hosts:
        print(f"{'ID':10}{'Name':40}{'IP':30}{'Operating System':30}")
        for host in hosts:
            print(f"{str(host['id']):10}{host['name']:40}{str(host['ip']):30}{str(host['operatingsystem_name']):30}")

def display_info_for_subs(url):
    subs = get_results(url)
    if subs:
        print(f"{'ID':10}{'Name':90}{'Start Date':30}")
        for sub in subs:
            print(f"{str(sub['id']):10}{sub['name']:90}{str(sub['start_date']):30}")

def main():
    host = SAT
    print(f"Displaying all info for host {host} ...")
    display_all_results(FOREMAN_API + 'hosts/' + host)

    print(f"Displaying all facts for host {host} ...")
    display_all_results(FOREMAN_API + f'hosts/{host}/facts')

    host_pattern = 'example'
    print(f"Displaying basic info for hosts matching pattern '{host_pattern}'...")
    display_info_for_hosts(FOREMAN_API + 'hosts?per_page=1&search=name~' + host_pattern)

    print(f"Displaying basic info for subscriptions")
    display_info_for_subs(KATELLO_API + 'subscriptions')

    environment = 'production'
    print(f"Displaying basic info for hosts in environment {environment}...")
    display_info_for_hosts(FOREMAN_API + 'hosts?search=environment=' + environment)


if __name__ == "__main__":
    main()</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="api-cheat-sheet"><a class="anchor" href="#api-cheat-sheet"></a>6. API cheat sheet</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can review the following examples of how to use the Foreman API to perform various tasks.
You can use the API on Foreman&#160;server via HTTPS on port 443.</p>
</div>
<div class="paragraph">
<p>For example, in Ruby, you can specify the Foreman&#160;server URL as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">url = 'https://<em>foreman.example.com</em>/api/v2/'
katello_url = 'https://<em>foreman.example.com</em>/katello/api/v2/'</pre>
</div>
</div>
<div class="paragraph">
<p>You can use these values to fully automate your scripts, removing any need to verify which ports to use.</p>
</div>
<div class="paragraph">
<p>The following examples use <code>curl</code> for sending API requests.
For more information, see <a href="#calling-the-api-in-curl">Calling the API in curl</a>.</p>
</div>
<div class="sect2">
<h3 id="working-with-hosts"><a class="anchor" href="#working-with-hosts"></a>6.1. Working with hosts</h3>
<div class="paragraph">
<div class="title">Listing hosts</div>
<p>This example returns a list of Foreman hosts.</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --request GET --user <em>My_User_Name</em>:<em>My_Password</em> \
https://<em>foreman.example.com</em>/api/v2/hosts | python3 -m json.tool</pre>
</div>
</div>
<div class="paragraph">
<p>Example response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">{
      ...
       "total" =&gt; 2,
    "subtotal" =&gt; 2,
        "page" =&gt; 1,
    "per_page" =&gt; 1000,
      "search" =&gt; nil,
        "sort" =&gt; {
           "by" =&gt; nil,
        "order" =&gt; nil
    },
     "results" =&gt; [
      ...
}</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Requesting information for a host</div>
<p>This request returns information for the host <code>foreman.example.com</code>.</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$  curl --request GET --user <em>My_User_Name</em>:<em>My_Password</em> \
https://<em>foreman.example.com</em>/api/v2/hosts/<em>foreman.example.com</em> \
| python3 -m json.tool</pre>
</div>
</div>
<div class="paragraph">
<p>Example response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">{
    "all_puppetclasses": [],
    "architecture_id": 1,
    "architecture_name": "x86_64",
    "build": false,
    "capabilities": [
        "build"
    ],
    "certname": "<em>foreman.example.com</em>",
    "comment": null,
    "compute_profile_id": null,
    ...
}</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Listing host facts</div>
<p>This request returns all facts for the host <code>foreman.example.com</code>.</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --request GET --user <em>My_User_Name</em>:<em>My_Password</em> \
https://<em>foreman.example.com</em>/api/v2/hosts/<em>foreman.example.com</em>/facts \
| python3 -m json.tool</pre>
</div>
</div>
<div class="paragraph">
<p>Example response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">{
    ...
    "results": {
        "<em>foreman.example.com</em>": {
            "augeasversion": "1.0.0",
            "bios_release_date": "01/01/2007",
            "bios_version": "0.5.1",
            "blockdevice_sr0_size": "1073741312",
            "facterversion": "1.7.6",
            ...
}</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Searching for hosts with matching patterns</div>
<p>This query returns all hosts that match the pattern "example".</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --request GET --user <em>My_User_Name</em>:<em>My_Password</em> \
https://<em>foreman.example.com</em>/api/v2/hosts?search=example \
| python3 -m json.tool</pre>
</div>
</div>
<div class="paragraph">
<p>Example response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">{
    ...
    "results": [
        {
            "name": "<em>foreman.example.com</em>",
            ...
        }
    ],
    "search": "example",
    ...
}</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Searching for hosts in an environment</div>
<p>This query returns all hosts in the <code>production</code> environment.</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --request GET --user <em>My_User_Name</em>:<em>My_Password</em> \
https://<em>foreman.example.com</em>/api/v2/hosts?search=environment=production \
| python3 -m json.tool</pre>
</div>
</div>
<div class="paragraph">
<p>Example response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">{
    ...
    "results": [
        {
            "environment_name": "production",
            "name": "<em>foreman.example.com</em>",
            ...
        }
    ],
    "search": "environment=production",
    ...
}</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Searching for hosts with a specific fact value</div>
<p>This query returns all hosts with a model name <code>RHV Hypervisor</code>.</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --request GET --user <em>My_User_Name</em>:<em>My_Password</em> \
https://<em>foreman.example.com</em>/api/v2/hosts?search=model=\"RHV+Hypervisor\" \
| python3 -m json.tool</pre>
</div>
</div>
<div class="paragraph">
<p>Example response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">{
    ...
    "results": [
        {
            "model_id": 1,
            "model_name": "RHV Hypervisor",
            "name": "<em>foreman.example.com</em>",
            ...
        }
    ],
    "search": "model=\"RHV Hypervisor\"",
    ...
}</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Deleting a host</div>
<p>This request deletes a host with a name <em>host1.example.com</em>.</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --request DELETE --user <em>My_User_Name</em>:<em>My_Password</em> \
https://<em>foreman.example.com</em>/api/v2/hosts/<em>host1.example.com</em> \
| python3 -m json.tool</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Downloading a full-host boot disk image</div>
<p>This request downloads a full boot disk image for a host by its ID.</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --request GET --user <em>My_User_Name</em>:<em>My_Password</em> \
https://<em>foreman.example.com</em>/api/bootdisk/hosts/<em>host_ID</em>?full=true \
--output <em>image</em>.iso</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="working-with-lifecycle-environments"><a class="anchor" href="#working-with-lifecycle-environments"></a>6.2. Working with lifecycle environments</h3>
<div class="paragraph">
<p>Foreman divides application life cycles into lifecycle environments, which represent each stage of the application life cycle.
Lifecycle environments are linked to from an environment path.
To create linked lifecycle environments with the API, use the <code>prior_id</code> parameter.</p>
</div>
<div class="paragraph">
<p>You can find the built-in API reference for lifecycle environments at <code>https://<em>foreman.example.com</em>/apidoc/v2/lifecycle_environments.html</code>.
The API routes include <code>/katello/api/environments</code> and <code>/katello/api/organizations/:organization_id/environments</code>.</p>
</div>
<div class="paragraph">
<div class="title">Listing lifecycle environments</div>
<p>Use this API call to list all the current lifecycle environments on your Foreman for the default organization with ID <code>1</code>.</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --header "Accept:application/json" \
--header "Content-Type:application/json" \
--request GET --user <em>My_User_Name</em>:<em>My_Password</em> \
https://<em>foreman.example.com</em>/katello/api/organizations/1/environments \
| python3 -m json.tool`</pre>
</div>
</div>
<div class="paragraph">
<p>Example response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">      <em>output omitted</em>
   "description": null,
   <strong>"id": 1,</strong>
   <strong>"label": "Library",</strong>
   "library": true,
   <strong>"name": "Library",</strong>
   "organization": {
        "id": 1,
        "label": "Default_Organization",
        "name": "Default Organization"
   },
   "permissions": {
       "destroy_lifecycle_environments": false,
       "edit_lifecycle_environments": true,
       "promote_or_remove_content_views_to_environments": true,
       "view_lifecycle_environments": true
   },
   <strong>"prior": null,</strong>
   <strong>"successor": null,</strong>
   <em>output truncated</em></pre>
</div>
</div>
<div id="proc-Creating_Linked_Life_Cycle_Environments" class="paragraph">
<div class="title">Creating linked lifecycle environments</div>
<p>Use this example to create a path of lifecycle environments.</p>
</div>
<div class="paragraph">
<p>This procedure uses the default Library environment with ID <code>1</code> as the starting point for creating lifecycle environments.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Choose an existing lifecycle environment that you want to use as a starting point.
List the environment by using its ID, in this case, the environment with ID <code>1</code>:</p>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --request GET --user <em>My_User_Name</em>:<em>My_Password</em> \
https://<em>foreman.example.com</em>/katello/api/environments/1 \
| python3 -m json.tool</pre>
</div>
</div>
<div class="paragraph">
<p>Example response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">	<em>output omitted</em>
   <strong>"id": 1,</strong>
   <strong>"label": "Library",</strong>
	<em>output omitted</em>
    <strong>"prior": null,</strong>
    <strong>"successor": null,</strong>
  <em>output truncated</em></pre>
</div>
</div>
</li>
<li>
<p>Create a JSON file, for example, <code>life-cycle.json</code>, with the following content:</p>
<div class="listingblock">
<div class="content">
<pre>{"organization_id":1,"label":"api-dev","name":"API Development","prior":1}</pre>
</div>
</div>
</li>
<li>
<p>Create a lifecycle environment by using the <code>prior</code> option set to <code>1</code>.</p>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --header "Accept:application/json" \
--header "Content-Type:application/json" \
--request POST --user <em>My_User_Name</em>:<em>My_Password</em> \
--data @life-cycle.json \
https://<em>foreman.example.com</em>/katello/api/environments \
| python3 -m json.tool</pre>
</div>
</div>
<div class="paragraph">
<p>Example response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">      <em>output omitted</em>
    "description": null,
    <strong>"id": 2,</strong>
    "label": "api-dev",
    "library": false,
    "name": "API Development",
    "organization": {
        "id": 1,
        "label": "Default_Organization",
        "name": "Default Organization"
    },
    "permissions": {
        "destroy_lifecycle_environments": true,
        "edit_lifecycle_environments": true,
        "promote_or_remove_content_views_to_environments": true,
        "view_lifecycle_environments": true
    },
   <strong>"prior":</strong> {
        <strong>"id": 1,</strong>
        "name": "Library"
    },
    <em>output truncated</em></pre>
</div>
</div>
<div class="paragraph">
<p>In the command output, you can see the ID for this lifecycle environment is <code>2</code>, and the lifecycle environment before this one is <code>1</code>.
Use the lifecycle environment with ID <code>2</code> to create a successor to this environment.</p>
</div>
</li>
<li>
<p>Edit the previously created <code>life-cycle.json</code> file, updating the <code>label</code>, <code>name</code>, and <code>prior</code> values.</p>
<div class="listingblock">
<div class="content">
<pre>{"organization_id":1,"label":"api-qa","name":"API QA","prior":2}</pre>
</div>
</div>
</li>
<li>
<p>Create a lifecycle environment, by using the <code>prior</code> option set to <code>2</code>.</p>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --header "Accept:application/json" \
--header "Content-Type:application/json" \
--request POST --user <em>My_User_Name</em>:<em>My_Password</em> \
--data @life-cycle.json \
https://<em>foreman.example.com</em>/katello/api/environments \
| python3 -m json.tool</pre>
</div>
</div>
<div class="paragraph">
<p>Example response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">      <em>output omitted</em>
   "description": null,
   <strong>"id": 3,</strong>
    "label": "api-qa",
    "library": false,
    "name": "API QA",
    "organization": {
        "id": 1,
        "label": "Default_Organization",
        "name": "Default Organization"
    },
    "permissions": {
        "destroy_lifecycle_environments": true,
        "edit_lifecycle_environments": true,
        "promote_or_remove_content_views_to_environments": true,
        "view_lifecycle_environments": true
    },
   <strong>"prior":</strong> {
        <strong>"id": 2,</strong>
        "name": "API Development"
    },
    "successor": null,
    <em>output truncated</em></pre>
</div>
</div>
<div class="paragraph">
<p>In the command output, you can see the ID for this lifecycle environment is <code>3</code>, and the lifecycle environment before this one is <code>2</code>.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Updating a lifecycle environment</div>
<p>You can update a lifecycle environment by using a PUT command.</p>
</div>
<div class="paragraph">
<p>This example request updates a description of the lifecycle environment with ID <code>3</code>.</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --header "Accept:application/json" \
--header "Content-Type:application/json" \
--request POST --user <em>My_User_Name</em>:<em>My_Password</em> \
--data '{"description":"Quality Acceptance Testing"}' \
https://<em>foreman.example.com</em>/katello/api/environments/3 \
| python3 -m json.tool</pre>
</div>
</div>
<div class="paragraph">
<p>Example response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">      <em>output omitted</em>
    <strong>"description": "Quality Acceptance Testing",</strong>
    "id": 3,
    "label": "api-qa",
    "library": false,
    "name": "API QA",
    "organization": {
        "id": 1,
        "label": "Default_Organization",
        "name": "Default Organization"
    },
    "permissions": {
        "destroy_lifecycle_environments": true,
        "edit_lifecycle_environments": true,
        "promote_or_remove_content_views_to_environments": true,
        "view_lifecycle_environments": true
    },
    "prior": {
        "id": 2,
        "name": "API Development"
    },
    <em>output truncated</em></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Deleting a lifecycle environment</div>
<p>You can delete a lifecycle environment provided it has no successor.
Therefore, delete them in reverse order by using a command in the following format:</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --request DELETE --user <em>My_User_Name</em>:<em>My_Password</em> \
https://<em>foreman.example.com</em>/katello/api/environments/<em>:id</em></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="uploading-content-to-foreman-server"><a class="anchor" href="#uploading-content-to-foreman-server"></a>6.3. Uploading Content to Foreman&#160;server</h3>
<div class="paragraph">
<p>You can use the Foreman API to upload and import large files to your Foreman&#160;server.
This process involves four steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create an upload request.</p>
</li>
<li>
<p>Upload the content.</p>
</li>
<li>
<p>Import the content.</p>
</li>
<li>
<p>Delete the upload request.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The maximum file size that you can upload is 2&#160;MB.
For information about uploading larger content, see <a href="#exam-API_Guide-Uploading_Content_Larger_than_2_MB">Uploading content larger than 2 MB</a>.</p>
</div>
<div id="proc-API_Guide-Uploading_Content_to_the_Foreman_Server" class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Assign the package name to the variable <code>name</code>:</p>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ export name=jq-1.6-2.el7.x86_64.rpm</pre>
</div>
</div>
</li>
<li>
<p>Assign the checksum of the file to the variable <code>checksum</code>:</p>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ export checksum=$(sha256sum $name|cut -c 1-65)</pre>
</div>
</div>
</li>
<li>
<p>Assign the file size to the variable <code>size</code>:</p>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ export size=$(du -bs $name|cut -f 1)</pre>
</div>
</div>
</li>
<li>
<p>Create an upload request that returns the upload ID of the request by using <code>size</code> and <code>checksum</code>.</p>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl -H 'Content-Type: application/json' -X POST -k \
-u <em>My_User_Name</em>:<em>My_Password</em> \
-d "{\"size\": \"$size\", \"checksum\":\"$checksum\"}" \
https://<em>foreman.example.com</em>/katello/api/v2/repositories/76/content_uploads</pre>
</div>
</div>
<div class="paragraph">
<p>where 76, in this case, is an example Repository ID.</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">{"upload_id":"37eb5900-597e-4ac3-9bc5-2250c302fdc4"}</pre>
</div>
</div>
</li>
<li>
<p>Assign the upload ID to the variable <code>upload_id</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ export upload_id=37eb5900-597e-4ac3-9bc5-2250c302fdc4</pre>
</div>
</div>
</li>
<li>
<p>Assign the path of the package you want to upload to the variable <code>path</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ export path=/root/jq/jq-1.6-2.el7.x86_64.rpm</pre>
</div>
</div>
</li>
<li>
<p>Upload your content.
Ensure you use the correct MIME type when you upload data.
The API uses the <code>application/json</code> MIME type for the requests to Foreman unless stated otherwise.
Combine the upload ID, MIME type, and other parameters to upload content.</p>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl -u <em>My_User_Name</em>:<em>My_Password</em> -H Accept:application/json -H \
Content-Type:multipart/form-data --request PUT --data-urlencode size=$size --data-urlencode offset=0 \
--data-urlencode content@${path} \
https://<em>foreman.example.com</em>/katello/api/v2/repositories/76/content_uploads/$upload_id</pre>
</div>
</div>
</li>
<li>
<p>After you have uploaded the content to your Foreman&#160;server, you need to import it into the appropriate repository.
Until you complete this step, Foreman&#160;server does not detect the new content.</p>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl -H "Content-Type:application/json" -X PUT -u \
<em>My_User_Name</em>:<em>My_Password</em> -k -d \
"{\"uploads\":[{\"id\": \"$upload_id\", \"name\": \"$name\", \
\"checksum\": \"$checksum\" }]}" \
https://<em>foreman.example.com</em>/katello/api/v2/repositories/76/import_uploads</pre>
</div>
</div>
</li>
<li>
<p>After you have successfully uploaded and imported your content, you can delete the upload request.
This frees any temporary disk space that data is using during the upload.</p>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl -H 'Content-Type: application/json' -X DELETE -k \
-u <em>My_User_Name</em>:<em>My_Password</em> -d "{}" \
https://<em>foreman.example.com</em>/katello/api/v2/repositories/76/content_uploads/$upload_id</pre>
</div>
</div>
</li>
</ol>
</div>
<div id="exam-API_Guide-Uploading_Content_Larger_than_2_MB" class="paragraph">
<div class="title">Uploading content larger than 2 MB</div>
<p>The following example demonstrates how to split a large file into chunks, create an upload request, upload the individual files, import them to Foreman, and then delete the upload request.
Note that this example uses sample content, host names, user names, repository ID, and file names.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Assign the package name to the variable <code>name</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ export name=bpftool-3.10.0-1160.2.1.el7.centos.plus.x86_64.rpm</pre>
</div>
</div>
</li>
<li>
<p>Assign the checksum of the file to the variable <code>checksum</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ export  checksum=$(sha256sum $name|cut -c 1-65)</pre>
</div>
</div>
</li>
<li>
<p>Assign the file size to the variable <code>size</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ export  size=$(du -bs $name|cut -f 1)</pre>
</div>
</div>
</li>
<li>
<p>The following command creates a new upload request and returns the upload ID of the request by using <code>size</code> and <code>checksum</code>.</p>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl -H 'Content-Type: application/json' -X POST -k \
-u <em>My_User_Name</em>:<em>My_Password</em> -d "{\"size\": \"$size\", \
\"checksum\":\"$checksum\"}" \
https://<em>foreman.example.com</em>/katello/api/v2/repositories/76/content_uploads</pre>
</div>
</div>
<div class="paragraph">
<p>where 76, in this case, is an example Repository ID.</p>
</div>
<div class="paragraph">
<p>Example output</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">{"upload_id":"37eb5900-597e-4ac3-9bc5-2250c302fdc4"}</pre>
</div>
</div>
</li>
<li>
<p>Assign the upload ID to the variable <code>upload_id</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ export upload_id=37eb5900-597e-4ac3-9bc5-2250c302fdc4</pre>
</div>
</div>
</li>
<li>
<p>Split the file in 2MB chunks:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ split --bytes 2MB --numeric-suffixes \
--suffix-length=1 bpftool-3.10.0-1160.2.1.el7.centos.plus.x86_64.rpm bpftool</pre>
</div>
</div>
<div class="paragraph">
<p>Example output</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ ls bpftool[0-9] -l
-rw-r--r--.
1 root root 2000000 Mar 31 14:15 bpftool0
-rw-r--r--.
1 root root 2000000 Mar 31 14:15 bpftool1
-rw-r--r--.
1 root root 2000000 Mar 31 14:15 bpftool2
-rw-r--r--.
1 root root 2000000 Mar 31 14:15 bpftool3
-rw-r--r--.
1 root root  868648 Mar 31 14:15 bpftool4</pre>
</div>
</div>
</li>
<li>
<p>Assign the prefix of the split files to the variable path.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ export path=/root/tmp/bpftool</pre>
</div>
</div>
</li>
<li>
<p>Upload the file chunks.
The offset starts at 0 bytes for the first chunk and increases by 2000000 bytes for each file.
Note the use of the offset parameter and how it relates to the file size.
Note also that the indexes are used after the path variable, for example, ${path}0, ${path}1.</p>
<div class="paragraph">
<p>Example requests:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl -u <em>My_User_Name</em>:<em>My_Password</em> -H Accept:application/json -H \
Content-Type:multipart/form-data  \
-X PUT --data-urlencode size=$size --data-urlencode offset=0 \
--data-urlencode content@${path}0 \
https://<em>foreman.example.com</em>/katello/api/v2/repositories/76/content_uploads/$upload_id

$ curl -u <em>My_User_Name</em>:<em>My_Password</em> -H Accept:application/json -H \
Content-Type:multipart/form-data \
-X PUT --data-urlencode size=$size --data-urlencode offset=2000000 \
--data-urlencode content@${path}1 \
https://<em>foreman.example.com</em>/katello/api/v2/repositories/76/content_uploads/$upload_id

$ curl -u <em>My_User_Name</em>:<em>My_Password</em> -H Accept:application/json -H \
Content-Type:multipart/form-data \
-X PUT --data-urlencode size=$size --data-urlencode offset=4000000 \
--data-urlencode content@${path}2 \
https://<em>foreman.example.com</em>/katello/api/v2/repositories/76/content_uploads/$upload_id

$curl -u <em>My_User_Name</em>:<em>My_Password</em> -H Accept:application/json -H \
Content-Type:multipart/form-data \
-X PUT --data-urlencode size=$size --data-urlencode offset=6000000
--data-urlencode content@${path}3 \
https://<em>foreman.example.com</em>/katello/api/v2/repositories/76/content_uploads/$upload_id

$ curl -u <em>My_User_Name</em>:<em>My_Password</em> -H Accept:application/json -H \
Content-Type:multipart/form-data \
-X PUT --data-urlencode size=$size --data-urlencode offset=8000000 \
--data-urlencode content@${path}4 \
https://<em>foreman.example.com</em>/katello/api/v2/repositories/76/content_uploads/$upload_id</pre>
</div>
</div>
</li>
<li>
<p>Import the complete upload to the repository:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl -H "Content-Type:application/json" -X PUT -u \
<em>My_User_Name</em>:<em>My_Password</em> -k -d \
"{\"uploads\":[{\"id\": \"$upload_id\", \
\"name\": \"$name\", \"checksum\": \"$checksum\" }]}" \
https://<em>foreman.example.com</em>/katello/api/v2/repositories/76/import_uploads</pre>
</div>
</div>
</li>
<li>
<p>Delete the upload request:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl -H 'Content-Type: application/json' -X DELETE -k \
-u <em>My_User_Name</em>:<em>My_Password</em> -d "{}" \
https://<em>foreman.example.com</em>/katello/api/v2/repositories/76/content_uploads/$upload_id</pre>
</div>
</div>
</li>
</ol>
</div>
<div id="exam-API_Guide-Uploading_Duplicate_Content" class="paragraph">
<div class="title">Uploading duplicate content</div>
<p>Note that if you try to upload duplicate content using:</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl -H 'Content-Type: application/json' -X POST -k \
-u <em>My_User_Name</em>:<em>My_Password</em> -d "{\"size\": \"$size\", \"checksum\":\"$checksum\"}" \
https://<em>foreman.example.com</em>/katello/api/v2/repositories/76/content_uploads</pre>
</div>
</div>
<div class="paragraph">
<p>The call will return a content unit ID instead of an upload ID, similar to this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">{"content_unit_href":"/pulp/api/v3/content/file/files/c1bcdfb8-d840-4604-845e-86e82454c747/"}</pre>
</div>
</div>
<div class="paragraph">
<p>You can copy this output and call import uploads directly to add the content to a repository:</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl -H "Content-Type:application/json" -X PUT -u \
<em>My_User_Name</em>:<em>My_Password</em> -k \-d \
"{\"uploads\":[{\"content_unit_id\": \"/pulp/api/v3/content/file/files/c1bcdfb8-d840-4604-845e-86e82454c747/\", \
\"name\": \"$name\", \ \"checksum\": \"$checksum\" }]}" \
https://<em>foreman.example.com</em>/katello/api/v2/repositories/76/import_uploads</pre>
</div>
</div>
<div class="paragraph">
<p>Note that the call changes from using <code>upload_id</code> to using <code>content_unit_id</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="applying-errata-to-hosts"><a class="anchor" href="#applying-errata-to-hosts"></a>6.4. Applying errata to hosts</h3>
<div class="paragraph">
<p>You can use the API to apply errata to a host, host group, or host collection.
The following is the basic syntax of a PUT request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --header "Accept:application/json" \
--header "Content-Type:application/json" --request PUT \
--user <em>My_User_Name</em>:<em>My_Password</em> \
--data <em>My_JSON_Formatted_Data</em> https://<em>foreman.example.com</em></pre>
</div>
</div>
<div class="paragraph">
<p>You can browse the built-in API doc to find a URL to use for applying errata.
You can use the Foreman web UI to help discover the format for the search query.
Navigate to <strong>Hosts</strong> &gt; <strong>Host Collections</strong> and select a host collection.
Go to <strong>Collection Actions</strong> &gt; <strong>Errata Installation</strong> and notice the search query box contents.
For example, for a Host Collection called <em>my-collection</em>, the search box contains <code>host_collection="my-collection"</code>.</p>
</div>
<div id="exam-API_Guide-Applying_Errata_to_a_Host" class="paragraph">
<div class="title">Applying errata to a host</div>
<p>This example uses the API URL for bulk actions <code>/katello/api/hosts/bulk/install_content</code> to show the format required for a simple search.</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --header "Accept:application/json" \
--header "Content-Type:application/json" --request PUT \
--user <em>My_User_Name</em>:<em>My_Password</em> \
--data "{\"organization_id\":1,\"included\":{\"search\":\"<em>my-host</em>\"},\"content_type\":\"errata\",\"content\":[\"<em>RHBA-2016:1981</em>\"]}" \
https://<em>foreman.example.com</em>/api/v2/hosts/bulk/install_content</pre>
</div>
</div>
<div id="exam-API_Guide-Applying_Errata_to_a_Host_Collection" class="paragraph">
<div class="title">Applying errata to a host collection</div>
<p>In this example, notice the level of escaping required to pass the search string <code>host_collection="my-collection"</code> as seen in the Foreman web UI.
Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --header "Accept:application/json" \
--header "Content-Type:application/json" --request PUT \
--user <em>My_User_Name</em>:<em>My_Password</em> \
--data "{\"organization_id\":1,\"included\":{\"search\":\"host_collection=\\\"<em>my-collection</em>\\\"\"},\"content_type\":\"errata\",\"content\":[\"<em>RHBA-2016:1981</em>\"]}" \
https://<em>foreman.example.com</em>/api/v2/hosts/bulk/install_content</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="using-extended-searches"><a class="anchor" href="#using-extended-searches"></a>6.5. Using extended searches</h3>
<div class="paragraph">
<p>You can find search parameters that you can use to build your search queries in the Foreman web UI.
For more information, see <a href="https://docs.theforeman.org/3.12/Administering_Project/index-katello.html#Building_Search_Queries_admin">Building search queries</a> in <em>Administering Foreman</em>.</p>
</div>
<div class="paragraph">
<p>For example, you can search for hosts.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>All Hosts</strong> and click the <strong>Search</strong> field to display a list of search parameters.</p>
</li>
<li>
<p>Locate the search parameters that you want to use.
For this example, locate <strong>os_title</strong> and <strong>model</strong>.</p>
</li>
<li>
<p>Combine the search parameters in your API query as follows:</p>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --user <em>My_User_Name</em>:<em>My_Password</em> \
https://<em>foreman.example.com</em>/api/v2/hosts?search=os_title=\"RedHat+7.7\",model=\"PowerEdge+R330\" \
| python3 -m json.tool</pre>
</div>
</div>
<div class="paragraph">
<p>Example response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">  {
    ...
    "results": [
        {
            "model_id": 1,
            "model_name": "PowerEdge R330",
            "name": "<em>foreman.example.com</em>",
            "operatingsystem_id": 1,
            "operatingsystem_name": "RedHat 7.7",
            ...
        }
    ],
    "search": "os_title=\"RedHat 7.7\",model=\"PowerEdge R330\"",
    "subtotal": 1,
    "total": 11
}</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="using-searches-with-pagination-control"><a class="anchor" href="#using-searches-with-pagination-control"></a>6.6. Using searches with pagination control</h3>
<div class="paragraph">
<p>You can use the <code>per_page</code> and <code>page</code> pagination parameters to limit the search results that an API search query returns.
The <code>per_page</code> parameter specifies the number of results per page and the <code>page</code> parameter specifies which page, as calculated by the <code>per_page</code> parameter, to return.</p>
</div>
<div class="paragraph">
<p>The default number of items to return is set to 1000 when you do not specify any pagination parameters, but the <code>per_page</code> value has a default of 20 which applies when you specify the <code>page</code> parameter.</p>
</div>
<div id="listing-content-views" class="paragraph">
<div class="title">Listing content views</div>
<p>This example returns a list of Content Views in pages.
The list contains 10 keys per page and returns the third page.</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --request GET --user <em>My_User_Name</em>:<em>My_Password</em> \
https://foreman.example.com/katello/api/content_views?per_page=10&amp;amp;page=3</pre>
</div>
</div>
<div id="listing-activation-keys" class="paragraph">
<div class="title">Listing activation keys</div>
<p>This example returns a list of activation keys for an organization with ID <code>1</code> in pages.
The list contains 30 keys per page and returns the second page.</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --request GET --user <em>My_User_Name</em>:<em>My_Password</em> \
https://foreman.example.com/katello/api/activation_keys?organization_id=1&amp;amp;per_page=30&amp;amp;page=2</pre>
</div>
</div>
<div id="ex-Returning_Multiple_Pages" class="paragraph">
<div class="title">Returning multiple pages</div>
<p>You can use a <code>for</code> loop structure to get multiple pages of results.</p>
</div>
<div class="paragraph">
<p>This example returns pages 1 to 3 of Content Views with 5 results per page:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ for i in <code>seq 1 3</code>; do \
curl --request GET --user <em>My_User_Name</em>:<em>My_Password</em> \
https://foreman.example.com/katello/api/content_views?per_page=5&amp;amp;page=$i; \
done</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="overriding-smart-class-parameters"><a class="anchor" href="#overriding-smart-class-parameters"></a>6.7. Overriding Smart Class parameters</h3>
<div class="paragraph">
<p>You can search for Smart Parameters by using the API and supply a value to override a Smart Parameter in a Class.
You can find the full list of attributes that you can modify in the built-in API reference at <code>https://<em>foreman.example.com</em>/apidoc/v2/smart_class_parameters/update.html</code>.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Find the ID of the Smart Class parameter you want to change:</p>
<div class="ulist">
<ul>
<li>
<p>List all Smart Class Parameters.</p>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --request GET --user <em>My_User_Name</em>:<em>My_Password</em> \
https://<em>foreman.example.com</em>/api/smart_class_parameters</pre>
</div>
</div>
</li>
<li>
<p>If you know the Puppet class ID, for example 5, you can restrict the scope:
Example request:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --request GET --user <em>My_User_Name</em>:<em>My_Password</em> \
https://<em>foreman.example.com</em>/api/puppetclasses/5/smart_class_parameters</pre>
</div>
</div>
<div class="paragraph">
<p>Both calls accept a search parameter.
You can view the full list of searchable fields in the Foreman web UI.
Navigate to <strong>Configure</strong> &gt; <strong>Smart variables</strong> and click in the search query box to reveal the list of fields.</p>
</div>
<div class="paragraph">
<p>Two particularly useful search parameters are <code>puppetclass_name</code> and <code>key</code>, which you can use to search for a specific parameter.
For example, use the <code>--data</code> option to pass URL encoded data.</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --request GET --user <em>My_User_Name</em>:<em>My_Password</em> \
--data 'search=puppetclass_name = access_insights_client and key = authmethod' \
https://<em>foreman.example.com</em>/api/smart_class_parameters</pre>
</div>
</div>
<div class="paragraph">
<p>Foreman supports standard scoped-search syntax.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>When you find the ID of the parameter, list the full details including current override values.</p>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --request GET --user <em>My_User_Name</em>:<em>My_Password</em> \
https://<em>foreman.example.com</em>/api/smart_class_parameters/<em>63</em></pre>
</div>
</div>
</li>
<li>
<p>Enable overriding of parameter values.</p>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --header "Accept:application/json" \
--header "Content-Type:application/json" \
--request PUT --user <em>My_User_Name</em>:<em>My_Password</em> \
--data '{"smart_class_parameter":{"override":true}}' \
https://<em>foreman.example.com</em>/api/smart_class_parameters/63</pre>
</div>
</div>
<div class="paragraph">
<p>Note that you cannot create or delete the parameters manually.
You can only modify their attributes.
Foreman creates and deletes parameters only upon class import from Smart&#160;Proxies.</p>
</div>
</li>
<li>
<p>Add custom override matchers.</p>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --header "Accept:application/json" \
--header "Content-Type:application/json" \
--request PUT --user <em>My_User_Name</em>:<em>My_Password</em> \
--data '{"smart_class_parameter":{"override_value":{"match":"hostgroup=Test","value":"2.4.6"}}}' \
https://<em>foreman.example.com</em>/api/smart_class_parameters/63</pre>
</div>
</div>
<div class="paragraph">
<p>For more information about override values, see <code>https://<em>foreman.example.com</em>/apidoc/v2/override_values.html</code>.</p>
</div>
</li>
<li>
<p>You can delete override values.</p>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --request DELETE --user <em>My_User_Name</em>:<em>My_Password</em> \
https://<em>foreman.example.com</em>/api/smart_class_parameters/63/override_values/3</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="modifying-a-smart-class-parameter-by-using-an-external-file"><a class="anchor" href="#modifying-a-smart-class-parameter-by-using-an-external-file"></a>6.8. Modifying a Smart Class parameter by using an external file</h3>
<div class="paragraph">
<p>You can modify a Puppet Smart Class parameter by using an external file.</p>
</div>
<div class="paragraph">
<p>Using external files simplifies working with JSON data.
You can use an editor with syntax highlighting to avoid and locate mistakes.</p>
</div>
<div id="proc-API_Guide-Modifying_a_Smart_Class_Parameter_Using_an_External_File" class="paragraph">
<div class="title">Modifying a Smart Class parameter by using an external file</div>
<p>This example uses a MOTD Puppet manifest.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Search for the Puppet Class by name, <code>motd</code> in this case.</p>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --header "Accept:application/json" \
--header "Content-Type:application/json" \
--request GET --user <em>My_User_Name</em>:<em>My_Password</em> \
https://<em>foreman.example.com</em>/api/smart_class_parameters?search=puppetclass_name=motd \
| python3 -m json.tool</pre>
</div>
</div>
</li>
<li>
<p>Examine the following output.
Each Smart Class Parameter has an ID that is global for the same Foreman instance.
The <code>content</code> parameter of the <code>motd</code> class has <code>id=3</code>.
Do not confuse this with the Puppet Class ID that displays before the Puppet Class name.</p>
<div class="paragraph">
<p>Example response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">{
	"avoid_duplicates": false,
		<strong>"created_at": "2017-02-06 12:37:48 UTC",</strong> # Remove this line.
			<strong>"default_value": "",</strong> # Add a new value here.
			"description": "",
		"hidden_value": "",
		"hidden_value?": false,
		"id": 3,
		"merge_default": false,
		"merge_overrides": false,
		<strong>"override": false,</strong> # Set the override value to <code>true</code>.
			"override_value_order": "fqdn\nhostgroup\nos\ndomain",
		<strong>"override_values": [],</strong> # Remove this line.
			"override_values_count": 0,
		"parameter": "content",
		"parameter_type": "string",
		"puppetclass_id": 3,
		"puppetclass_name": "motd",
		"required": false,
		<strong>"updated_at": "2017-02-07 11:56:55 UTC",</strong> # Remove this line.
			"use_puppet_default": false,
		"validator_rule": null,
		"validator_type": ""
}</pre>
</div>
</div>
</li>
<li>
<p>Use the parameter ID <code>3</code> to get the information specific to the <code>motd</code> parameter and redirect the output to a file, for example, <strong>output_file.json</strong>.</p>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --header "Accept:application/json" \
--header "Content-Type:application/json" --request GET \
--user <em>My_User_Name</em>:<em>My_Password</em> \
https://<em>foreman.example.com</em>/api/smart_class_parameters/3 \
| python3 -m json.tool &gt; output_file.json</pre>
</div>
</div>
</li>
<li>
<p>Copy the file created in the previous step to a new file for editing, for example, <code>changed_file.json</code>:</p>
<div class="listingblock">
<div class="content">
<pre>$ cp output_file.json changed_file.json</pre>
</div>
</div>
</li>
<li>
<p>Modify the required values in the file.
In this example, change the content parameter of the <code>motd</code> module, which requires changing the <code>override</code> option from <code>false</code> to <code>true</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">{
	"avoid_duplicates": false,
		<strong>"created_at": "2017-02-06 12:37:48 UTC",</strong> # Remove this line.
			<strong>"default_value": "",</strong> # Add a new value here.
			"description": "",
		"hidden_value": "",
		"hidden_value?": false,
		"id": 3,
		"merge_default": false,
		"merge_overrides": false,
		<strong>"override": false,</strong> # Set the override value to <code>true</code>.
			"override_value_order": "fqdn\nhostgroup\nos\ndomain",
		<strong>"override_values": [],</strong> # Remove this line.
			"override_values_count": 0,
		"parameter": "content",
		"parameter_type": "string",
		"puppetclass_id": 3,
		"puppetclass_name": "motd",
		"required": false,
		<strong>"updated_at": "2017-02-07 11:56:55 UTC",</strong> # Remove this line.
			"use_puppet_default": false,
		"validator_rule": null,
		"validator_type": ""
}</pre>
</div>
</div>
</li>
<li>
<p>After editing the file, verify that it looks as follows and then save the changes:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">{
	"avoid_duplicates": false,
		<strong>"default_value": "<em>No Unauthorized Access Allowed</em>",</strong>
			"description": "",
		"hidden_value": "",
		"hidden_value?": false,
		"id": 3,
		"merge_default": false,
		"merge_overrides": false,
		<strong>"override": true,</strong>
			"override_value_order": "fqdn\nhostgroup\nos\ndomain",
		"override_values_count": 0,
		"parameter": "content",
		"parameter_type": "string",
		"puppetclass_id": 3,
		"puppetclass_name": "motd",
		"required": false,
		"use_puppet_default": false,
		"validator_rule": null,
		"validator_type": ""
}</pre>
</div>
</div>
</li>
<li>
<p>Submit the file to Foreman:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --header "Accept:application/json" \
--header "Content-Type:application/json" \
--request PUT --user <em>My_User_Name</em>:<em>My_Password</em> \
--data @changed_file.json \
https://<em>foreman.example.com</em>/api/smart_class_parameters/3</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="deleting-openscap-reports"><a class="anchor" href="#deleting-openscap-reports"></a>6.9. Deleting OpenSCAP reports</h3>
<div class="paragraph">
<p>In Foreman&#160;server, you can delete one or more OpenSCAP reports.
However, when you delete reports, you must delete one page at a time.
If you want to delete all OpenSCAP reports, use the bash script that follows.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>List all OpenSCAP reports.
Note the IDs of the reports that you want to delete.</p>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --user <em>My_User_Name</em>:<em>My_Password</em> \
https://<em>foreman.example.com</em>/api/v2/compliance/arf_reports/ | python3 -m json.tool</pre>
</div>
</div>
<div class="paragraph">
<p>Example response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  3252    0  3252    0     0   4319      0 --:--:-- --:--:-- --:--:--  4318
{
    "page": 1,
    "per_page": 20,
    "results": [
        {
            "created_at": "2017-05-16 13:27:09 UTC",
            "failed": 0,
            "host": "<em>host1.example.com</em>",
            "id": 404,
            "othered": 0,
            "passed": 0,
            "updated_at": "2017-05-16 13:27:09 UTC"
        },
        {
            "created_at": "2017-05-16 13:26:07 UTC",
            "failed": 0,
            "host": "<em>host2.example.com</em>,
            "id": 405,
            "othered": 0,
            "passed": 0,
            "updated_at": "2017-05-16 13:26:07 UTC"
        },
        {
            "created_at": "2017-05-16 13:25:07 UTC",
            "failed": 0,
            "host": "<em>host3.example.com</em>",
            "id": 406,
            "othered": 0,
            "passed": 0,
            "updated_at": "2017-05-16 13:25:07 UTC"
        },
        {
            "created_at": "2017-05-16 13:24:07 UTC",
            "failed": 0,
            "host": "<em>host4.example.com</em>",
            "id": 407,
            "othered": 0,
            "passed": 0,
            "updated_at": "2017-05-16 13:24:07 UTC"
        },
    ],
    "search": null,
    "sort": {
        "by": null,
        "order": null
    },
    "subtotal": 29,
    "total": 29</pre>
</div>
</div>
</li>
<li>
<p>Using an ID from the previous step, delete the OpenSCAP report.
Repeat for each ID that you want to delete.</p>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --user <em>My_User_Name</em>:<em>My_Password</em> \
--header "Content-Type: application/json" \
--request DELETE https://<em>foreman.example.com</em>/api/v2/compliance/arf_reports/405</pre>
</div>
</div>
<div class="paragraph">
<p>Example response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">HTTP/1.1 200 OK
Date: Thu, 18 May 2017 07:14:36 GMT
Server: Apache/2.4.6 (Enterprise Linux)
X-Frame-Options: SAMEORIGIN
X-XSS-Protection: 1; mode=block
X-Content-Type-Options: nosniff
Foreman_version: 1.11.0.76
Foreman_api_version: 2
Apipie-Checksum: 2d39dc59aed19120d2359f7515e10d76
Cache-Control: max-age=0, private, must-revalidate
X-Request-Id: f47eb877-35c7-41fe-b866-34274b56c506
X-Runtime: 0.661831
X-Powered-By: Phusion Passenger 4.0.18
Set-Cookie: request_method=DELETE; path=/
Set-Cookie: _session_id=d58fe2649e6788b87f46eabf8a461edd; path=/; secure; HttpOnly
ETag: "2574955fc0afc47cb5394ce95553f428"
Status: 200 OK
Vary: Accept-Encoding
Transfer-Encoding: chunked
Content-Type: application/json; charset=utf-8</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Example BASH script to delete all OpenSCAP reports</div>
<p>Use the following bash script to delete all the OpenSCAP reports:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-Bash" data-lang="Bash">#!/bin/bash

#this script removes all the ARF reports from your Foreman&#160;server

#settings
USER=<em>username</em>
PASS=<em>password</em>
URI=https://<em>foreman.example.com</em>

#check amount of reports
 while [ $(curl --user $USER:$PASS $URI/api/v2/compliance/arf_reports/ | python3 -m json.tool | grep \"\total\": | cut --fields=2 --delimiter":" | cut --fields=1 --delimiter"," | sed "s/ //g") -gt 0 ]; do

#fetch reports
 for i in $(curl --user $USER:$PASS $URI/api/v2/compliance/arf_reports/ | python3 -m json.tool | grep \"\id\": | cut --fields=2 --delimiter":" | cut --fields=1 --delimiter"," | sed "s/ //g")

#delete reports
  do
  curl --user $USER:$PASS --header "Content-Type: application/json" --request DELETE $URI/api/v2/compliance/arf_reports/$i
  done
done</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="api-response_codes"><a class="anchor" href="#api-response_codes"></a>Appendix A: API response codes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Foreman API provides HTTP response status codes for API calls.
The following codes are common for all resources in the Foreman API.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. API response codes</caption>
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 71.4286%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response</th>
<th class="tableblock halign-left valign-top">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200 OK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For a successful request action: show, index, update, or delete (GET, PUT, DELETE requests).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">201 Created</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For a successful create action (POST request).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">301 Moved Permanently</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redirect when Foreman is restricted to use HTTPS and HTTP is attempted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400 Bad Request</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A required parameter is missing or the search query has invalid syntax.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">401 Unauthorized</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Failed to authorize the user, for example, due to incorrect credentials.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">403 Forbidden</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The user has insufficient permissions to perform the action or read the resource, or the action is unsupported in general.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404 Not Found</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The record with the given ID does not exist.
It can appear in show and delete actions when the requested record does not exist; or in create, update and delete actions when one of the associated records does not exist.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">409 Conflict</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Could not delete the record due to existing dependencies, for example, host groups that still contain hosts.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">415 Unsupported Media Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The content type of the HTTP request is not JSON.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">422 Unprocessable Entity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Failed to create an entity due to some validation errors.
Applies to create or update actions only.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 Internal Server Error</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unexpected internal server error.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">503 Service Unavailable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The server is not running.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="Creating_a_Complete_Permission_Table_rest-api"><a class="anchor" href="#Creating_a_Complete_Permission_Table_rest-api"></a>Appendix B: Creating a complete permission table</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use the Foreman CLI to create a permission table.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Ensure that the <code>foreman-console</code> package is installed on Foreman&#160;server:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># dnf install foreman-console</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Start the Foreman console with the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-rake console</pre>
</div>
</div>
</li>
<li>
<p>Insert the following code into the console:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">f = File.open('/tmp/table.html', 'w')

result = Foreman::AccessControl.permissions {|a,b| a.security_block &lt;=&gt; b.security_block}.collect do |p|
      actions = p.actions.collect { |a| "&lt;li&gt;#{a}&lt;/li&gt;" }
      "&lt;tr&gt;&lt;td&gt;#{p.name}&lt;/td&gt;&lt;td&gt;&lt;ul&gt;#{actions.join('')}&lt;/ul&gt;&lt;/td&gt;&lt;td&gt;#{p.resource_type}&lt;/td&gt;&lt;/tr&gt;"
end.join("\n")

f.write(result)</pre>
</div>
</div>
<div class="paragraph">
<p>The above syntax creates a table of permissions and saves it to the <code>/tmp/table.html</code> file.</p>
</div>
</li>
<li>
<p>Press <code><strong>Ctrl</strong></code> + <code><strong>D</strong></code> to exit the Foreman console.</p>
</li>
<li>
<p>Insert the following text at the first line of <code>/tmp/table.html</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">&lt;table border="1"&gt;&lt;tr&gt;&lt;td&gt;Permission name&lt;/td&gt;&lt;td&gt;Actions&lt;/td&gt;&lt;td&gt;Resource type&lt;/td&gt;&lt;/tr&gt;</pre>
</div>
</div>
</li>
<li>
<p>Append the following text at the end of <code>/tmp/table.html</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">&lt;/table&gt;</pre>
</div>
</div>
</li>
<li>
<p>Open <code>/tmp/table.html</code> in a web browser to view the table.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 3.12<br>
Last updated Oct 2024
</div>
</div>
</body>
</html>