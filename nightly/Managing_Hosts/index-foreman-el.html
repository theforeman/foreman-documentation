<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.26">
<title>Managing hosts</title>
<style>
﻿*,::before,::after{box-sizing:border-box}html{font-size:100%;-webkit-text-size-adjust:100%}body{background:#fff;color:rgba(0,0,0,0.8);padding:0;margin:0;font-family:"Noto Serif", "DejaVu Serif", serif;font-size:inherit;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,pre,p,blockquote,th,td{margin:0;padding:0}a{background:none;color:#2156a5;text-decoration:underline;line-height:inherit}a:active,a:hover{cursor:pointer;outline:0}a:focus{outline:thin dotted}a:hover,a:focus{color:#1d4b8f}abbr{font-size:0.9em}abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}b,strong{font-weight:bold;line-height:inherit}strong strong{font-weight:400}code,kbd,pre{font-family:"Droid Sans Mono", "DejaVu Sans Mono", monospace;font-size:1em}code{font-weight:400;color:rgba(0,0,0,0.9)}pre{color:rgba(0,0,0,0.9);line-height:1.45;text-rendering:optimizeSpeed;white-space:pre-wrap}dfn{font-style:italic}em,i{font-style:italic;line-height:inherit}em em{font-style:normal}hr{border:solid #dddddf;border-width:1px 0 0;clear:both;height:0;margin:1.25em 0 1.1875em}mark{background:#ff0;color:#000}p{line-height:1.6;margin-bottom:1.25rem;text-rendering:optimizeLegibility}q{quotes:"“" "”" "‘" "’"}small{font-size:60%;line-height:inherit}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-0.5em}sub{bottom:-0.25em}img,object[type^="image/"],svg{display:inline-block;height:auto;max-width:100%;vertical-align:middle}img{border:0;-ms-interpolation-mode:bicubic}object{max-width:100%}svg:not(:root){overflow:hidden}figure{margin:0}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}.left{float:left !important}.right{float:right !important}.text-left{text-align:left !important}.text-right{text-align:right !important}.text-center{text-align:center !important}.text-justify{text-align:justify !important}.hide{display:none}.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:0.25em}p aside{font-size:.875em;line-height:1.35;font-style:italic}h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans", "DejaVu Sans", sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.2;word-spacing:-0.05em}h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{color:#e99b8f;line-height:0}h1{font-size:2.125em}h2{font-size:1.6875em}h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}h4,h5{font-size:1.125em}h6{font-size:1em}ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}ul,ol{margin-left:1.5em}ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}ul.square{list-style-type:square}ul.circle{list-style-type:circle}ul.disc{list-style-type:disc}ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}dl dt{margin-bottom:.3125em;font-weight:bold}dl dd{margin-bottom:1.25em;margin-left:1.125em}blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,0.85)}@media screen and (min-width: 768px){h1{font-size:2.75em}h2{font-size:2.3125em}h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}h4{font-size:1.4375em}}table{background:#fff;border:1px solid #dedede;border-collapse:collapse;border-spacing:0;margin-bottom:1.25em;word-wrap:normal}table thead,table tfoot{background:#f7f8f7}table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,0.8);text-align:left}table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,0.8)}table tr.even,table tr.alt{background:#f8f8f7}table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}.center{margin-left:auto;margin-right:auto}.stretch{width:100%}.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:"";display:table}.clearfix::after,.float-group::after{clear:both}:not(pre).nobreak{word-wrap:normal}:not(pre).nowrap{white-space:nowrap}:not(pre).pre-wrap{white-space:pre-wrap}:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal !important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}pre>code{display:block}pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}.keyseq{color:rgba(51,51,51,0.8)}kbd{display:inline-block;color:rgba(0,0,0,0.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,0.2),inset 0 0 0 0.1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}.keyseq kbd:first-child{margin-left:0}.keyseq kbd:last-child{margin-right:0}.menuseq,.menuref{color:#000}.menuseq b:not(.caret),.menuref{font-weight:inherit}.menuseq{word-spacing:-0.02em}.menuseq b.caret{font-size:1.25em;line-height:0.8}.menuseq i.caret{font-weight:bold;text-align:center;width:0.45em}b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}b.button::before{content:"[";padding:0 3px 0 2px}b.button::after{content:"]";padding:0 2px 0 3px}p a>code:hover{color:rgba(0,0,0,0.9)}body>div[id]{margin:0 auto;max-width:62.5em;position:relative;padding-left:.9375em;padding-right:0.9375em}body>div[id]::before,body>div[id]::after,#content #footnotes::before{content:"";display:table;clear:both}#content{margin-top:1.25em;margin-bottom:0.625em}#content::before{content:none}#header>h1:first-child{color:rgba(0,0,0,0.85);margin-top:2.25rem;margin-bottom:0}#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,0.6);display:flex;flex-flow:row wrap}#header .details span:first-child{margin-left:-0.125em}#header .details span.email a{color:rgba(0,0,0,0.85)}#header .details br{display:none}#header .details br+span::before{content:" – "}#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,0.85)}#header .details br+span#revremark::before{content:" | "}#header #revnumber{text-transform:capitalize}#header #revnumber::after{content:" "}#content>h1:first-child:not([class]){color:rgba(0,0,0,0.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}#toc{border-bottom:1px solid #e7e7e9;padding-bottom:0.5em}#toc>ul{margin-left:0.125em}#toc ul.sectlevel0>li>a{font-style:italic}#toc ul.sectlevel0 ul.sectlevel1{margin:0.5em 0}#toc ul{font-family:"Open Sans", "DejaVu Sans", sans-serif;list-style-type:none}#toc li{line-height:1.3334;margin-top:0.3334em}#toc a{text-decoration:none}#toc a:active{text-decoration:underline}#toctitle{color:#7a2518;font-size:1.2em}@media screen and (min-width: 768px){#toctitle{font-size:1.375em}body.toc2{padding-left:15em;padding-right:0}#toc.toc2{margin-top:0 !important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0 !important;border-bottom-width:0 !important;z-index:1000;padding:1.25em 1em;height:calc(100% - (70px + 2.5em));overflow:auto}#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}#toc.toc2>ul{font-size:.9em;margin-bottom:0}#toc.toc2 ul ul{margin-left:0;padding-left:1em}#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:0.5em}body.toc2.toc-right{padding-left:0;padding-right:15em}body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}@media screen and (min-width: 1280px){body.toc2{padding-left:20em;padding-right:0}#toc.toc2{width:20em}#toc.toc2 #toctitle{font-size:1.375em}#toc.toc2>ul{font-size:0.95em}#toc.toc2 ul ul{padding-left:1.25em}body.toc2.toc-right{padding-left:0;padding-right:20em}}#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}#content #toc>:first-child{margin-top:0}#content #toc>:last-child{margin-bottom:0}#footer{max-width:none;background:#025d8c;padding:1.25em;margin-left:2em}#footer-text{color:rgba(255,255,255,0.8);line-height:1.44}h1:before,h2:before,h3:before,h4:before,h5:before,h6:before,div.title:before{display:block;content:" ";height:90px;margin-top:-90px;visibility:hidden}.sect1{padding-bottom:0.625em}@media screen and (min-width: 768px){#content{margin-bottom:1.25em}.sect1{padding-bottom:1.25em}}.sect1:last-child{padding-bottom:0}.sect1+.sect1{border-top:1px solid #e7e7e9}#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none !important;visibility:hidden;text-align:center;font-weight:400}#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:0.1em}#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}details{margin-left:1.25rem}details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}details>summary::-webkit-details-marker{display:none}details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif", "DejaVu Serif", serif;font-size:1rem;font-style:italic}table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,0.85)}.admonitionblock>table{border-collapse:separate;border:1;background:none;width:100%}.admonitionblock>table td.icon{text-align:center;width:80px}.admonitionblock>table td.icon img{max-width:none}.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans", "DejaVu Sans", sans-serif;text-transform:uppercase}.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,0.6);word-wrap:anywhere}.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}.exampleblock>.content{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#fffef7;border-radius:4px;box-shadow:0 1px 4px #e0e0dc}.exampleblock>.content>:first-child{margin-top:0}.exampleblock>.content>:last-child{margin-bottom:0}.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}.sidebarblock>:first-child{margin-top:0}.sidebarblock>:last-child{margin-bottom:0}.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:0.8125em}@media screen and (min-width: 768px){.literalblock pre,.listingblock>.content>pre{font-size:0.90625em}}@media screen and (min-width: 1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,0.9)}.listingblock>.content{position:relative}.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:0.5}.listingblock:hover code[data-lang]::before{display:block}.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:0.5}.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}.listingblock pre.highlightjs{padding:0}.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}.listingblock pre.prettyprint{border-width:0}.prettyprint{background:#f7f7f8}pre.prettyprint .linenums{line-height:1.45;margin-left:2em}pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}pre.prettyprint li code[data-lang]::before{opacity:1}pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}table.linenotable td.code{padding-left:0.75em}table.linenotable td.linenos{width:0.01%}table.linenotable td.linenos,pre.pygments .linenos,pre.rouge .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}pre.pygments span.linenos,pre.rouge span.linenos{display:inline-block;margin-right:0.75em}.quoteblock{margin:0 1em 1.25em 1.5em;display:table}.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:0.75em}.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,0.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}.quoteblock blockquote{margin:0;padding:0;border:0}.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,0.1)}.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}.verseblock{margin:0 1em 1.25em}.verseblock pre{font-family:"Open Sans", "DejaVu Sans", sans-serif;font-size:1.15rem;color:rgba(0,0,0,0.85);font-weight:300;text-rendering:optimizeLegibility}.verseblock pre strong{font-weight:400}.verseblock .attribution{margin-top:1.25rem;margin-left:0.5ex}.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}.quoteblock .attribution br,.verseblock .attribution br{display:none}.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,0.6)}.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}.quoteblock.abstract{margin:0 1em 1.25em;display:block}.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:0.25em solid #dddddf}.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}p.tableblock:last-child{margin-bottom:0}td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}td.tableblock>.content>:last-child{margin-bottom:-1.25em}table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}table.grid-all>*>tr>*{border-width:1px}table.grid-cols>*>tr>*{border-width:0 1px}table.grid-rows>*>tr>*{border-width:1px 0}table.frame-all{border-width:1px}table.frame-ends{border-width:1px 0}table.frame-sides{border-width:0 1px}table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}th.halign-left,td.halign-left{text-align:left}th.halign-right,td.halign-right{text-align:right}th.halign-center,td.halign-center{text-align:center}th.valign-top,td.valign-top{vertical-align:top}th.valign-bottom,td.valign-bottom{vertical-align:bottom}th.valign-middle,td.valign-middle{vertical-align:middle}table thead th,table tfoot th{font-weight:bold}tbody tr th{background:#f7f8f7}tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,0.8);font-weight:bold}p.tableblock>code:only-child{background:none;padding:0}p.tableblock{font-size:1em}ol{margin-left:1.75em}ul li ol{margin-left:1.5em}dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:0.625em}ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:0.625em}ul.unstyled,ol.unstyled{margin-left:0}li>p:empty:only-child::before{content:"";display:inline-block}ul.checklist>li>p:first-child{margin-left:-1em}ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:0.125em}ul.checklist>li>p:first-child>input[type=checkbox]:first-child{font:inherit;margin:0 .25em 0 0;padding:0}ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 0.625em -1.25em}ul.inline>li{margin-left:1.25em}.unstyled dl dt{font-weight:400;font-style:normal}ol.arabic{list-style-type:decimal}ol.decimal{list-style-type:decimal-leading-zero}ol.loweralpha{list-style-type:lower-alpha}ol.upperalpha{list-style-type:upper-alpha}ol.lowerroman{list-style-type:lower-roman}ol.upperroman{list-style-type:upper-roman}ol.lowergreek{list-style-type:lower-greek}.hdlist>table,.colist>table{border:0;background:none}.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}td.hdlist1,td.hdlist2{vertical-align:top;padding:0 0.625em}td.hdlist1{font-weight:bold;padding-bottom:1.25em}td.hdlist2{word-wrap:anywhere}.literalblock+.colist,.listingblock+.colist{margin-top:-0.5em}.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}.colist td:not([class]):first-child img{max-width:none}.colist td:not([class]):last-child{padding:0.25em 0}.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}.imageblock.left{margin:0.25em 0.625em 1.25em 0}.imageblock.right{margin:0.25em 0 1.25em 0.625em}.imageblock>.title{margin-bottom:0}.imageblock.thumb,.imageblock.th{border-width:6px}.imageblock.thumb>.title,.imageblock.th>.title{padding:0 0.125em}.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}.image.left{margin-right:0.625em}.image.right{margin-left:0.625em}a.image{text-decoration:none;display:inline-block}a.image object{pointer-events:none}sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}sup.footnote a,sup.footnoteref a{text-decoration:none}sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:0.625em}#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:0.2em}#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}#footnotes .footnote:last-of-type{margin-bottom:0}#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:0.75em 0}div.page-break{display:none}div.unbreakable{page-break-inside:avoid}.big{font-size:larger}.small{font-size:smaller}.underline{text-decoration:underline}.overline{text-decoration:overline}.line-through{text-decoration:line-through}.aqua{color:#00bfbf}.aqua-background{background:#00fafa}.black{color:#000}.black-background{background:#000}.blue{color:#0000bf}.blue-background{background:#0000fa}.fuchsia{color:#bf00bf}.fuchsia-background{background:#fa00fa}.gray{color:#606060}.gray-background{background:#7d7d7d}.green{color:#006000}.green-background{background:#007d00}.lime{color:#00bf00}.lime-background{background:#00fa00}.maroon{color:#600000}.maroon-background{background:#7d0000}.navy{color:#000060}.navy-background{background:#00007d}.olive{color:#606000}.olive-background{background:#7d7d00}.purple{color:#600060}.purple-background{background:#7d007d}.red{color:#bf0000}.red-background{background:#fa0000}.silver{color:#909090}.silver-background{background:#bcbcbc}.teal{color:#006060}.teal-background{background:#007d7d}.white{color:#bfbfbf}.white-background{background:#fafafa}.yellow{color:#bfbf00}.yellow-background{background:#fafa00}span.icon>.fa{cursor:default}a span.icon>.fa{cursor:inherit}.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,0.5);cursor:default}.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,0.8);color:#111}.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}.conum[data-value]{display:inline-block;color:#fff !important;background:rgba(0,0,0,0.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans", "DejaVu Sans", sans-serif;font-style:normal;font-weight:bold}.conum[data-value] *{color:#fff !important}.conum[data-value]+b{display:none}.conum[data-value]::after{content:attr(data-value)}pre .conum[data-value]{position:relative;top:-0.125em}b.conum *{color:inherit !important}.conum:not([data-value]):empty{display:none}dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}h1,h2,p,td.content,span.alt,summary{letter-spacing:-0.01em}p strong,td.content strong,div.footnote strong{letter-spacing:-0.005em}p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}.print-only{display:none !important}@page{margin:1.25cm 0.75cm}@media print{*{box-shadow:none !important;text-shadow:none !important}html{font-size:80%}a{color:inherit !important;text-decoration:underline !important}a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none !important}a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:0.25em}abbr[title]{border-bottom:1px dotted}abbr[title]::after{content:" (" attr(title) ")"}pre,blockquote,tr,img,object,svg{page-break-inside:avoid}thead{display:table-header-group}p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}body>div[id]{max-width:none}#toc,.sidebarblock,.exampleblock>.content{background:none !important}#toc{border-bottom:1px solid #dddddf !important;padding-bottom:0 !important}body.book #header{text-align:center}body.book #header>h1:first-child{border:0 !important;margin:2.5em 0 1em}body.book #header .details{border:0 !important;display:block;padding:0 !important}body.book #header .details span:first-child{margin-left:0 !important}body.book #header .details br{display:block}body.book #header .details br+span::before{content:none !important}body.book #toc{border:0 !important;text-align:left !important;padding:0 !important;margin:0 !important}body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}.listingblock code[data-lang]::before{display:block}div.page-break{display:block;page-break-after:always}#footer{padding:0 0.9375em}.hide-on-print{display:none !important}.print-only{display:block !important}.hide-for-print{display:none !important}.show-for-print{display:inherit !important}}@media amzn-kf8, print{#header>h1:first-child{margin-top:1.25rem}.sect1{padding:0 !important}.sect1+.sect1{border:0}#footer{background:none}#footer-text{color:rgba(0,0,0,0.6);font-size:0.9em}}@media amzn-kf8{body>div[id]{padding:0}}body{padding:0;margin:0;margin-top:70px !important}.container{position:relative;z-index:1;padding-top:50px;min-height:100%}.container p{font-family:sans-serif;font-size:1.2em}nav{position:fixed;z-index:9999;left:0;right:0;top:0;height:70px;padding:0 1.5em;background-color:#025d8c;font-family:sans-serif;line-height:70px}nav .logo{width:50px;vertical-align:middle}nav .nav-menu{position:absolute;right:0.3em;top:0;padding:0;margin:0;list-style:none}nav .nav-item{display:inline-block}nav .nav-item>a{display:inline-block;padding:0 2.5em;line-height:70px;color:#fff;text-decoration:none}nav .dropdown{position:relative}nav .dropdown a::after{content:"";display:inline-block;margin-left:0.5em;vertical-align:middle;border-top:0.3em solid #fff;border-right:0.3em solid transparent;border-left:0.3em solid transparent}nav .dropdown.show a::after{transform:rotate(180deg)}nav .dropdown-menu{display:none;position:absolute;left:0;right:0;top:100%;padding:0.5em 0;margin-top:-0.5em;border:1px solid rgba(0,0,0,0.3);border-radius:0.5em;background-color:#fff;width:max-content;max-height:80vh;overflow:scroll}nav .dropdown-menu-left{left:auto;right:0}nav .dropdown.show .dropdown-menu{display:block}nav .dropdown-div{display:block;padding:0.4em 0;line-height:4em}nav .dropdown-div a::after{content:none;margin-left:0;border-top:0;border-right:0;border-left:0}nav .dropdown-item{display:block;padding:0 1.5em;font-size:0.875em;color:#000;line-height:1.6em;text-decoration:none}nav .btn-hamburger{display:none;position:absolute;right:1.5em;top:50%;background-color:transparent;border:0;cursor:pointer;outline:none;transform:translateY(-50%)}nav .btn-hamburger span{display:block;width:30px;height:4px;background-color:#fff;margin:6px;border-radius:2px;transition:0.3s ease-in-out}nav .btn-hamburger span:nth-child(4),nav .btn-hamburger span:nth-child(5){position:absolute;top:10px;opacity:0.5}nav .btn-hamburger span:nth-child(4){transform:rotate(45deg) scale(0)}nav .btn-hamburger span:nth-child(5){transform:rotate(-45deg) scale(0)}nav.opened .btn-hamburger span:nth-child(4){opacity:1;transform:rotate(45deg) scale(1)}nav.opened .btn-hamburger span:nth-child(5){opacity:1;transform:rotate(-45deg) scale(1)}nav.opened .btn-hamburger span:nth-child(1),nav.opened .btn-hamburger span:nth-child(2),nav.opened .btn-hamburger span:nth-child(3){opacity:0}@media screen and (max-width: 768px){nav .nav-menu{position:fixed;left:0;right:0;top:70px;bottom:100%;display:flex;flex-direction:column;justify-content:start;background-color:#363d4e;transition:bottom 0.5s ease-in-out;overflow:hidden}nav.opened .nav-menu{bottom:0}nav .nav-item>a{display:block}nav .dropdown-menu{position:relative;top:0;margin:0 1.5em}nav .btn-hamburger{display:block}}/*!
* "Fork me on GitHub" CSS ribbon v0.2.3 | MIT License
* https://github.com/simonwhitaker/github-fork-ribbon-css

The MIT License (MIT)

Copyright (c) 2013 Simon Whitaker

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
*/.github-fork-ribbon,.release-ribbon,.issue-ribbon{width:12.1em;height:12.1em;position:absolute;overflow:hidden;top:70px;right:0;z-index:9998;pointer-events:none;font-size:13px;text-decoration:none;text-indent:-999999px}.github-fork-ribbon.fixed,.fixed.release-ribbon,.fixed.issue-ribbon{position:fixed}.github-fork-ribbon:hover,.release-ribbon:hover,.issue-ribbon:hover,.github-fork-ribbon:active,.release-ribbon:active,.issue-ribbon:active{background-color:transparent}.github-fork-ribbon:before,.release-ribbon:before,.issue-ribbon:before,.github-fork-ribbon:after,.release-ribbon:after,.issue-ribbon:after{position:absolute;display:block;width:15.38em;height:1.54em;top:3.23em;right:-3.23em;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;-webkit-transform:rotate(45deg);-moz-transform:rotate(45deg);-ms-transform:rotate(45deg);-o-transform:rotate(45deg);transform:rotate(45deg)}.github-fork-ribbon:before,.release-ribbon:before,.issue-ribbon:before{content:"";padding:.38em 0;background-color:#a00;background-image:-webkit-gradient(linear, left top, left bottom, from(transparent), to(rgba(0,0,0,0.15)));background-image:-webkit-linear-gradient(top, transparent, rgba(0,0,0,0.15));background-image:-moz-linear-gradient(top, transparent, rgba(0,0,0,0.15));background-image:-ms-linear-gradient(top, transparent, rgba(0,0,0,0.15));background-image:-o-linear-gradient(top, transparent, rgba(0,0,0,0.15));background-image:linear-gradient(to bottom, transparent, rgba(0,0,0,0.15));-webkit-box-shadow:0 0.15em 0.23em 0 rgba(0,0,0,0.5);-moz-box-shadow:0 0.15em 0.23em 0 rgba(0,0,0,0.5);box-shadow:0 0.15em 0.23em 0 rgba(0,0,0,0.5);pointer-events:auto}.github-fork-ribbon:after,.release-ribbon:after,.issue-ribbon:after{content:attr(data-ribbon);color:#fff;font:700 1em "Helvetica Neue", Helvetica, Arial, sans-serif;line-height:1.54em;text-decoration:none;text-shadow:0 -0.08em rgba(0,0,0,0.5);text-align:center;text-indent:0;padding:.15em 0;margin:.15em 0;border-width:.08em 0;border-style:dotted;border-color:#fff;border-color:rgba(255,255,255,0.7)}.github-fork-ribbon.left-top,.left-top.release-ribbon,.left-top.issue-ribbon,.github-fork-ribbon.left-bottom,.left-bottom.release-ribbon,.left-bottom.issue-ribbon{right:auto;left:0}.github-fork-ribbon.left-bottom,.left-bottom.release-ribbon,.left-bottom.issue-ribbon,.github-fork-ribbon.right-bottom,.right-bottom.release-ribbon,.right-bottom.issue-ribbon{top:auto;bottom:0}.github-fork-ribbon.left-top:before,.left-top.release-ribbon:before,.left-top.issue-ribbon:before,.github-fork-ribbon.left-top:after,.left-top.release-ribbon:after,.left-top.issue-ribbon:after,.github-fork-ribbon.left-bottom:before,.left-bottom.release-ribbon:before,.left-bottom.issue-ribbon:before,.github-fork-ribbon.left-bottom:after,.left-bottom.release-ribbon:after,.left-bottom.issue-ribbon:after{right:auto;left:-3.23em}.github-fork-ribbon.left-bottom:before,.left-bottom.release-ribbon:before,.left-bottom.issue-ribbon:before,.github-fork-ribbon.left-bottom:after,.left-bottom.release-ribbon:after,.left-bottom.issue-ribbon:after,.github-fork-ribbon.right-bottom:before,.right-bottom.release-ribbon:before,.right-bottom.issue-ribbon:before,.github-fork-ribbon.right-bottom:after,.right-bottom.release-ribbon:after,.right-bottom.issue-ribbon:after{top:auto;bottom:3.23em}.github-fork-ribbon.left-top:before,.left-top.release-ribbon:before,.left-top.issue-ribbon:before,.github-fork-ribbon.left-top:after,.left-top.release-ribbon:after,.left-top.issue-ribbon:after,.github-fork-ribbon.right-bottom:before,.right-bottom.release-ribbon:before,.right-bottom.issue-ribbon:before,.github-fork-ribbon.right-bottom:after,.right-bottom.release-ribbon:after,.right-bottom.issue-ribbon:after{-webkit-transform:rotate(-45deg);-moz-transform:rotate(-45deg);-ms-transform:rotate(-45deg);-o-transform:rotate(-45deg);transform:rotate(-45deg)}.release-ribbon:before{background-color:#a00}.issue-ribbon:before{background-color:#025d8c}@media screen{div.narrow{max-width:1080px;margin:0 auto !important;margin-top:70px auto !important;float:none !important}#toc.toc2{margin-top:70px !important}}._abstract{border-left:4px solid #025d8c;border-radius:4px;padding-left:1.25em}

</style>
<!-- Generate a nice TOC -->
<script src="/js/jquery-1.11.3.min.js"></script>
<script src="/js/jquery-ui.min.js"></script>
<script src="/js/jquery.tocify.min.js"></script>
<!-- We do not need the tocify CSS because the asciidoc CSS already provides most of what we need -->

<style>
.tocify-header {
    /* font-style: italic; */
}

.tocify-subheader {
    font-style: normal;
    font-size: 95%;
}

.tocify ul {
    margin: 0;
 }

.tocify-focus {
    /* background-color: rgba(0, 0, 0, 0.05);*/
}

.tocify-focus > a {
    color: #ba3925;
}
</style>

<script type="text/javascript">
    $(function () {
        // Add a new container for the tocify toc into the existing toc so we can re-use its
        // styling
        $("#toc").append("<div id='generated-toc'></div>");
        $("#generated-toc").tocify({
            extendPage: true,
            context: "#content",
            highlightOnScroll: true,
            hideEffect: "slideUp",
            // Use the IDs that asciidoc already provides so that TOC links and intra-document
            // links are the same. Anything else might confuse users when they create bookmarks.
            hashGenerator: function(text, element) {
                return $(element).attr("id");
            },
            // Smooth scrolling doesn't work properly if we use the asciidoc IDs
            smoothScroll: false,
            // Set to 'none' to use the tocify classes
            theme: "none",
            // Handle book (may contain h1) and article (only h2 deeper)
            selectors: $( "#content" ).has( "h1" ).size() > 0 ? "h1,h2,h3,h4,h5" : "h2,h3,h4,h5",
            ignoreSelector: ".discrete"
        });

        // Switch between static asciidoc toc and dynamic tocify toc based on browser size
        // This is set to match the media selectors in the asciidoc CSS
        // Without this, we keep the dynamic toc even if it is moved from the side to preamble
        // position which will cause odd scrolling behavior
        var handleTocOnResize = function() {
            if ($(document).width() < 768) {
                $("#generated-toc").hide();
                $(".sectlevel0").show();
                $(".sectlevel1").show();
            }
            else {
                $("#generated-toc").show();
                $(".sectlevel0").hide();
                $(".sectlevel1").hide();
            }
        }

        $(window).resize(handleTocOnResize);
        handleTocOnResize();
    });
</script>
<style>
/*! Asciidoctor Tabs | Copyright (c) 2018-present Dan Allen | MIT License */
.tabs {
  margin-bottom: 1.25em;
}

.tablist > ul {
  display: flex;
  flex-wrap: wrap;
  list-style: none;
  margin: 0;
  padding: 0;
}

.tablist > ul li {
  align-items: center;
  background-color: #fff;
  cursor: pointer;
  display: flex;
  font-weight: bold;
  line-height: 1.5;
  padding: 0.25em 1em;
  position: relative;
}

.tablist > ul li:focus-visible {
  outline: none;
}

.tablist.ulist,
.tablist.ulist > ul li {
  margin: 0;
}

.tablist.ulist > ul li + li {
  margin-left: 0.25em;
}

.tabs .tablist li::after {
  content: "";
  display: block;
  height: 1px;
  position: absolute;
  bottom: -1px;
  left: 0;
  right: 0;
}

.tabs.is-loading .tablist li:not(:first-child),
.tabs:not(.is-loading) .tablist li:not(.is-selected) {
  background-color: #f5f5f5;
}

.tabs.is-loading .tablist li:first-child::after,
.tabs:not(.is-loading) .tablist li.is-selected::after {
  background-color: #fff;
}

/*
.tabs:not(.is-loading) .tablist li,
.tabs:not(.is-loading) .tablist li::after {
  transition: background-color 200ms ease-in-out;
}
*/

.tablist > ul p {
  line-height: inherit;
  margin: 0;
}

.tabpanel {
  background-color: #fff;
  padding: 1.25em;
}

.tablist > ul li,
.tabpanel {
  border: 1px solid #dcdcdc;
}

.tablist > ul li {
  border-bottom: 0;
}

.tabs.is-loading .tabpanel + .tabpanel,
.tabs:not(.is-loading) .tabpanel.is-hidden {
  display: none;
}

.tabpanel > :first-child {
  margin-top: 0;
}

/* #content is a signature of the Asciidoctor standalone HTML output */
#content .tabpanel > :last-child,
#content .tabpanel > :last-child > :last-child,
#content .tabpanel > :last-child > :last-child > li:last-child > :last-child {
  margin-bottom: 0;
}

.tablecontainer {
  overflow-x: auto;
}

#content .tablecontainer {
  margin-bottom: 1.25em;
}

#content .tablecontainer > table.tableblock {
  margin-bottom: 0;
}
</style>
</head>
<body class="book toc2 toc-left">
    <div id="wrap">
      <script src="/js/versions.js"></script>
      <script src="/js/nav.js"></script>
      <script>
        document.open();
        document.write(buildNavigation());
        addNavbarListeners();
        document.close();
      </script>
    </div>
<div id="header">
<h1>Managing hosts</h1>
<div class="details">
<span id="revnumber">version Nightly,</span>
<span id="revdate">published Feb 2026</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#Administering_Hosts_managing-hosts">1. Administering hosts</a>
<ul class="sectlevel2">
<li><a href="#browsing-hosts-in-web-ui">1.1. Browsing hosts in Foreman web UI</a></li>
<li><a href="#Cloning_Hosts_managing-hosts">1.2. Cloning hosts</a></li>
<li><a href="#Associating_a_Virtual_Machine_from_a_Hypervisor_managing-hosts">1.3. Associating a virtual machine with Foreman from a hypervisor</a></li>
<li><a href="#Changing_the_Environment_of_a_Host_managing-hosts">1.4. Changing the environment of a host</a></li>
<li><a href="#Changing_the_Managed_Status_of_a_Host_managing-hosts">1.5. Changing the managed status of a host</a></li>
<li><a href="#Assigning_a_Host_to_a_Specific_Organization_managing-hosts">1.6. Assigning a host to a specific organization</a></li>
<li><a href="#Assigning_a_Host_to_a_Specific_Location_managing-hosts">1.7. Assigning a host to a specific location</a></li>
<li><a href="#selecting-host-columns_managing-hosts">1.8. Selecting host columns</a></li>
<li><a href="#removing-a-host-from-foreman-by-using-web-ui">1.9. Removing a host from Foreman by using Foreman web UI</a></li>
<li><a href="#removing-a-host-from-foreman-by-using-cli">1.10. Removing a host from Foreman by using Hammer CLI</a></li>
<li><a href="#Disassociating_a_Virtual_Machine_without_Removing_It_from_a_Hypervisor_managing-hosts">1.11. Disassociating a virtual machine from Foreman without removing it from a hypervisor</a></li>
<li><a href="#Installing_the_Snapshot_Management_plugin_managing-hosts">1.12. Installing the Snapshot Management plugin</a></li>
<li><a href="#Creating_Snapshots_of_a_Host_managing-hosts">1.13. Creating snapshots of a host</a></li>
</ul>
</li>
<li><a href="#Working_with_Host_Groups_managing-hosts">2. Working with host groups</a>
<ul class="sectlevel2">
<li><a href="#host-groups-overview_managing-hosts">2.1. Host groups overview</a></li>
<li><a href="#nested-host-groups_managing-hosts">2.2. Nested host groups</a></li>
<li><a href="#creating-a-host-group-by-using-web-ui">2.3. Creating a host group by using Foreman web UI</a></li>
<li><a href="#creating-a-host-group-by-using-cli">2.4. Creating a host group by using Hammer CLI</a></li>
<li><a href="#Creating_a_Host_Group_for_each_Lifecycle_Environment_managing-hosts">2.5. Creating a host group for each lifecycle environment</a></li>
<li><a href="#adding-a-host-to-a-host-group_managing-hosts">2.6. Adding a host to a host group</a></li>
<li><a href="#Changing_the_Host_Group_of_a_Host_managing-hosts">2.7. Changing the host group of a host</a></li>
</ul>
</li>
<li><a href="#registering-hosts-and-setting-up-host-integration_managing-hosts">3. Registering hosts and setting up host integration</a>
<ul class="sectlevel2">
<li><a href="#supported-clients-in-registration_managing-hosts">3.1. Supported clients in registration</a></li>
<li><a href="#Registering_Hosts_by_Using_Global_Registration_managing-hosts">3.2. Registering hosts by using global registration</a>
<ul class="sectlevel3">
<li><a href="#global-parameters-for-registration_managing-hosts">3.2.1. Global parameters for registration</a></li>
<li><a href="#Configuring_a_Host_for_Registration_managing-hosts">3.2.2. Configuring a host for registration</a></li>
<li><a href="#registering-a-host-by-using-web-ui">3.2.3. Registering a host by using Foreman web UI</a></li>
<li><a href="#registering-a-host-by-using-cli">3.2.4. Registering a host by using Hammer CLI</a></li>
<li><a href="#registering-a-host-by-using-api">3.2.5. Registering a host by using Foreman API</a></li>
<li><a href="#registering-a-host-by-using-ansible">3.2.6. Registering a host by using Ansible</a></li>
<li><a href="#running-custom-code-during-host-registration">3.2.7. Running custom code during host registration</a></li>
<li><a href="#Customizing_the_Registration_Templates_managing-hosts">3.2.8. Customizing the registration templates</a></li>
<li><a href="#invalidating-registration-tokens">3.2.9. Invalidating registration tokens</a></li>
</ul>
</li>
<li><a href="#installing-and-configuring-puppet-agent-during-host-registration_managing-hosts">3.3. Installing and configuring Puppet agent during host registration</a></li>
<li><a href="#Installing_and_Configuring_Puppet_Agent_Manually_managing-hosts">3.4. Installing and configuring Puppet agent manually</a></li>
<li><a href="#running-ansible-roles-during-host-registration">3.5. Running Ansible roles during host registration</a></li>
</ul>
</li>
<li><a href="#configuring-network-interfaces">4. Configuring network interfaces</a>
<ul class="sectlevel2">
<li><a href="#configuring-a-physical-interface">4.1. Configuring a physical interface</a></li>
<li><a href="#configuring-a-virtual-interface">4.2. Configuring a virtual interface</a></li>
<li><a href="#configuring-a-bonded-interface-by-using-web-ui">4.3. Configuring a bonded interface by using Foreman web UI</a></li>
<li><a href="#configuring-a-bonded-interface-by-using-cli">4.4. Configuring a bonded interface by using Hammer CLI</a></li>
<li><a href="#configuring-a-bridge-interface">4.5. Configuring a bridge interface</a></li>
<li><a href="#bonding-modes-available_managing-hosts">4.6. Bonding modes available in Foreman</a></li>
<li><a href="#configuring-a-baseboard-management-controller-interface">4.7. Configuring a baseboard management controller (BMC) interface</a></li>
<li><a href="#network-interface-configuration-options">4.8. Network interface configuration options</a></li>
</ul>
</li>
<li><a href="#Upgrading_Hosts_to_Next_Major_Release_managing-hosts">5. Upgrading hosts to next major Enterprise Linux release</a></li>
<li><a href="#host-management-and-monitoring-by-using-cockpit">6. Host management and monitoring by using Cockpit</a>
<ul class="sectlevel2">
<li><a href="#Enabling_Cockpit_on_Server_managing-hosts">6.1. Enabling Cockpit on Foreman</a></li>
<li><a href="#Managing_and_Monitoring_Hosts_Using_Cockpit_managing-hosts">6.2. Managing and monitoring hosts using Cockpit</a></li>
<li><a href="#disabling-cockpit-on-project_managing-hosts">6.3. Disabling Cockpit on Foreman</a></li>
</ul>
</li>
<li><a href="#connecting-ai-applications-to-the-mcp-server-for-foreman">7. Connecting AI applications to the MCP server for Foreman</a>
<ul class="sectlevel2">
<li><a href="#foreman-mcp-integration-overview">7.1. Foreman MCP integration overview</a></li>
<li><a href="#deploying-the-mcp-server-for-Foreman">7.2. Deploying the MCP server for Foreman</a></li>
<li><a href="#connecting-the-mcp-client-to-the-mcp-server">7.3. Connecting the MCP client to the MCP server</a></li>
<li><a href="#querying-the-mcp-server-for-foreman">7.4. Querying the MCP server for Foreman</a></li>
</ul>
</li>
<li><a href="#Using_Report_Templates_to_Monitor_Hosts_managing-hosts">8. Using report templates to monitor hosts</a>
<ul class="sectlevel2">
<li><a href="#generating-host-monitoring-reports-by-using-web-ui">8.1. Generating host monitoring reports by using Foreman web UI</a></li>
<li><a href="#generating-host-monitoring-reports-by-using-cli">8.2. Generating host monitoring reports by using Hammer CLI</a></li>
<li><a href="#Creating_a_Report_Template_managing-hosts">8.3. Creating a report template</a></li>
<li><a href="#exporting-report-templates-by-using-web-ui">8.4. Exporting report templates by using Foreman web UI</a></li>
<li><a href="#exporting-report-templates-by-using-cli">8.5. Exporting report templates by using Hammer CLI</a></li>
<li><a href="#Exporting_Report_Templates_Using_the_API_managing-hosts">8.6. Exporting report templates using the Foreman API</a></li>
<li><a href="#Importing_Report_Templates_managing-hosts">8.7. Importing report templates</a></li>
<li><a href="#Importing_Report_Templates_Using_the_API_managing-hosts">8.8. Importing report templates using the Foreman API</a></li>
<li><a href="#Report_Template_Safe_Mode_managing-hosts">8.9. Report template safe mode</a></li>
</ul>
</li>
<li><a href="#configuring-and-setting-up-remote-jobs">9. Configuring and setting up remote jobs</a>
<ul class="sectlevel2">
<li><a href="#Remote-Execution-in-Foreman_managing-hosts">9.1. Remote execution in Foreman</a></li>
<li><a href="#remote-execution-workflow_managing-hosts">9.2. Remote execution workflow</a></li>
<li><a href="#permissions-for-remote-execution_managing-hosts">9.3. Permissions for remote execution</a></li>
<li><a href="#transport-modes-for-remote-execution_managing-hosts">9.4. Transport modes for remote execution</a></li>
<li><a href="#installing-the-remote-execution-plugin">9.5. Installing the Remote Execution plugin</a></li>
<li><a href="#creating-a-job-template-by-using-web-ui">9.6. Creating a job template by using Foreman web UI</a></li>
<li><a href="#creating-a-job-template-by-using-cli">9.7. Creating a job template by using Hammer CLI</a></li>
<li><a href="#importing-an-ansible-playbook-by-name_managing-hosts">9.8. Importing an Ansible Playbook by name</a></li>
<li><a href="#importing-all-available-ansible-playbooks_managing-hosts">9.9. Importing all available Ansible Playbooks</a></li>
<li><a href="#configuring-the-fallback-to-any-smart-proxy-remote-execution-setting-by-using-web-ui">9.10. Configuring the fallback to any Smart&#160;Proxy remote execution setting by using Foreman web UI</a></li>
<li><a href="#configuring-the-fallback-to-any-smart-proxy-remote-execution-setting-by-using-cli">9.11. Configuring the fallback to any Smart&#160;Proxy remote execution setting by using Hammer CLI</a></li>
<li><a href="#configuring-the-global-smart-proxy-remote-execution-setting-by-using-web-ui">9.12. Configuring the global Smart&#160;Proxy remote execution setting by using Foreman web UI</a></li>
<li><a href="#configuring-the-global-smart-proxy-remote-execution-setting-by-using-cli">9.13. Configuring the global Smart&#160;Proxy remote execution setting by using Hammer CLI</a></li>
<li><a href="#setting-an-alternative-directory-for-remote-execution-jobs-in-push-mode_managing-hosts">9.14. Setting an alternative directory for remote execution jobs in push mode</a></li>
<li><a href="#setting-an-alternative-directory-for-remote-execution-jobs-in-pull-mode_managing-hosts">9.15. Setting an alternative directory for remote execution jobs in pull mode</a></li>
<li><a href="#altering-the-privilege-elevation-method_managing-hosts">9.16. Altering the privilege elevation method</a></li>
<li><a href="#Distributing_SSH_Keys_for_Remote_Execution_managing-hosts">9.17. Distributing SSH keys for remote execution</a></li>
<li><a href="#adding-foreman-server-ssh-key-to-authorized-keys">9.18. Adding Foreman&#160;server SSH key to authorized keys</a></li>
<li><a href="#distributing-ssh-keys-for-remote-execution-manually_managing-hosts">9.19. Distributing SSH keys for remote execution manually</a></li>
<li><a href="#adding-a-passphrase-to-ssh-key-used-for-remote-execution_managing-hosts">9.20. Adding a passphrase to SSH key used for remote execution</a></li>
<li><a href="#Using_the_foreman_API_to_Obtain_SSH_Keys_for_Remote_Execution_managing-hosts">9.21. Using the Foreman API to obtain SSH keys for remote execution</a></li>
<li><a href="#Configuring_a_AutoYaST_Template_to_Distribute_SSH_Keys_During_Provisioning_managing-hosts">9.22. Configuring a AutoYaST template to distribute SSH keys during provisioning</a></li>
<li><a href="#Configuring_a_Kickstart_Template_to_Distribute_SSH_Keys_During_Provisioning_managing-hosts">9.23. Configuring a Kickstart template to distribute SSH keys during provisioning</a></li>
<li><a href="#Configuring_a_Preseed_Template_to_Distribute_SSH_Keys_During_Provisioning_managing-hosts">9.24. Configuring a Preseed template to distribute SSH keys during provisioning</a></li>
<li><a href="#configuring-smart-proxy-and-hosts-to-authenticate-with-ssh-certificates-during-remote-execution">9.25. Configuring Smart&#160;Proxy and hosts to authenticate with SSH certificates during remote execution</a>
<ul class="sectlevel3">
<li><a href="#enabling-ssh-certificate-authentication-on-smart-proxy">9.25.1. Enabling SSH certificate authentication on Smart&#160;Proxy</a></li>
<li><a href="#disabling-ssh-certificate-authentication-on-smart-proxy">9.25.2. Disabling SSH certificate authentication on Smart&#160;Proxy</a></li>
<li><a href="#rotating-smart-proxy-ssh-certificate">9.25.3. Rotating Smart&#160;Proxy SSH certificate</a></li>
<li><a href="#configuring-registered-hosts-to-accept-ssh-certificate-from-smart-proxy">9.25.4. Configuring registered hosts to accept an SSH certificate from Smart&#160;Proxy</a></li>
<li><a href="#enabling-ssh-host-certificate-verification-on-smart-proxy">9.25.5. Enabling SSH host certificate verification on Smart&#160;Proxy</a></li>
<li><a href="#disabling-ssh-host-certificate-verification-on-smart-proxy">9.25.6. Disabling SSH host certificate verification on Smart&#160;Proxy</a></li>
</ul>
</li>
<li><a href="#configuring-a-keytab-for-kerberos-ticket-granting-tickets_managing-hosts">9.26. Configuring a keytab for Kerberos ticket granting tickets</a></li>
<li><a href="#configuring-kerberos-authentication-for-remote-execution_managing-hosts">9.27. Configuring Kerberos authentication for remote execution</a></li>
<li><a href="#customizing-job-templates">9.28. Customizing job templates</a></li>
<li><a href="#executing-a-remote-job-by-using-web-ui">9.29. Executing a remote job by using Foreman web UI</a></li>
<li><a href="#executing-a-remote-job-by-using-cli">9.30. Executing a remote job by using Hammer CLI</a></li>
<li><a href="#advanced-settings-in-the-job-wizard_managing-hosts">9.31. Advanced settings in the job wizard</a></li>
<li><a href="#using-extended-cron-lines_managing-hosts">9.32. Using extended cron lines</a></li>
<li><a href="#scheduling-a-recurring-ansible-job-for-a-host">9.33. Scheduling a recurring Ansible job for a host</a></li>
<li><a href="#scheduling-a-recurring-ansible-job-for-a-host-group">9.34. Scheduling a recurring Ansible job for a host group</a></li>
<li><a href="#setting-the-job-rate-limit-on-smart-proxy_managing-hosts">9.35. Setting the job rate limit on Smart&#160;Proxy</a></li>
</ul>
</li>
<li><a href="#Host_Status_managing-hosts">10. Host status in Foreman</a>
<ul class="sectlevel2">
<li><a href="#host-global-status-overview_managing-hosts">10.1. Host global status overview</a></li>
<li><a href="#host-substatus-overview_managing-hosts">10.2. Host sub-status overview</a></li>
</ul>
</li>
<li><a href="#troubleshooting-remote-jobs-timing-out-after-yggdrasil-update">Appendix A: Troubleshooting: Remote jobs timing out after <code>yggdrasil</code> update</a></li>
<li><a href="#Template_Writing_Reference_managing-hosts">Appendix B: Template writing reference</a>
<ul class="sectlevel2">
<li><a href="#Accessing_the_Template_Writing_Reference_managing-hosts">Accessing the template writing reference in the Foreman web UI</a></li>
<li><a href="#Using_Autocompletion_in_Templates_managing-hosts">Using autocompletion in templates</a></li>
<li><a href="#Writing_ERB_Templates_managing-hosts">Writing ERB templates</a></li>
<li><a href="#Troubleshooting_ERB_Templates_managing-hosts">Troubleshooting ERB templates</a></li>
<li><a href="#Generic_Project-specific_Macros_managing-hosts">Generic Foreman-specific macros</a></li>
<li><a href="#Template_Macros_managing-hosts">Template macros</a></li>
<li><a href="#Host_Specific_Variables_managing-hosts">Host-specific variables</a></li>
<li><a href="#Kickstart_Specific_Variables_managing-hosts">Kickstart-specific variables</a></li>
<li><a href="#Conditional_Statements_managing-hosts">Conditional statements</a></li>
<li><a href="#Parsing_Arrays_managing-hosts">Parsing arrays</a></li>
<li><a href="#Example_Template_Snippets_managing-hosts">Example template snippets</a></li>
</ul>
</li>
<li><a href="#Job_Template_Examples_and_Extensions_managing-hosts">Appendix C: Job template examples and extensions</a>
<ul class="sectlevel2">
<li><a href="#Customizing_Job_Templates_managing-hosts">Customizing job templates</a></li>
<li><a href="#creating-a-job-template-to-restore-selinux-context">Creating a job template to restore SELinux context</a></li>
<li><a href="#Rendering_a_restorecon_Template_managing-hosts">Rendering a restorecon template</a></li>
<li><a href="#Executing_a_restorecon_Template_on_Multiple_Hosts_managing-hosts">Executing a restorecon template on multiple hosts</a></li>
<li><a href="#Including_Power_Actions_in_Templates_managing-hosts">Including power actions in templates</a></li>
</ul>
</li>
<li><a href="#Host_Parameter_Hierarchy_managing-hosts">Appendix D: Host parameter hierarchy</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="Administering_Hosts_managing-hosts"><a class="anchor" href="#Administering_Hosts_managing-hosts"></a>1. Administering hosts</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>This chapter describes creating, registering, administering, and removing hosts.</p>
</div>
<div class="sect2">
<h3 id="browsing-hosts-in-web-ui"><a class="anchor" href="#browsing-hosts-in-web-ui"></a>1.1. Browsing hosts in Foreman web UI</h3>
<div class="paragraph _abstract">
<p>In the Foreman web UI, you can browse all hosts recognized by Foreman, grouped by type.</p>
</div>
<div class="paragraph">
<p>The following host types are available when browsing hosts in the Foreman web UI:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>All Hosts</strong> &#8211; a list of all hosts recognized by Foreman.</p>
</li>
<li>
<p><strong>Discovered Hosts</strong> &#8211; a list of bare-metal hosts detected on the provisioning network by the Discovery plugin.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To search for a host, type in the <strong>Search</strong> field, and use an asterisk (*) to perform a partial string search.
For example, if searching for a host named <code>server.example.com</code>, click the <strong>All Hosts</strong> page and type <code>server*</code> in the <strong>Search</strong> field.
Alternatively, <code>*ver*</code> will also find the host <code>server.example.com</code>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>Foreman&#160;server is listed as a host itself even if it is not self-registered.
Do not delete Foreman&#160;server from the list of hosts.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When you are on a particular host in the Foreman web UI, you can navigate between hosts without leaving the page by using the host switcher.
Click <strong>⇄</strong> next to the hostname.
This displays a list of hosts in alphabetical order with a pagination arrow and a search bar to find the host you are looking for.</p>
</div>
</div>
<div class="sect2">
<h3 id="Cloning_Hosts_managing-hosts"><a class="anchor" href="#Cloning_Hosts_managing-hosts"></a>1.2. Cloning hosts</h3>
<div class="paragraph _abstract">
<p>You can clone existing hosts.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Unlike cloning, creating a host is part of the host provisioning process.
There are multiple provisioning methods and each requires different configuration of Foreman and Smart&#160;Proxies.
For more information, see <a href="https://docs.theforeman.org/nightly/Provisioning_Hosts/index-foreman-el.html#"><em>Provisioning hosts</em></a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts &gt; All Hosts</strong>.</p>
</li>
<li>
<p>In the <strong>Actions</strong> menu, click <strong>Clone</strong>.</p>
</li>
<li>
<p>On the <strong>Host</strong> tab, ensure to provide a <strong>Name</strong> different from the original host.</p>
</li>
<li>
<p>On the <strong>Interfaces</strong> tab, ensure to provide a different IP address.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to clone the host.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Associating_a_Virtual_Machine_from_a_Hypervisor_managing-hosts"><a class="anchor" href="#Associating_a_Virtual_Machine_from_a_Hypervisor_managing-hosts"></a>1.3. Associating a virtual machine with Foreman from a hypervisor</h3>
<div class="paragraph _abstract">
<p>Associate virtual machines (VMs) on a hypervisor with Foreman to manage them from a central location.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Infrastructure</strong> &gt; <strong>Compute Resources</strong>.</p>
</li>
<li>
<p>Select a compute resource.</p>
</li>
<li>
<p>On the <strong>Virtual Machines</strong> tab, click <strong>Associate VMs</strong> to associate all VMs or select <strong>Associate VM</strong> from the <strong>Actions</strong> menu to associate a single VM.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Changing_the_Environment_of_a_Host_managing-hosts"><a class="anchor" href="#Changing_the_Environment_of_a_Host_managing-hosts"></a>1.4. Changing the environment of a host</h3>
<div class="paragraph _abstract">
<p>Use this procedure to change the environment of a host.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>All Hosts</strong>.</p>
</li>
<li>
<p>Click the name of the host you want to modify.</p>
</li>
<li>
<p>On the <strong>Content view environment</strong> card, click the options icon and select <strong>Edit content view environments</strong>.</p>
</li>
<li>
<p>Select the environment.</p>
</li>
<li>
<p>Select the content view.</p>
</li>
<li>
<p>Click <strong>Save</strong>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Changing_the_Managed_Status_of_a_Host_managing-hosts"><a class="anchor" href="#Changing_the_Managed_Status_of_a_Host_managing-hosts"></a>1.5. Changing the managed status of a host</h3>
<div class="paragraph _abstract">
<p>Hosts provisioned by Foreman are Managed by default.
When a host is set to Managed, you can configure additional host parameters from Foreman&#160;server.</p>
</div>
<div class="paragraph">
<p>Additional host parameters that you can configure for your hosts are listed on the <strong>Operating System</strong> tab.
If you change any settings on the <strong>Operating System</strong> tab, they will not take effect until you set the host to build and reboot it.</p>
</div>
<div class="paragraph">
<p>If you need to obtain reports about configuration management on systems using an operating system not supported by Foreman, set the host to Unmanaged.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>All Hosts</strong>.</p>
</li>
<li>
<p>Click the name of the host you want to modify.</p>
</li>
<li>
<p>Click <strong>Edit</strong>.</p>
</li>
<li>
<p>Click <strong>Manage host</strong> or <strong>Unmanage host</strong> to change the host&#8217;s status.</p>
</li>
<li>
<p>Click <strong>Submit</strong>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Assigning_a_Host_to_a_Specific_Organization_managing-hosts"><a class="anchor" href="#Assigning_a_Host_to_a_Specific_Organization_managing-hosts"></a>1.6. Assigning a host to a specific organization</h3>
<div class="paragraph _abstract">
<p>Use this procedure to assign a host to a specific organization.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If your host is already registered with a different organization, you must first unregister the host before assigning it to a new organization.
To unregister the host, run <code>subscription-manager unregister</code> on the host.
After you assign the host to a new organization, you can re-register the host.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Your user account has the <code>assign_organizations</code> permission.</p>
</li>
<li>
<p>You belong to the organization that you want to assign to the host.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>All Hosts</strong>.</p>
</li>
<li>
<p>Select the checkbox of the host you want to change.</p>
</li>
<li>
<p>From the <strong>Select Action</strong> list, select <strong>Assign Organization</strong>.
A new option window opens.</p>
</li>
<li>
<p>From the <strong>Select Organization</strong> list, select the organization that you want to assign your host to.
Select the checkbox <strong>Fix Organization on Mismatch</strong>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>A mismatch happens if there is a resource associated with a host, such as a domain or subnet, and at the same time not associated with the organization you want to assign the host to.
The option <strong>Fix Organization on Mismatch</strong> will add such a resource to the organization, and is therefore the recommended choice.
The option <strong>Fail on Mismatch</strong> will always result in an error message.
For example, reassigning a host from one organization to another will fail, even if there is no actual mismatch in settings.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Click <strong>Submit</strong>.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://docs.theforeman.org/nightly/Managing_Organizations_and_Locations/index-foreman-el.html#"><em>Managing organizations and locations in Foreman</em></a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Assigning_a_Host_to_a_Specific_Location_managing-hosts"><a class="anchor" href="#Assigning_a_Host_to_a_Specific_Location_managing-hosts"></a>1.7. Assigning a host to a specific location</h3>
<div class="paragraph _abstract">
<p>Use this procedure to assign a host to a specific location.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Your user account has the <code>assign_locations</code> permission.</p>
</li>
<li>
<p>You belong to the location that you want to assign to the host.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>All Hosts</strong>.</p>
</li>
<li>
<p>Select the checkbox of the host you want to change.</p>
</li>
<li>
<p>From the <strong>Select Action</strong> list, select <strong>Assign Location</strong>.
A new option window opens.</p>
</li>
<li>
<p>Navigate to the <strong>Select Location</strong> list and choose the location that you want for your host.
Select the checkbox <strong>Fix Location on Mismatch</strong>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>A mismatch happens if there is a resource associated with a host, such as a domain or subnet, and at the same time not associated with the location you want to assign the host to.
The option <strong>Fix Location on Mismatch</strong> will add such a resource to the location, and is therefore the recommended choice.
The option <strong>Fail on Mismatch</strong> will always result in an error message.
For example, reassigning a host from one location to another will fail, even if there is no actual mismatch in settings.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Click <strong>Submit</strong>.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://docs.theforeman.org/nightly/Managing_Organizations_and_Locations/index-foreman-el.html#"><em>Managing organizations and locations in Foreman</em></a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="selecting-host-columns_managing-hosts"><a class="anchor" href="#selecting-host-columns_managing-hosts"></a>1.8. Selecting host columns</h3>
<div class="paragraph _abstract">
<p>You can select what columns you want to see in the host table on the <strong>Hosts</strong> &gt; <strong>All Hosts</strong> page.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>It is not possible to deselect the <strong>Name</strong> column.
The <strong>Name</strong> column serves as a primary identification method of the host.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>All Hosts</strong>.</p>
</li>
<li>
<p>Click <strong>Manage columns</strong>.</p>
</li>
<li>
<p>Select columns that you want to display.
You can select individual columns or column categories.
Selecting or deselecting a category selects or deselects all columns in that category.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Some columns are included in more than one category, but you can display a column of a specific type only once.
By selecting or deselecting a specific column, you select or deselect all instances of that column.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Verification</div>
<ul>
<li>
<p>You can now see the selected columns in the host table.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="removing-a-host-from-foreman-by-using-web-ui"><a class="anchor" href="#removing-a-host-from-foreman-by-using-web-ui"></a>1.9. Removing a host from Foreman by using Foreman web UI</h3>
<div class="paragraph _abstract">
<p>Use this procedure to remove a host from Foreman from the Foreman web UI.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>By default, deleting a host entry associated with a virtual machine does not destroy the virtual machine on the compute resource.</p>
</div>
<div class="paragraph">
<p>To change the default behavior, navigate to <strong>Administer</strong> &gt; <strong>Settings</strong> &gt; <strong>Provisioning</strong> and set <strong>Destroy associated VM on host delete</strong> to <strong>Yes</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>All Hosts</strong>.</p>
</li>
<li>
<p>Select the hosts that you want to remove.</p>
</li>
<li>
<p>From the <strong>Select Action</strong> list, select <strong>Delete Hosts</strong>.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to remove the host from Foreman permanently.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="removing-a-host-from-foreman-by-using-cli"><a class="anchor" href="#removing-a-host-from-foreman-by-using-cli"></a>1.10. Removing a host from Foreman by using Hammer CLI</h3>
<div class="paragraph _abstract">
<p>Use this procedure to remove a host from Foreman by using Hammer CLI.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>By default, deleting a host entry associated with a virtual machine does not destroy the virtual machine on the compute resource.</p>
</div>
<div class="paragraph">
<p>To change the default behavior, navigate to <strong>Administer</strong> &gt; <strong>Settings</strong> &gt; <strong>Provisioning</strong> and set <strong>Destroy associated VM on host delete</strong> to <strong>Yes</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Delete your host from Foreman:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer host delete \
--id <em>My_Host_ID</em> \
--location-id <em>My_Location_ID</em> \
--organization-id <em>My_Organization_ID</em></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can use <code>--name <em>My_Host_Name</em></code> instead of <code>--id <em>My_Host_ID</em></code>.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Disassociating_a_Virtual_Machine_without_Removing_It_from_a_Hypervisor_managing-hosts"><a class="anchor" href="#Disassociating_a_Virtual_Machine_without_Removing_It_from_a_Hypervisor_managing-hosts"></a>1.11. Disassociating a virtual machine from Foreman without removing it from a hypervisor</h3>
<div class="paragraph _abstract">
<p>You can disassociate a virtual machine (VM) from Foreman if you no longer want to manage it.
This does not delete the VM from its hypervisor.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>All Hosts</strong>.</p>
</li>
<li>
<p>Select the checkbox to the left of the hosts that you want to disassociate.</p>
</li>
<li>
<p>From the <strong>Select Action</strong> list, click <strong>Disassociate Hosts</strong>.</p>
</li>
<li>
<p>Optional: Select the checkbox to keep the hosts for future action.</p>
</li>
<li>
<p>Click <strong>Submit</strong>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Installing_the_Snapshot_Management_plugin_managing-hosts"><a class="anchor" href="#Installing_the_Snapshot_Management_plugin_managing-hosts"></a>1.12. Installing the Snapshot Management plugin</h3>
<div class="paragraph _abstract">
<p>You can install the Snapshot Management plugin on your Foreman.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Install the Snapshot Management plugin on your Foreman&#160;server:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-installer --enable-foreman-plugin-snapshot-management</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Creating_Snapshots_of_a_Host_managing-hosts"><a class="anchor" href="#Creating_Snapshots_of_a_Host_managing-hosts"></a>1.13. Creating snapshots of a host</h3>
<div class="paragraph _abstract">
<p>You can use the Snapshot Management plugin to create snapshots of hosts.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
<div class="paragraph">
<p>Keeping more than three snapshots per host slows down the creation and rollback process.
Consider deleting older snapshots when creating new ones.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have installed the Snapshot Management plugin successfully.
For more information, see <a href="#Installing_the_Snapshot_Management_plugin_managing-hosts">Installing the Snapshot Management plugin</a>.</p>
</li>
<li>
<p>Your host is running on VMware vSphere or Proxmox.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>All Hosts</strong> and select a host.</p>
</li>
<li>
<p>In the <strong>Snapshots</strong> card, click <strong>Create Snapshot</strong>.</p>
</li>
<li>
<p>Enter a <strong>Name</strong>.</p>
</li>
<li>
<p>Optional: Enter a <strong>Description</strong>.</p>
</li>
<li>
<p>Optional: In the <strong>Snapshot Mode</strong> field, select <strong>Memory</strong> if you want to include the RAM in your snapshot or <strong>Quiesce</strong> if you want to ensure the full state of the VM is written to disk before creating the snapshot.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to create a snapshot.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Working_with_Host_Groups_managing-hosts"><a class="anchor" href="#Working_with_Host_Groups_managing-hosts"></a>2. Working with host groups</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>With Foreman, you can use host groups as a template for common host settings to apply these settings to multiple hosts.</p>
</div>
<div class="sect2">
<h3 id="host-groups-overview_managing-hosts"><a class="anchor" href="#host-groups-overview_managing-hosts"></a>2.1. Host groups overview</h3>
<div class="paragraph _abstract">
<p>A host group acts as a template for common host settings.</p>
</div>
<div class="paragraph">
<p>With host groups, you can define many settings for hosts, such as host parameters or operating system settings that are available to the hosts.
Instead of defining the settings individually for each host, you can use host groups to define common settings once and apply them to multiple hosts.</p>
</div>
<div class="paragraph">
<p>You can create nested host groups.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>When you change the settings of an existing host group, the new settings do not propagate to the hosts assigned to the host group.
Only Puppet class settings get updated on hosts after you change them in the host group.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="nested-host-groups_managing-hosts"><a class="anchor" href="#nested-host-groups_managing-hosts"></a>2.2. Nested host groups</h3>
<div class="paragraph _abstract">
<p>You can create a hierarchy of host groups.</p>
</div>
<div class="paragraph">
<p>Aim to have one base level host group that represents all hosts in your organization and provides general settings, and then nested groups that provide specific settings.</p>
</div>
<div class="paragraph">
<p>Foreman applies host settings in the following order when nesting host groups:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Host settings take priority over host group settings.</p>
</li>
<li>
<p>Nested host group settings take priority over parent host group settings.</p>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 1. Nested host group hierarchy</div>
<div class="content">
<div class="paragraph">
<p>You create a top-level host group named <strong>Base</strong> and two nested host groups named <strong>Webserver</strong> and <strong>Storage</strong>.
The nested host groups are associated with multiple hosts.
You also create host <code>custom.example.com</code> that is not associated with any host group.</p>
</div>
<div class="paragraph">
<p>You define the operating system on the top-level host group (<strong>Base</strong>) and Ansible roles on the nested host groups (<strong>Webservers</strong> and <strong>Storage</strong>).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Top-level host group</th>
<th class="tableblock halign-left valign-top">Nested host group</th>
<th class="tableblock halign-left valign-top">Hosts</th>
<th class="tableblock halign-left valign-top">Settings inherited from host groups</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" rowspan="4"><p class="tableblock"><strong>Base</strong></p>
<p class="tableblock">This host group applies the <code>Enterprise Linux&#160;9.5</code> operating system setting.</p></td>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock"><strong>Webservers</strong></p>
<p class="tableblock">This host group applies the <code>linux-system-roles.selinux</code> Ansible role.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>webserver1.example.com</strong></p></td>
<td class="tableblock halign-left valign-top" rowspan="2"><div class="content"><div class="paragraph">
<p>Hosts use the following settings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Enterprise Linux&#160;9.5</code> defined by host group <strong>Base</strong></p>
</li>
<li>
<p><code>linux-system-roles.selinux</code> defined by host group <strong>Webservers</strong></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>webserver2.example.com</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock"><strong>Storage</strong></p>
<p class="tableblock">This host group applies the <code>linux-system-roles.postfix</code> Ansible role.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>storage1.example.com</strong></p></td>
<td class="tableblock halign-left valign-top" rowspan="2"><div class="content"><div class="paragraph">
<p>Hosts use the following settings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Enterprise Linux&#160;9.5</code> defined by host group <strong>Base</strong></p>
</li>
<li>
<p><code>linux-system-roles.postfix</code> defined by host group <strong>Storage</strong></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>storage2.example.com</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">[No host group]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>custom.example.com</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No settings inherited from host groups.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 2. Nested host group settings</div>
<div class="content">
<div class="paragraph">
<p>You create a top-level host group named <strong>Base</strong> and two nested host groups named <strong>Webserver</strong> and <strong>Storage</strong>.
You also create host <code>custom.example.com</code> that is associated with the top-level host group <strong>Base</strong>, but no nested host group.</p>
</div>
<div class="paragraph">
<p>You define different values for the operating system and Ansible role settings on the top-level host group (<strong>Base</strong>) and nested host groups (<strong>Webserver</strong> and <strong>Storage</strong>).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Top-level host group</th>
<th class="tableblock halign-left valign-top">Nested host group</th>
<th class="tableblock halign-left valign-top">Host</th>
<th class="tableblock halign-left valign-top">Settings inherited from host groups</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" rowspan="5"><div class="content"><div class="paragraph">
<p><strong>Base</strong></p>
</div>
<div class="paragraph">
<p>This host group applies these settings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>Enterprise Linux&#160;9.5</code> operating system</p>
</li>
<li>
<p>The <code>linux-system-roles.selinux</code> Ansible role</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top" rowspan="2"><div class="content"><div class="paragraph">
<p><strong>Webservers</strong></p>
</div>
<div class="paragraph">
<p>This host group applies these settings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>Enterprise Linux&#160;9.6</code> operating system</p>
</li>
<li>
<p>No Ansible role</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>webserver1.example.com</strong></p></td>
<td class="tableblock halign-left valign-top" rowspan="2"><div class="content"><div class="paragraph">
<p>Hosts use the following settings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>Enterprise Linux&#160;9.6</code> operating system from host group <strong>Webservers</strong></p>
</li>
<li>
<p>The <code>linux-system-roles.selinux</code> Ansible role from host group <strong>Base</strong></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>webserver2.example.com</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><div class="content"><div class="paragraph">
<p><strong>Storage</strong></p>
</div>
<div class="paragraph">
<p>This host group applies these settings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>No operating system</p>
</li>
<li>
<p>The <code>linux-system-roles.postfix</code> Ansible role</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>storage1.example.com</strong></p></td>
<td class="tableblock halign-left valign-top" rowspan="2"><div class="content"><div class="paragraph">
<p>Hosts use the following settings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>Enterprise Linux&#160;9.5</code> operating system from host group <strong>Base</strong></p>
</li>
<li>
<p>The <code>linux-system-roles.postfix</code> Ansible role from host group <strong>Storage</strong></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>storage2.example.com</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">[No nested host group]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>custom.example.com</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Host uses the following settings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>Enterprise Linux&#160;9.5</code> operating system from host group <strong>Base</strong></p>
</li>
<li>
<p>The <code>linux-system-roles.selinux</code> Ansible role from host group <strong>Base</strong></p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="creating-a-host-group-by-using-web-ui"><a class="anchor" href="#creating-a-host-group-by-using-web-ui"></a>2.3. Creating a host group by using Foreman web UI</h3>
<div class="paragraph _abstract">
<p>Create a host group to be able to apply host settings to multiple hosts.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Configure</strong> &gt; <strong>Host Groups</strong> and click <strong>Create Host Group</strong>.</p>
</li>
<li>
<p>If you have an existing host group that you want to inherit attributes from, you can select a host group from the <strong>Parent</strong> list.
If you do not, leave this field blank.</p>
</li>
<li>
<p>Enter a <strong>Name</strong> for the new host group.</p>
</li>
<li>
<p>Enter any further information that you want future hosts to inherit.</p>
</li>
<li>
<p>Click the <strong>Ansible Roles</strong> tab, and from the <strong>Ansible Roles</strong> list, select one or more roles that you want to add to the host.
Use the <strong>arrow</strong> icon to manage the roles that you add or remove.</p>
</li>
<li>
<p>Click the additional tabs and add any details that you want to attribute to the host group.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Puppet fails to retrieve the Puppet CA certificate while registering a host with a host group associated with a Puppet environment created inside a <code>Production</code> environment.</p>
</div>
<div class="paragraph">
<p>To create a suitable Puppet environment to be associated with a host group, manually create a directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># mkdir /etc/puppetlabs/code/environments/<em>example_environment</em></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Click <strong>Submit</strong> to save the host group.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="creating-a-host-group-by-using-cli"><a class="anchor" href="#creating-a-host-group-by-using-cli"></a>2.4. Creating a host group by using Hammer CLI</h3>
<div class="paragraph _abstract">
<p>Create a host group to be able to apply host settings to multiple hosts.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Create a host group:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer hostgroup create \
--architecture "My_Architecture" \
--content-source-id <em>My_Content_Source_ID</em> \
--content-view "<em>My_Content_View</em>" \
--domain "<em>My_Domain</em>" \
--lifecycle-environment "<em>My_Lifecycle_Environment</em>" \
--locations "<em>My_Location</em>" \
--medium-id <em>My_Installation_Medium_ID</em> \
--name "<em>My_Host_Group</em>" \
--operatingsystem "<em>My_Operating_System</em>" \
--organizations "<em>My_Organization</em>" \
--partition-table "<em>My_Partition_Table</em>" \
--puppet-ca-proxy-id <em>My_Puppet_CA_Proxy_ID</em> \
--puppet-environment "<em>My_Puppet_Environment</em>" \
--puppet-proxy-id <em>My_Puppet_Proxy_ID</em> \
--root-pass "<em>My_Password</em>" \
--subnet "<em>My_Subnet</em>"</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Creating_a_Host_Group_for_each_Lifecycle_Environment_managing-hosts"><a class="anchor" href="#Creating_a_Host_Group_for_each_Lifecycle_Environment_managing-hosts"></a>2.5. Creating a host group for each lifecycle environment</h3>
<div class="paragraph _abstract">
<p>Use this procedure to create a host group for the Library lifecycle environment and add nested host groups for other lifecycle environments.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>To create a host group for each lifecycle environment, run the following Bash script:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-terminal" data-lang="terminal">MAJOR="<em>My_Major_Operating_System_Version</em>"
ARCH="<em>My_Architecture</em>"
ORG="<em>My_Organization</em>"
LOCATIONS="<em>My_Location</em>"
PTABLE_NAME="<em>My_Partition_Table</em>"
DOMAIN="<em>My_Domain</em>"

hammer --output csv --no-headers lifecycle-environment list --organization "${ORG}" | cut -d ',' -f 2 | while read LC_ENV; do
  [[ ${LC_ENV} == "Library" ]] &amp;&amp; continue

  hammer hostgroup create --name "rhel-${MAJOR}server-${ARCH}-${LC_ENV}" \
    --architecture "${ARCH}" \
    --partition-table "${PTABLE_NAME}" \
    --domain "${DOMAIN}" \
    --organizations "${ORG}" \
    --query-organization "${ORG}" \
    --locations "${LOCATIONS}" \
    --lifecycle-environment "${LC_ENV}"
done</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="adding-a-host-to-a-host-group_managing-hosts"><a class="anchor" href="#adding-a-host-to-a-host-group_managing-hosts"></a>2.6. Adding a host to a host group</h3>
<div class="paragraph _abstract">
<p>You can add a host to a host group in the Foreman web UI.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>All Hosts</strong>.</p>
</li>
<li>
<p>Click the name of the host you want to modify.</p>
</li>
<li>
<p>Click <strong>Edit</strong>.</p>
</li>
<li>
<p>Select the host group from the <strong>Host Group</strong> list.</p>
</li>
<li>
<p>Click <strong>Submit</strong>.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Verification</div>
<ul>
<li>
<p>The <strong>Details</strong> card under the <strong>Overview</strong> tab now shows the host group your host belongs to.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Changing_the_Host_Group_of_a_Host_managing-hosts"><a class="anchor" href="#Changing_the_Host_Group_of_a_Host_managing-hosts"></a>2.7. Changing the host group of a host</h3>
<div class="paragraph _abstract">
<p>Use this procedure to change the Host Group of a host.</p>
</div>
<div class="paragraph">
<p>If you reprovision a host after changing the host group, the fresh values that the host inherits from the host group will be applied.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>All Hosts</strong>.</p>
</li>
<li>
<p>Click the name of the host you want to modify.</p>
</li>
<li>
<p>Click <strong>Edit</strong>.</p>
</li>
<li>
<p>Select the new host group from the <strong>Host Group</strong> list.</p>
</li>
<li>
<p>Click <strong>Submit</strong>.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Verification</div>
<ul>
<li>
<p>The <strong>Details</strong> card under the <strong>Overview</strong> tab now shows the host group your host belongs to.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="registering-hosts-and-setting-up-host-integration_managing-hosts"><a class="anchor" href="#registering-hosts-and-setting-up-host-integration_managing-hosts"></a>3. Registering hosts and setting up host integration</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>You must register hosts that have not been provisioned through Foreman to be able to manage them with Foreman.
You can register hosts through Foreman&#160;server or Smart&#160;Proxy&#160;server.</p>
</div>
<div class="paragraph">
<p>You must also install and configure tools on your hosts, depending on which integration features you want to use.
Use the following procedures to install and configure host tools:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#installing-and-configuring-puppet-agent-during-host-registration_managing-hosts">Installing and configuring Puppet agent during host registration</a></p>
</li>
<li>
<p><a href="#Installing_and_Configuring_Puppet_Agent_Manually_managing-hosts">Installing and configuring Puppet agent manually</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="supported-clients-in-registration_managing-hosts"><a class="anchor" href="#supported-clients-in-registration_managing-hosts"></a>3.1. Supported clients in registration</h3>
<div class="paragraph _abstract">
<p>Foreman supports the following operating systems and architectures for registration.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The following combinations have been tested.
<a href="https://github.com/theforeman/foreman/blob/develop/app/views/unattended/provisioning_templates/registration/global_registration.erb"><strong>Global registration</strong></a> is a provisioning template for a shell script, which can be extended for additional systems.</p>
</div>
<div class="paragraph">
<p>If you decide to extend the template, please submit your changes to <a href="https://github.com/theforeman/foreman/#how-to-contribute">our repository</a>.
Thanks for your contribution!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported host operating systems</dt>
<dd>
<p>The hosts can use the following operating systems:</p>
<div class="ulist">
<ul>
<li>
<p>Amazon Linux</p>
</li>
<li>
<p>Debian</p>
</li>
<li>
<p>Enterprise Linux 10, 9, and 8</p>
</li>
<li>
<p>Fedora</p>
</li>
<li>
<p>OpenSUSE</p>
</li>
<li>
<p>SUSE Linux Enterprise Server</p>
</li>
<li>
<p>Ubuntu</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Supported host architectures</dt>
<dd>
<p>The hosts can use the following architectures:</p>
<div class="ulist">
<ul>
<li>
<p>AMD and Intel 64-bit architectures</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="Registering_Hosts_by_Using_Global_Registration_managing-hosts"><a class="anchor" href="#Registering_Hosts_by_Using_Global_Registration_managing-hosts"></a>3.2. Registering hosts by using global registration</h3>
<div class="paragraph _abstract">
<p>You can register a host to Foreman by generating a <code>curl</code> or <code>wget</code> command on Foreman and running this command on hosts.
This method uses two provisioning templates: <strong>Global Registration</strong> template and <strong>Linux host_init_config default</strong> template.
That gives you complete control over the host registration process.</p>
</div>
<div class="paragraph">
<p>You can also customize the default templates if you need greater flexibility.
For more information, see <a href="#Customizing_the_Registration_Templates_managing-hosts">Customizing the registration templates</a>.</p>
</div>
<div class="paragraph">
<p>If you use the Resource Quota plugin, registered hosts are automatically assigned to the <code>Unassigned</code> resource quota.
However, if you have the setting <code>Resource Quota optional assignment</code> set to <code>No</code> and no quotas to that a host can be assigned to, the host registration will fail because there is no valid quota the host can be assigned to.
For more information, see <a href="https://docs.theforeman.org/nightly/Administering_Project/index-foreman-el.html#limiting-host-resources">Limiting host resources</a> in <em>Administering Foreman</em>.</p>
</div>
<div class="paragraph">
<p>You can extend registration options by plugins.
For more information, see <a href="https://github.com/theforeman/foreman/blob/develop/developer_docs/how_to_create_a_plugin.asciidoc">How to Create a Plugin</a> and <a href="https://github.com/theforeman/foreman/blob/develop/developer_docs/slot-and-fill.asciidoc">Slot and Fill</a>.</p>
</div>
<div class="sect3">
<h4 id="global-parameters-for-registration_managing-hosts"><a class="anchor" href="#global-parameters-for-registration_managing-hosts"></a>3.2.1. Global parameters for registration</h4>
<div class="paragraph _abstract">
<p>You can configure the following global parameters for registration.</p>
</div>
<div class="paragraph">
<p>You can view the parameters in the Foreman web UI by navigating to <strong>Configure</strong> &gt; <strong>Global Parameters</strong>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>host_registration_insights</code> parameter is used in the <code>insights</code> snippet.
If the parameter is set to <code>true</code>, the registration installs and enables the Insights client on the host.
If the parameter is set to <code>false</code>, Foreman prevents the installation and registration of the Insights client.
The default value is <code>false</code>.
When overriding the parameter value, set the parameter type to <code>boolean</code>.</p>
</li>
<li>
<p>The <code>host_registration_insights_inventory</code> parameter controls Inventory uploads.
If the parameter is set to <code>true</code>, the host is included in the Insights Inventory report uploaded to the Red&#160;Hat Hybrid Cloud Console.
If the parameter is set to <code>false</code>, the host is excluded from the Insights Inventory report upload.
To upload inventory data without registering the host with the Insights client, set the <code>host_registration_insights</code> parameter to <code>false</code> and set the <code>host_registration_insights_inventory</code> to <code>true</code>.</p>
</li>
<li>
<p>The <code>host_packages</code> parameter is for installing packages on the host.</p>
</li>
<li>
<p>The <code>host_registration_remote_execution</code> parameter is used in the <code>remote_execution_ssh_keys</code> snippet.
If it is set to <code>true</code>, the registration enables remote execution on the host.
The default value is <code>true</code>.</p>
</li>
<li>
<p>The <code>remote_execution_ssh_keys</code>, <code>remote_execution_ssh_user</code>, <code>remote_execution_create_user</code>, and <code>remote_execution_effective_user_method</code> parameters are used in the <code>remote_execution_ssh_keys</code> snippet.
For more details, see the snippet.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can navigate to snippets in the Foreman web UI through <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Provisioning Templates</strong>.</p>
</div>
</div>
<div class="sect3">
<h4 id="Configuring_a_Host_for_Registration_managing-hosts"><a class="anchor" href="#Configuring_a_Host_for_Registration_managing-hosts"></a>3.2.2. Configuring a host for registration</h4>
<div class="paragraph _abstract">
<p>Configure your host for registration to Foreman&#160;server or Smart&#160;Proxy&#160;server.
You can use a configuration management tool to configure multiple hosts at once.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The host must be using a supported operating system.
For more information, see <a href="#supported-clients-in-registration_managing-hosts">Supported clients in registration</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Deploy the SSL CA file on your host so that the host can make a secured registration call.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Find where Foreman stores the SSL CA file by navigating to <strong>Administer</strong> &gt; <strong>Settings</strong> &gt; <strong>Authentication</strong> and locating the value of the <strong>SSL CA file</strong> setting.</p>
</li>
<li>
<p>Transfer the SSL CA file to your host securely, for example by using <code>scp</code>.</p>
</li>
<li>
<p>Login to your host by using SSH.</p>
</li>
<li>
<p>Copy the certificate to the truststore:</p>
<div class="ulist">
<ul>
<li>
<p>On Enterprise Linux:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># cp <em>My_SSL_CA_file</em>.pem /etc/pki/ca-trust/source/anchors</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Update the truststore:</p>
<div class="ulist">
<ul>
<li>
<p>On Enterprise Linux:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># update-ca-trust</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="registering-a-host-by-using-web-ui"><a class="anchor" href="#registering-a-host-by-using-web-ui"></a>3.2.3. Registering a host by using Foreman web UI</h4>
<div class="paragraph _abstract">
<p>You can register a host from the Foreman web UI with registration templates.
This also enables you to set up various integration features and host tools during the registration process.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Your Foreman account has the <strong>Register hosts</strong> role assigned or a role with equivalent permissions.</p>
</li>
<li>
<p>You must have root privileges on the host that you want to register.</p>
</li>
<li>
<p>You must have installed either <code>curl</code> or <code>wget</code> on the host that you want to register.</p>
</li>
<li>
<p>You have configured your host for registration.
For more information, see <a href="#Configuring_a_Host_for_Registration_managing-hosts">Configuring a host for registration</a>.</p>
</li>
<li>
<p>If you want to use Smart&#160;Proxy&#160;servers instead of your Foreman&#160;server, ensure that you have configured your Smart&#160;Proxy&#160;servers accordingly.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>It is essential to add your Smart&#160;Proxy&#160;server to the list of trusted proxies on Foreman&#160;server!</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>You have configured the operating system entry on Foreman for Enterprise Linux.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>Register Host</strong>.</p>
</li>
<li>
<p>Enter the details for how you want the registered host to be configured.</p>
<div class="ulist">
<ul>
<li>
<p>If you select a host group from the <strong>Host Group</strong> list, the following fields inherit their values from the host group:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Operating system</strong></p>
</li>
<li>
<p><strong>Lifecycle environment</strong></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Specify any other registration details that you require.
The available settings include the following:</p>
<div class="ulist">
<ul>
<li>
<p>On the <strong>General</strong> tab, in the <strong>Smart&#160;Proxy</strong> field, you can select the Smart&#160;Proxy to register your host through.
A Smart&#160;Proxy behind a load balancer takes precedence over a Smart&#160;Proxy selected in the Foreman web UI as the content source of the host.</p>
</li>
<li>
<p>On the <strong>General</strong> tab, in the <strong>Download utility</strong> field, you can select <code>wget</code> if you want to register your host by using a <code>wget</code> command.
By default, Foreman generates a <code>curl</code> command.</p>
</li>
<li>
<p>On the <strong>General</strong> tab, you can select the <strong>Insecure</strong> option to make the first call insecure.
During this first call, your host downloads the CA file from Foreman.
Your host will use this CA file to connect to Foreman with all future calls making them secure.</p>
<div class="paragraph">
<p>Foreman community recommends that you avoid insecure calls.</p>
</div>
<div class="paragraph">
<p>If an attacker, located in the network between Foreman and your host, fetches the CA file from the first insecure call, the attacker will be able to access the content of the API calls to and from your host and the JSON Web Tokens (JWT).
Therefore, if you have chosen to deploy SSH keys during registration, the attacker will be able to access your host using the SSH key.</p>
</div>
</li>
<li>
<p>On the <strong>Advanced</strong> tab, in the <strong>Repositories</strong> field, you can list repositories to be added before the registration is performed.
You do not have to specify repositories if you provide them in an activation key.</p>
</li>
<li>
<p>On the <strong>Advanced</strong> tab, you can configure remote execution, Insights, and packages to be installed.</p>
</li>
<li>
<p>On the <strong>Advanced</strong> tab, in the <strong>Token lifetime (hours)</strong> field, you can change the validity duration of the JSON Web Token (JWT) that Foreman uses for authentication.
The duration of this token defines how long the generated registration command works.</p>
<div class="paragraph">
<p>Note that Foreman applies the permissions of the user who generates the registration command to authorization of your host.
If the user loses or gains additional permissions, the permissions of the JWT change too.
Therefore, do not delete, block, or change permissions of the user during the token duration.</p>
</div>
<div class="paragraph">
<p>The scope of the JWTs is limited to the registration endpoints only and cannot be used anywhere else.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Foreman generates the registration command with parameters that search resources by ID.
You can edit the registration command to search the following resources by title:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Organization</dt>
<dd>
<p>URL fragment example: <code>organization=My%20Organization</code> or <code>organization=My+Organization</code></p>
</dd>
<dt class="hdlist1">Location</dt>
<dd>
<p>URL fragment example: <code>location=My%20Location</code> or <code>location=My+Location</code></p>
</dd>
<dt class="hdlist1">Host group</dt>
<dd>
<p>If a host group is nested, include the parent group separated with the slash character (<code>/</code>).</p>
<div class="paragraph">
<p>URL fragment example: <code>hostgroup=Parent%20Group%2FMy%20Host%20Group</code></p>
</div>
</dd>
<dt class="hdlist1">Operating system</dt>
<dd>
<p>URL fragment example: <code>operatingsystem=My%20Operating%20System</code> or <code>operatingsystem=My+Operating+System</code></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The parameter values must be URL encoded.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>Generate</strong> to generate a <code>curl</code> command.</p>
</li>
<li>
<p>Run the <code>curl</code> command as <code>root</code> on the host that you want to register.
After registration completes, any Ansible roles assigned to a host group you specified when configuring the registration template will run on the host.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Next steps</div>
<ul>
<li>
<p>To set up monitoring of outdated services and applications using Tracer, see <a href="https://docs.theforeman.org/nightly/Managing_Hosts/index-foreman-el.html#configuring-tracer-on-a-host_managing-hosts">Configuring Tracer on a host</a> in <em>Managing hosts</em>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="registering-a-host-by-using-cli"><a class="anchor" href="#registering-a-host-by-using-cli"></a>3.2.4. Registering a host by using Hammer CLI</h4>
<div class="paragraph _abstract">
<p>You can register a host by using Hammer CLI with registration templates.
This also enables you to set up various integration features and host tools during the registration process.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Your Foreman account has the <strong>Register hosts</strong> role assigned or a role with equivalent permissions.</p>
</li>
<li>
<p>You must have root privileges on the host that you want to register.</p>
</li>
<li>
<p>You must have installed either <code>curl</code> or <code>wget</code> on the host that you want to register.</p>
</li>
<li>
<p>You have configured your host for registration.
For more information, see <a href="#Configuring_a_Host_for_Registration_managing-hosts">Configuring a host for registration</a>.</p>
</li>
<li>
<p>If you want to use Smart&#160;Proxy&#160;servers instead of your Foreman&#160;server, ensure that you have configured your Smart&#160;Proxy&#160;servers accordingly.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>It is essential to add your Smart&#160;Proxy&#160;server to the list of trusted proxies on Foreman&#160;server!</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>You have configured the operating system entry on Foreman for Enterprise Linux.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Use the <code>hammer host-registration generate-command</code> to generate the registration command to register your host.</p>
</li>
<li>
<p>On your host that you want to register, run the registration command as <code>root</code>.</p>
<div class="paragraph">
<p>For more information, see the Hammer CLI help with <code>hammer host-registration generate-command --help</code>.</p>
</div>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Next steps</div>
<ul>
<li>
<p>To set up monitoring of outdated services and applications using Tracer, see <a href="https://docs.theforeman.org/nightly/Managing_Hosts/index-foreman-el.html#configuring-tracer-on-a-host_managing-hosts">Configuring Tracer on a host</a> in <em>Managing hosts</em>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="registering-a-host-by-using-api"><a class="anchor" href="#registering-a-host-by-using-api"></a>3.2.5. Registering a host by using Foreman API</h4>
<div class="paragraph _abstract">
<p>You can register a host by using Foreman API with registration templates.
This also enables you to set up various integration features and host tools during the registration process.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Your Foreman account has the <strong>Register hosts</strong> role assigned or a role with equivalent permissions.</p>
</li>
<li>
<p>You must have root privileges on the host that you want to register.</p>
</li>
<li>
<p>You must have installed either <code>curl</code> or <code>wget</code> on the host that you want to register.</p>
</li>
<li>
<p>You have configured your host for registration.
For more information, see <a href="#Configuring_a_Host_for_Registration_managing-hosts">Configuring a host for registration</a>.</p>
</li>
<li>
<p>If you want to use Smart&#160;Proxy&#160;servers instead of your Foreman&#160;server, ensure that you have configured your Smart&#160;Proxy&#160;servers accordingly.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>It is essential to add your Smart&#160;Proxy&#160;server to the list of trusted proxies on Foreman&#160;server!</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>You have configured the operating system entry on Foreman for Enterprise Linux.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Use the POST <code>/api/registration_commands</code> resource.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Next steps</div>
<ul>
<li>
<p>To set up monitoring of outdated services and applications using Tracer, see <a href="https://docs.theforeman.org/nightly/Managing_Hosts/index-foreman-el.html#configuring-tracer-on-a-host_managing-hosts">Configuring Tracer on a host</a> in <em>Managing hosts</em>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="registering-a-host-by-using-ansible"><a class="anchor" href="#registering-a-host-by-using-ansible"></a>3.2.6. Registering a host by using Ansible</h4>
<div class="paragraph _abstract">
<p>You can register a host with an Ansible playbook by using registration templates and set up various integration features and host tools during the registration process.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Use the <code>theforeman.foreman.registration_command</code> module.</p>
<div class="paragraph">
<p>For more information, see the Ansible module documentation with <code>ansible-doc theforeman.foreman.registration_command</code>.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="running-custom-code-during-host-registration"><a class="anchor" href="#running-custom-code-during-host-registration"></a>3.2.7. Running custom code during host registration</h4>
<div class="paragraph _abstract">
<p>You can customize the registration process by creating snippets with pre-defined names.</p>
</div>
<div class="paragraph">
<p>The <code>Global Registration</code> template includes these snippets automatically.
Therefore, you do not have to edit the template.</p>
</div>
<div class="paragraph">
<p>To add custom steps to registration, create one or both of the following snippets:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>before_registration</code></dt>
<dd>
<p>This snippet is loaded and executed by the <code>Global Registration</code> template before registering your host to Foreman.</p>
</dd>
<dt class="hdlist1"><code>after_registration</code></dt>
<dd>
<p>This snippet is loaded and executed by the <code>Global Registration</code> template after registering your host to Foreman.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Ensure you name the snippets precisely.
Otherwise, the <code>Global Registration</code> template cannot load them.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Your Foreman account has a role that grants the permissions <code>view_provisioning_templates</code>, <code>create_provisioning_templates</code>, <code>assign_organizations</code>, and <code>assign_locations</code>.</p>
</li>
<li>
<p>You have selected a particular organization and location context.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Provisioning Templates</strong>.</p>
</li>
<li>
<p>Click <strong>Create Template</strong>.</p>
</li>
<li>
<p>In the <strong>Name</strong> field, enter the name of the required snippet: <code>before_registration</code> or <code>after_registration</code>.</p>
</li>
<li>
<p>In the template editor, create your snippet.</p>
</li>
<li>
<p>On the <strong>Type</strong> tab, select <strong>Snippet</strong>.</p>
</li>
<li>
<p>On the <strong>Locations</strong> tab, assign the snippet to required locations.</p>
</li>
<li>
<p>On the <strong>Organizations</strong> tab, assign the snippet to required organizations.</p>
</li>
<li>
<p>Click <strong>Submit</strong>.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="#Template_Writing_Reference_managing-hosts">Template writing reference</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="Customizing_the_Registration_Templates_managing-hosts"><a class="anchor" href="#Customizing_the_Registration_Templates_managing-hosts"></a>3.2.8. Customizing the registration templates</h4>
<div class="paragraph _abstract">
<p>You can customize the registration process by editing the provisioning templates.</p>
</div>
<div class="paragraph">
<p>Note that all default templates in Foreman are locked.
If you want to customize the registration templates, you must clone the default templates and edit the clones.</p>
</div>
<div class="paragraph">
<p>The registration process uses the following provisioning templates:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <strong>Global Registration</strong> template contains steps for registering hosts to Foreman.
This template renders when hosts access the <code>/register</code> Foreman API endpoint.</p>
</li>
<li>
<p>The <strong>Linux host_init_config default</strong> template contains steps for initial configuration of hosts after they are registered.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Provisioning Templates</strong>.</p>
</li>
<li>
<p>Search for the template you want to edit.</p>
</li>
<li>
<p>In the row of the required template, click <strong>Clone</strong>.</p>
</li>
<li>
<p>Edit the template as needed.
For more information, see <a href="#Template_Writing_Reference_managing-hosts">Template writing reference</a>.</p>
</li>
<li>
<p>Click <strong>Submit</strong>.</p>
</li>
<li>
<p>Navigate to <strong>Administer</strong> &gt; <strong>Settings</strong> &gt; <strong>Provisioning</strong>.</p>
</li>
<li>
<p>Change the following settings as needed:</p>
<div class="ulist">
<ul>
<li>
<p>Point the <strong>Default Global registration template</strong> setting to your custom global registration template,</p>
</li>
<li>
<p>Point the <strong>Default 'Host initial configuration' template</strong> setting to your custom initial configuration template.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="invalidating-registration-tokens"><a class="anchor" href="#invalidating-registration-tokens"></a>3.2.9. Invalidating registration tokens</h4>
<div class="paragraph _abstract">
<p>When you generate a registration command in global host registration, Foreman also generates a unique JSON Web Token (JWT) that is used to authorize the registration call from a host to Foreman&#160;server.
If needed, you can invalidate a previously issued JWT.</p>
</div>
<div class="paragraph">
<p>A JWT is bound to the user that generated the registration command.</p>
</div>
<div class="paragraph">
<p>Users can configure a custom validity duration for the JWT.
If the validity duration is too long or if the JWT has been compromised, the JWT poses a security concern.
To mitigate this concern, the Foreman administrator or users with adequate permissions can invalidate existing JWTs.</p>
</div>
<div class="paragraph">
<p>You can also temporarily disable registration tokens by disabling a user.
When you reenable the user, the user will be able to continue using their registration tokens.</p>
</div>
<div class="sect4">
<h5 id="invalidating-your-own-jwts-by-using-web-ui"><a class="anchor" href="#invalidating-your-own-jwts-by-using-web-ui"></a>Invalidating your own JWTs by using Foreman web UI</h5>
<div class="paragraph _abstract">
<p>You can invalidate all registration JSON Web Tokens of the current user from the Foreman web UI.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, click the user menu in the top bar and select <strong>My Account</strong>.</p>
</li>
<li>
<p>Select the <strong>Registration Tokens</strong> tab.</p>
</li>
<li>
<p>Click <strong>Invalidate JWTs</strong>.</p>
</li>
<li>
<p>In the confirmation window, click <strong>Confirm</strong>.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Verification</div>
<ul>
<li>
<p>The Foreman web UI displays the following message: <code>Successfully invalidated registration tokens.</code></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="invalidating-your-own-jwts-by-using-cli"><a class="anchor" href="#invalidating-your-own-jwts-by-using-cli"></a>Invalidating your own JWTs by using Hammer CLI</h5>
<div class="paragraph _abstract">
<p>You can invalidate all registration JSON Web Tokens of the current user by using Hammer CLI.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Invalidate all your registration tokens:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer user registration-token invalidate --user-id <em>My_User_ID</em></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="invalidating-your-own-jwts-by-using-api"><a class="anchor" href="#invalidating-your-own-jwts-by-using-api"></a>Invalidating your own JWTs by using Foreman API</h5>
<div class="paragraph _abstract">
<p>You can invalidate all registration JSON Web Tokens of the current user by using Foreman API.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Use the <code>DELETE /api/users/<em>:user_id</em>/registration_tokens</code> resource.</p>
<div class="paragraph">
<p>For more information, see the full API reference at <code>https://<em>foreman.example.com</em>/apidoc/v2.html</code>.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="invalidating-jwts-of-other-users-by-using-web-ui"><a class="anchor" href="#invalidating-jwts-of-other-users-by-using-web-ui"></a>Invalidating JWTs of other users by using Foreman web UI</h5>
<div class="paragraph _abstract">
<p>You can invalidate all registration JSON Web Tokens of one or more users from the Foreman web UI.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Your Foreman user has a role that grants the <code>edit_users</code> permissions.
For Foreman web UI, you also require the <code>view_users</code> permission.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Administer</strong> &gt; <strong>Users</strong>.</p>
</li>
<li>
<p>In the row of the user whose registration tokens you want to invalidate, from the actions menu, select <strong>Invalidate JWTs</strong>.</p>
</li>
<li>
<p>In the confirmation window, click <strong>Confirm</strong>.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Verification</div>
<ul>
<li>
<p>The Foreman web UI displays the following message: <code>Successfully invalidated registration tokens for <em>the user</em>.</code></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://docs.theforeman.org/nightly/Administering_Project/index-foreman-el.html#Searching_and_Bookmarking_admin">Searching and bookmarking in _Administering Foreman</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="invalidating-jwts-of-other-users-by-using-cli"><a class="anchor" href="#invalidating-jwts-of-other-users-by-using-cli"></a>Invalidating JWTs of other users by using Hammer CLI</h5>
<div class="paragraph _abstract">
<p>You can invalidate all registration JSON Web Tokens of one or more users by using Hammer CLI.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Your Foreman user has a role that grants the <code>edit_users</code> permissions.
For Foreman web UI, you also require the <code>view_users</code> permission.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Invalidate all registration tokens of a single user:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer user registration-token invalidate --user-id <em>User_ID</em></pre>
</div>
</div>
</li>
<li>
<p>Invalidate all registration tokens of multiple users:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer user registration-token invalidate-multiple --search "<em>My_Search_Query</em>"</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://docs.theforeman.org/nightly/Administering_Project/index-foreman-el.html#Searching_and_Bookmarking_admin">Searching and bookmarking in <em>Administering Foreman</em></a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="invalidating-jwts-of-other-users-by-using-api"><a class="anchor" href="#invalidating-jwts-of-other-users-by-using-api"></a>Invalidating JWTs of other users by using API</h5>
<div class="paragraph _abstract">
<p>You can invalidate all registration JSON Web Tokens of one or more users by using Foreman API.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Your Foreman user has a role that grants the <code>edit_users</code> permissions.
For Foreman web UI, you also require the <code>view_users</code> permission.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Invalidate all registration tokens of a single user by using the <code>DELETE /api/users/<em>:user_id</em>/registration_tokens</code> resource.</p>
</li>
<li>
<p>Invalidate all registration tokens of multiple users by using the <code>DELETE /api/registration_tokens?search=<em>url-encoded-search-query</em></code> resource.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://docs.theforeman.org/nightly/Administering_Project/index-foreman-el.html#Searching_and_Bookmarking_admin">Searching and bookmarking in <em>Administering Foreman</em></a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="invalidating-jwts-of-all-users"><a class="anchor" href="#invalidating-jwts-of-all-users"></a>Invalidating JWTs of all users</h5>
<div class="paragraph _abstract">
<p>You can invalidate all registration JSON Web Tokens of all users at once in the Foreman web UI.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Your Foreman user has a role that grants the <code>view_users</code> and <code>edit_users</code> permissions.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Administer</strong> &gt; <strong>Users</strong>.</p>
</li>
<li>
<p>Click <strong>Invalidate JWTs for all users</strong>.</p>
</li>
<li>
<p>In the confirmation window, click <strong>Confirm</strong>.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Verification</div>
<ul>
<li>
<p>The Foreman web UI displays the following message: <code>Successfully invalidated registration tokens for all users.</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="installing-and-configuring-puppet-agent-during-host-registration_managing-hosts"><a class="anchor" href="#installing-and-configuring-puppet-agent-during-host-registration_managing-hosts"></a>3.3. Installing and configuring Puppet agent during host registration</h3>
<div class="paragraph _abstract">
<p>You can install and configure the Puppet agent on the host during registration.
A configured Puppet agent is required on the host for Puppet integration with your Foreman.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Puppet must be enabled in your Foreman.
For more information, see <a href="https://docs.theforeman.org/nightly/Managing_Configurations_Puppet/index-foreman-el.html#Enabling_Puppet_Integration_managing-configurations-puppet">Enabling Puppet Integration with Foreman</a> in <em>Configuring hosts by using Puppet</em>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Configure</strong> &gt; <strong>Global Parameters</strong> to add host parameters globally.
Alternatively, you can navigate to <strong>Configure</strong> &gt; <strong>Host Groups</strong> and edit or create a host group to add host parameters only to a host group.</p>
</li>
<li>
<p>Enable the Puppet agent using a host parameter in global parameters or a host group.</p>
<div class="paragraph">
<p>To use Puppet 8, add a host parameter named <code>enable-official-puppet8-repo</code>, select the <strong>boolean</strong> type, and set the value to <code>true</code>.
To use Puppet 7, add a host parameter named <code>enable-official-puppet7-repo</code>, select the <strong>boolean</strong> type, and set the value to <code>true</code>.</p>
</div>
</li>
<li>
<p>Specify configuration for the Puppet agent using the following host parameters in global parameters or a host group:</p>
<div class="ulist">
<ul>
<li>
<p>Add a host parameter named <code>puppet_server</code>, select the <strong>string</strong> type, and set the value to the hostname of your Puppet server, such as <code>puppet.example.com</code>.</p>
</li>
<li>
<p>Optional: Add a host parameter named <code>puppet_ca_server</code>, select the <strong>string</strong> type, and set the value to the hostname of your Puppet CA server, such as <code>puppet-ca.example.com</code>.
If <code>puppet_ca_server</code> is not set, the Puppet agent will use the same server as <code>puppet_server</code>.</p>
</li>
<li>
<p>Optional: Add a host parameter named <code>puppet_environment</code>, select the <strong>string</strong> type, and set the value to the Puppet environment you want the host to use.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Until the <a href="https://bugzilla.redhat.com/show_bug.cgi?id=2177730">BZ2177730</a> is resolved, you must use host parameters to specify the Puppet agent configuration even in integrated setups where the Puppet server is a Smart&#160;Proxy&#160;server.</p>
</div>
</li>
<li>
<p>Navigate to <strong>Hosts</strong> &gt; <strong>Register Host</strong> and register your host.
For more information, see <a href="https://docs.theforeman.org/nightly/Managing_Hosts/index-foreman-el.html#Registering_Hosts_by_Using_Global_Registration_managing-hosts">Registering hosts by using global registration</a> in <em>Managing hosts</em>.</p>
</li>
<li>
<p>Navigate to <strong>Infrastructure</strong> &gt; <strong>Smart&#160;Proxies</strong>.</p>
</li>
<li>
<p>From the list in the <strong>Actions</strong> column for the required Smart&#160;Proxy&#160;server, select <strong>Certificates</strong>.</p>
</li>
<li>
<p>Click <strong>Sign</strong> to the right of the required host to sign the SSL certificate for the Puppet agent.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Installing_and_Configuring_Puppet_Agent_Manually_managing-hosts"><a class="anchor" href="#Installing_and_Configuring_Puppet_Agent_Manually_managing-hosts"></a>3.4. Installing and configuring Puppet agent manually</h3>
<div class="paragraph _abstract">
<p>You can install and configure the Puppet agent on a host manually.
A configured Puppet agent is required on the host for Puppet integration with your Foreman.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Puppet must be enabled in your Foreman.
For more information, see <a href="https://docs.theforeman.org/nightly/Managing_Configurations_Puppet/index-foreman-el.html#Enabling_Puppet_Integration_managing-configurations-puppet">Enabling Puppet Integration with Foreman</a> in <em>Configuring hosts by using Puppet</em>.</p>
</li>
<li>
<p>The host must have a Puppet environment assigned to it.</p>
</li>
<li>
<p>Ensure a repository containing the Puppet agent is enabled on the host, for example <a href="https://apt.puppet.com/">apt.puppet.com</a> or <a href="https://yum.puppet.com/">yum.puppet.com</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Log in to the host as the <code>root</code> user.</p>
</li>
<li>
<p>Install the Puppet agent package.</p>
<div class="ulist">
<ul>
<li>
<p>On hosts running Enterprise Linux 8 and above:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># dnf install puppet-agent</pre>
</div>
</div>
</li>
<li>
<p>On hosts running Debian:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># apt install puppet-agent</pre>
</div>
</div>
</li>
<li>
<p>On hosts running SUSE Linux Enterprise Server:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># zypper install puppet-agent</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Add the Puppet agent to <code>PATH</code> in your current shell using the following script:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">. /etc/profile.d/puppet-agent.sh</pre>
</div>
</div>
</li>
<li>
<p>Configure the Puppet agent.
Set the <code>environment</code> parameter to the name of the Puppet environment to which the host belongs:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># puppet config set server <em>foreman.example.com</em> --section agent
# puppet config set environment <em>My_Puppet_Environment</em> --section agent</pre>
</div>
</div>
</li>
<li>
<p>Start the Puppet agent service:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># puppet resource service puppet ensure=running enable=true</pre>
</div>
</div>
</li>
<li>
<p>Create a certificate for the host:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># puppet ssl bootstrap</pre>
</div>
</div>
</li>
<li>
<p>In the Foreman web UI, navigate to <strong>Infrastructure</strong> &gt; <strong>Smart&#160;Proxies</strong>.</p>
</li>
<li>
<p>From the list in the <strong>Actions</strong> column for the required Smart&#160;Proxy&#160;server, select <strong>Certificates</strong>.</p>
</li>
<li>
<p>Click <strong>Sign</strong> to the right of the required host to sign the SSL certificate for the Puppet agent.</p>
</li>
<li>
<p>On the host, run the Puppet agent again:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># puppet ssl bootstrap</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="running-ansible-roles-during-host-registration"><a class="anchor" href="#running-ansible-roles-during-host-registration"></a>3.5. Running Ansible roles during host registration</h3>
<div class="paragraph _abstract">
<p>You can run Ansible roles when you are registering a host to Foreman.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Ansible integration is enabled on Foreman.
For more information, see <a href="https://docs.theforeman.org/nightly/Managing_Configurations_Ansible/index-foreman-el.html#Enabling_Ansible_Integration_with_foreman_ansible">Enabling Ansible integration with Foreman</a> in <em>Configuring hosts by using Ansible</em>.</p>
</li>
<li>
<p>The required Ansible roles have been imported from your Smart&#160;Proxy to Foreman.
For more information, see <a href="https://docs.theforeman.org/nightly/Managing_Configurations_Ansible/index-foreman-el.html#Importing_Ansible_Roles_and_Variables_ansible">Importing Ansible roles and variables</a> in <em>Configuring hosts by using Ansible</em>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create a host group with Ansible roles.
For more information, see <a href="#Working_with_Host_Groups_managing-hosts">Working with host groups</a>.</p>
</li>
<li>
<p>Register the host by using the host group with assigned Ansible roles.
For more information, see <a href="#registering-a-host-by-using-web-ui">Registering a host by using Foreman web UI</a> or <a href="#registering-a-host-by-using-cli">Registering a host by using Hammer CLI</a>.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-network-interfaces"><a class="anchor" href="#configuring-network-interfaces"></a>4. Configuring network interfaces</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>Foreman supports specifying multiple network interfaces for a single host.
You can configure these interfaces when creating a new host or when editing an existing host.</p>
</div>
<div class="paragraph">
<p>There are several types of network interfaces that you can attach to a host.
When configuring an interface, select one of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Interface</strong>: Allows you to specify an additional physical or virtual interface.
There are two types of virtual interfaces you can create.
Use <strong>VLAN</strong> when the host needs to communicate with several (virtual) networks by using a single interface, while these networks are not accessible to each other.
Use <strong>alias</strong> to add an additional IP address to an existing interface.</p>
</li>
<li>
<p><strong>Bond</strong>: Creates a bonded interface.
NIC bonding is a way to bind multiple network interfaces together into a single interface that appears as a single device and has a single MAC address.
This enables two or more network interfaces to act as one, increasing the bandwidth and providing redundancy.</p>
</li>
<li>
<p><strong>BMC</strong>: Baseboard Management Controller (BMC) allows you to remotely monitor and manage the physical state of machines.
For more information about BMC, see <a href="https://docs.theforeman.org/nightly/Installing_Server/index-foreman-el.html#enabling-power-management-on-hosts_foreman">Enabling Power Management on Hosts</a> in <em>Installing Foreman&#160;Server nightly on Enterprise Linux</em>.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Additional interfaces have the <strong>Managed</strong> flag enabled by default, which means the new interface is configured automatically during provisioning by the DNS and DHCP Smart&#160;Proxy&#160;servers associated with the selected subnet.
This requires a subnet with correctly configured DNS and DHCP Smart&#160;Proxy&#160;servers.
If you use a Kickstart method for host provisioning, configuration files are automatically created for managed interfaces in the post-installation phase at <code>/etc/sysconfig/network-scripts/ifcfg-<em>interface_id</em></code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="configuring-a-physical-interface"><a class="anchor" href="#configuring-a-physical-interface"></a>4.1. Configuring a physical interface</h3>
<div class="paragraph _abstract">
<p>You can configure a physical interface for a host.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the <strong>Add Interface</strong> form:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>All Hosts</strong>.</p>
</li>
<li>
<p>Click <strong>Edit</strong> next to the host you want to edit.</p>
</li>
<li>
<p>On the <strong>Interfaces</strong> tab, click <strong>Add Interface</strong>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Specify the general interface settings:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Specify a <strong>MAC address</strong>.
This setting is required.</p>
</li>
<li>
<p>Specify the <strong>Device Identifier</strong>, for example <code>eth0</code>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Configure network and DNS settings:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Specify the <strong>DNS name</strong> associated with the host&#8217;s IP address.</p>
</li>
<li>
<p>Select a domain from the <strong>Domain</strong> list.</p>
</li>
<li>
<p>Select a subnet in the <strong>IPv4 Subnet</strong> or <strong>IPv6 Subnet</strong> list.</p>
</li>
<li>
<p>Specify the <strong>IPv4 address</strong> or <strong>IPv6 address</strong>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Managed interfaces with an assigned DHCP Smart&#160;Proxy&#160;server require this setting for creating a DHCP lease.
DHCP-enabled managed interfaces are automatically provided with a suggested IP address.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Specify interface management options:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Select whether the interface is <strong>Managed</strong>.</p>
</li>
<li>
<p>Select whether this is the <strong>Primary</strong> interface for the host.</p>
</li>
<li>
<p>Select whether this is the <strong>Provision</strong> interface for the host.</p>
</li>
<li>
<p>Select whether to use the interface for <strong>Remote execution</strong>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Click <strong>OK</strong> to save the interface configuration.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to apply the changes to the host.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="configuring-a-virtual-interface"><a class="anchor" href="#configuring-a-virtual-interface"></a>4.2. Configuring a virtual interface</h3>
<div class="paragraph _abstract">
<p>You can configure a virtual interface for a host.
This can be either a VLAN or an alias interface.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A VLAN interface allows the host to connect to separate network segments using a single physical interface.</p>
</li>
<li>
<p>An alias interface is an additional IP address attached to an existing interface.
An alias interface automatically inherits a MAC address from the interface it is attached to; therefore, you can create an alias without specifying a MAC address.
The interface must be specified in a subnet with boot mode set to <code>static</code>.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Virtual interfaces currently require a MAC address of a physical device.
Therefore, the configuration of these interfaces works only on bare-metal hosts.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the <strong>Add Interface</strong> form:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>All Hosts</strong>.</p>
</li>
<li>
<p>Click <strong>Edit</strong> next to the host you want to edit.</p>
</li>
<li>
<p>On the <strong>Interfaces</strong> tab, click <strong>Add Interface</strong>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Specify the general interface settings:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If the virtual interface is managed, specify a <strong>MAC address</strong>.</p>
</li>
<li>
<p>Specify ID in the <strong>Device Identifier</strong> field.</p>
<div class="ulist">
<ul>
<li>
<p>For a VLAN, use the <code>eth1.10</code> format.</p>
</li>
<li>
<p>For an alias, use the <code>eth1:10</code> format.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Configure a virtual NIC:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Select the <strong>Virtual NIC</strong> checkbox.</p>
</li>
<li>
<p>Optionally, specify a VLAN <strong>Tag</strong>.</p>
</li>
<li>
<p>Specify the identifier of the physical interface to which the virtual interface is <strong>Attached to</strong>, for example <code>eth1</code>. This setting is required.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Click <strong>OK</strong> to save the interface configuration.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to apply the changes to the host.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="configuring-a-bonded-interface-by-using-web-ui"><a class="anchor" href="#configuring-a-bonded-interface-by-using-web-ui"></a>4.3. Configuring a bonded interface by using Foreman web UI</h3>
<div class="paragraph _abstract">
<p>You can combine multiple physical interfaces together by configuring a bonded interface for the host.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Bonded interfaces currently require a MAC address of a physical device.
Therefore, the configuration of these interfaces works only on bare-metal hosts.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the <strong>Add Interface</strong> form:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>All Hosts</strong>.</p>
</li>
<li>
<p>Click <strong>Edit</strong> next to the host you want to edit.</p>
</li>
<li>
<p>On the <strong>Interfaces</strong> tab, click <strong>Add Interface</strong>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Select <strong>Bond</strong> from the <strong>Type</strong> list.</p>
</li>
<li>
<p>Specify the general interface settings:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In the <strong>Device Identifier</strong> field, specify the interface ID in the <code>bond0</code> format .</p>
</li>
<li>
<p>Specify a <strong>MAC address</strong>.</p>
</li>
<li>
<p>If you are configuring a secondary interface, select <strong>Managed</strong>.
Otherwise, Foreman does not apply the configuration.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Add the configuration specific to bonded interfaces:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><strong>Mode</strong>: Select the bonding mode.</p>
</li>
<li>
<p><strong>Attached devices</strong>: Specify a comma-separated list of identifiers of attached devices.
These can be physical interfaces or VLANs.</p>
</li>
<li>
<p><strong>Bond options</strong>: Specify a space-separated list of configuration options, for example <code>miimon=100</code>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Click <strong>OK</strong> to save the interface configuration.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to apply the changes to the host.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="configuring-a-bonded-interface-by-using-cli"><a class="anchor" href="#configuring-a-bonded-interface-by-using-cli"></a>4.4. Configuring a bonded interface by using Hammer CLI</h3>
<div class="paragraph _abstract">
<p>You can combine multiple physical interfaces together by configuring a bonded interface for the host.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Bonded interfaces currently require a MAC address of a physical device.
Therefore, the configuration of these interfaces works only on bare-metal hosts.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Create a host with a bonded interface:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer host create \
--ask-root-password yes \
--hostgroup <em>My_Host_Group</em> \
--ip=<em>My_IP_Address</em> \
--mac=<em>My_MAC_Address</em> \
--managed true \
--interface="identifier=<em>My_NIC_1, mac=_My_MAC_Address_1</em>, managed=true, type=Nic::Managed, domain_id=<em>My_Domain_ID</em>, subnet_id=<em>My_Subnet_ID</em>" \
--interface="identifier=<em>My_NIC_2</em>, mac=<em>My_MAC_Address_2</em>, managed=true, type=Nic::Managed, domain_id=<em>My_Domain_ID</em>, subnet_id=<em>My_Subnet_ID</em>" \
--interface="identifier=<em>bondN</em>, ip=<em>My_IP_Address_2</em>, type=Nic::Bond, mode=active-backup, attached_devices=[<em>My_NIC_1</em>,<em>My_NIC_2</em>], managed=true, domain_id=<em>My_Domain_ID</em>, subnet_id=<em>My_Subnet_ID</em>" \
--location "<em>My_Location</em>" \
--name "<em>My_Host_Name</em>" \
--organization "<em>My_Organization</em>" \
--subnet-id=<em>My_Subnet_ID</em></pre>
</div>
</div>
<div class="paragraph">
<p>Replace <code>bondN</code> with <code>bond</code> and the ID of your device identifier, for example, <code>bond0</code>.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="configuring-a-bridge-interface"><a class="anchor" href="#configuring-a-bridge-interface"></a>4.5. Configuring a bridge interface</h3>
<div class="paragraph _abstract">
<p>You can configure traffic forwarding between networks by configuring a bridge interface.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>All Hosts</strong>.</p>
</li>
<li>
<p>Click <strong>Edit</strong> next to the host you want to edit.</p>
</li>
<li>
<p>On the <strong>Interfaces</strong> tab, click <strong>Add Interface</strong>.</p>
</li>
<li>
<p>Select <strong>Bridge</strong> from the <strong>Type</strong> list.</p>
</li>
<li>
<p>Specify a <strong>MAC address</strong>.</p>
</li>
<li>
<p>In the <strong>Device Identifier</strong> field, specify the interface ID in the <code>bridge0</code> format.</p>
</li>
<li>
<p>If you are configuring a secondary interface, select <strong>Managed</strong>.</p>
</li>
<li>
<p>In the <strong>Attached devices</strong> field, specify a comma-separated list of identifiers of attached devices.
These can be physical or virtual Ethernet devices, bonds, or VLAN devices.</p>
</li>
<li>
<p>Click <strong>OK</strong> to save the interface configuration.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to apply the changes to the host.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="bonding-modes-available_managing-hosts"><a class="anchor" href="#bonding-modes-available_managing-hosts"></a>4.6. Bonding modes available in Foreman</h3>
<div class="paragraph _abstract">
<p>The following bonding modes are available when managing network interfaces in Foreman.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Bonding Mode</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">balance-rr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transmissions are received and sent sequentially on each bonded interface.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">active-backup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transmissions are received and sent through the first available bonded interface.
Another bonded interface is only used if the active bonded interface fails.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">balance-xor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transmissions are based on the selected hash policy.
In this mode, traffic destined for specific peers is always sent over the same interface.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">broadcast</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All transmissions are sent on all bonded interfaces.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">802.a3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Creates aggregation groups that share the same settings.
Transmits and receives on all interfaces in the active group.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">balance-tlb</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The outgoing traffic is distributed according to the current load on each bonded interface.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">balance-alb</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Receive load balancing is achieved through Address Resolution Protocol (ARP) negotiation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="configuring-a-baseboard-management-controller-interface"><a class="anchor" href="#configuring-a-baseboard-management-controller-interface"></a>4.7. Configuring a baseboard management controller (BMC) interface</h3>
<div class="paragraph _abstract">
<p>To control the power status of bare-metal hosts from Foreman, you can configure a baseboard management controller (BMC) interface for hosts that support this feature.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Power management is enabled on Foreman&#160;server.
For more information, see <a href="https://docs.theforeman.org/nightly/Installing_Server/index-foreman-el.html#enabling-power-management-on-hosts_foreman">Enabling power management on hosts</a> in <em>Installing Foreman&#160;Server nightly on Enterprise Linux</em>.</p>
</li>
<li>
<p>If you want to use Smart&#160;Proxy&#160;server instead of Foreman&#160;server, ensure that power management is enabled on your Smart&#160;Proxy&#160;server.
For more information, see <a href="https://docs.theforeman.org/nightly/Installing_Proxy/index-foreman-el.html#enabling-power-management-on-hosts_foreman">Enabling power management on hosts</a> in <em>Installing a Smart&#160;Proxy&#160;Server nightly on Enterprise Linux</em>.</p>
</li>
<li>
<p>You know the MAC address, IP address, and other details of the BMC interface on the host, and authentication credentials for that interface.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>You only need the MAC address for the BMC interface if the BMC interface is managed, so that it can create a DHCP reservation.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>All Hosts</strong>.</p>
</li>
<li>
<p>Edit your host.</p>
</li>
<li>
<p>On the <strong>Interfaces</strong> tab, click <strong>Add Interface</strong>.</p>
</li>
<li>
<p>Select <strong>BMC</strong> from the <strong>Type</strong> list.</p>
</li>
<li>
<p>Specify the general interface settings:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If the BMC is managed, specify a <strong>MAC address</strong>.</p>
</li>
<li>
<p>Specify the <strong>Device Identifier</strong>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Specify the configuration options specific to BMC interfaces:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><strong>Username</strong> and <strong>Password</strong>: Specify any authentication credentials required by BMC.</p>
</li>
<li>
<p><strong>Provider</strong>: Specify the BMC provider.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Click <strong>OK</strong> to save the interface configuration.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to apply the changes to the host.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="network-interface-configuration-options"><a class="anchor" href="#network-interface-configuration-options"></a>4.8. Network interface configuration options</h3>
<div class="paragraph _abstract">
<p>When adding a network interface, you need to specify several configuration options.
The following lists provide information on the relevant options for the different types of interfaces.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Physical interface settings</dt>
<dd>
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>Device Identifier</strong></dt>
<dd>
<p>The identifier is used to specify this physical interface when creating bonded interfaces, VLANs, and aliases.</p>
</dd>
<dt class="hdlist1"><strong>DNS name</strong></dt>
<dd>
<p>Foreman saves this name in the Smart&#160;Proxy&#160;server associated with the selected domain (the "DNS A" field) and Smart&#160;Proxy&#160;server associated with the selected subnet (the "DNS PTR" field).
A single host can therefore have several DNS entries.</p>
</dd>
<dt class="hdlist1"><strong>Domain</strong></dt>
<dd>
<p>Specifies the domain associated with the network interface. To create and manage domains, navigate to <strong>Infrastructure</strong> &gt; <strong>Domains</strong>.</p>
</dd>
<dt class="hdlist1"><strong>Subnet</strong></dt>
<dd>
<p>Specifies the subnet associated with the network interface. To create and manage subnets, navigate to <strong>Infrastructure</strong> &gt; <strong>Subnets</strong>.</p>
</dd>
<dt class="hdlist1"><strong>Managed</strong> interface</dt>
<dd>
<p>If the interface is managed, configuration is pulled from the associated Smart&#160;Proxy&#160;server during provisioning, and DNS and DHCP entries are created.
If you use provisioning with installer automation, a configuration file is automatically created for the interface.</p>
</dd>
<dt class="hdlist1"><strong>Primary</strong> interface</dt>
<dd>
<p>The DNS name from the primary interface is used as the host portion of the FQDN.</p>
</dd>
<dt class="hdlist1"><strong>Provision</strong></dt>
<dd>
<p>Network boot uses the provisioning interface.
For image-based provisioning, the script to complete the provisioning is executed through the provisioning interface.</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1">Virtual interface settings</dt>
<dd>
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>Tag</strong></dt>
<dd>
<p>You can set a VLAN tag to trunk a network segment from the physical network through to the virtual interface.</p>
<div class="ulist">
<ul>
<li>
<p>If you do not specify a tag, managed interfaces inherit the VLAN tag of the associated subnet.</p>
</li>
<li>
<p>User-specified entries from this field are not applied to alias interfaces.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1">Bonded interface settings</dt>
<dd>
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>Mode</strong></dt>
<dd>
<p>The bonding mode defines a policy for fault tolerance and load balancing.
See <a href="#bonding-modes-available_managing-hosts">Bonding modes available in Foreman</a> for a brief description of each bonding mode.</p>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Upgrading_Hosts_to_Next_Major_Release_managing-hosts"><a class="anchor" href="#Upgrading_Hosts_to_Next_Major_Release_managing-hosts"></a>5. Upgrading hosts to next major Enterprise Linux release</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>You can use a job template to upgrade your Enterprise Linux hosts to the next major release.</p>
</div>
<div class="paragraph">
<p>Below upgrade paths are possible:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Enterprise Linux 7 to Enterprise Linux 8</p>
</li>
<li>
<p>Enterprise Linux 8 to Enterprise Linux 9</p>
</li>
<li>
<p>Enterprise Linux 9 to Enterprise Linux 10</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Ensure that your Enterprise Linux hosts meet the requirements for the upgrade.</p>
<div class="ulist">
<ul>
<li>
<p>For Enterprise Linux 7 to Enterprise Linux 8 upgrade, see <a href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/upgrading_from_rhel_7_to_rhel_8/planning-an-upgrade_upgrading-from-rhel-7-to-rhel-8">Planning an upgrade</a> in <em>Upgrading from RHEL 7 to RHEL 8</em>.</p>
</li>
<li>
<p>For Enterprise Linux 8 to Enterprise Linux 9 upgrade, see <a href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/upgrading_from_rhel_8_to_rhel_9/planning-an-upgrade-to-rhel-9_upgrading-from-rhel-8-to-rhel-9">Planning an upgrade to RHEL 9</a> in <em>Upgrading from RHEL 8 to RHEL 9</em>.</p>
</li>
<li>
<p>For Enterprise Linux 9 to Enterprise Linux 10 upgrade, see <a href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/10/html/upgrading_from_rhel_9_to_rhel_10/planning-an-upgrade-to-rhel-10">Planning an upgrade to RHEL 10</a> in <em>Upgrading from RHEL 9 to RHEL 10</em>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Prepare your Enterprise Linux hosts for the upgrade.</p>
<div class="ulist">
<ul>
<li>
<p>For Enterprise Linux 7 to Enterprise Linux 8 upgrade, see <a href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html-single/upgrading_from_rhel_7_to_rhel_8/index#preparing-a-rhel-7-system-for-the-upgrade_upgrading-from-rhel-7-to-rhel-8">Preparing a RHEL 7 system for the upgrade</a> in <em>Upgrading from RHEL 7 to RHEL 8</em>.</p>
</li>
<li>
<p>For Enterprise Linux 8 to Enterprise Linux 9 upgrade, see <a href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/upgrading_from_rhel_8_to_rhel_9/assembly_preparing-for-the-upgrade_upgrading-from-rhel-8-to-rhel-9#preparing-a-rhel-8-system-for-the-upgrade_upgrading-from-rhel-8-to-rhel-9">Preparing a RHEL 8 system for the upgrade</a> in <em>Upgrading from RHEL 8 to RHEL 9</em>.</p>
</li>
<li>
<p>For Enterprise Linux 9 to Enterprise Linux 10 upgrade, see <a href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/10/html/upgrading_from_rhel_9_to_rhel_10/preparing-for-the-upgrade#preparing-a-rhel-9-system-for-the-upgrade">Preparing a RHEL 9 system for the upgrade</a> in <em>Upgrading from RHEL 9 to RHEL 10</em>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Enable remote execution feature on Foreman.
For more information, see <a href="#configuring-and-setting-up-remote-jobs">Configuring and setting up remote jobs</a>.</p>
</li>
<li>
<p>Distribute Foreman SSH keys to the hosts that you want to upgrade.
For more information, see <a href="#Distributing_SSH_Keys_for_Remote_Execution_managing-hosts">Distributing SSH keys for remote execution</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>On Foreman, enable the Leapp plugin:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-installer --enable-foreman-plugin-leapp</pre>
</div>
</div>
</li>
<li>
<p>Optional: Customize the upgrade by modifying the default pre-upgrade check and upgrade job templates.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Clone and modify the <strong>Run preupgrade via Leapp</strong> template, the <strong>Run upgrade via Leapp</strong> template, or both.
For more information, see <a href="#customizing-job-templates">Customizing job templates</a>.</p>
</li>
<li>
<p>In the Foreman web UI, navigate to <strong>Administer</strong> &gt; <strong>Remote Execution Features</strong>.</p>
</li>
<li>
<p>If you modified the pre-upgrade template, click <strong>leapp_preupgrade</strong>.
If you modified the upgrade template, click <strong>leapp_upgrade</strong>.</p>
</li>
<li>
<p>In the <strong>Job Template</strong> drop-down menu, select your template.</p>
</li>
<li>
<p>Click <strong>Submit</strong>.
The <strong>leap_preupgrade</strong> and <strong>leapp_upgrade</strong> remote execution features now point to the modified templates.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Run a pre-upgrade check:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>All Hosts</strong>.</p>
</li>
<li>
<p>Select the hosts that you want to upgrade.</p>
</li>
<li>
<p>If you want to upgrade to the latest available release, expand the <strong>Schedule a Job</strong> drop-down menu and select <strong>Preupgrade check with Leapp</strong>.</p>
</li>
<li>
<p>If you want to upgrade to a specific release version, click <strong>Schedule a job</strong>.
From the <strong>Job category</strong> list, select <strong>Leapp - Preupgrade</strong>.
Follow the job wizard to start the preupgrade check.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Review the results of the pre-upgrade check:</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The results of the pre-upgrade check are only available in the legacy Foreman web UI job invocation details page.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Navigate to <strong>Monitor</strong> &gt; <strong>Jobs</strong>.
Click the pre-upgrade check job.</p>
</li>
<li>
<p>From the <strong>Rerun all</strong> dropdown menu, click <strong>Legacy UI</strong>.</p>
</li>
<li>
<p>Click the <strong>Leapp preupgrade report</strong> tab to see if Leapp has found any issues on your hosts.
Issues that have the <strong>Inhibitor</strong> flag are considered crucial and are likely to break the upgrade procedure.
Issues that have the <strong>Has Remediation</strong> flag contain remediation that can help you fix the issue.</p>
</li>
<li>
<p>Click an issue that is flagged as <strong>Has Remediation</strong> to expand it.</p>
<div class="ulist">
<ul>
<li>
<p>If the issue contains a remediation <strong>Command</strong>, you can fix it directly from Foreman using remote execution.
Select the issue.</p>
</li>
<li>
<p>If the issue contains only a remediation <strong>Hint</strong>, use the hint to fix the issue on the host manually.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Repeat this step for other issues.</p>
</div>
</li>
<li>
<p>After you selected any issues with remediation commands, click <strong>Fix Selected</strong> and submit the job.</p>
</li>
<li>
<p>After the issues are fixed, click <strong>Rerun</strong>, and then click <strong>Submit</strong> to run the pre-upgrade check again to verify that the hosts you are upgrading do not have any issues and are ready to be upgraded.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Start the upgrade:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>All Hosts</strong>.</p>
</li>
<li>
<p>Select the hosts that you want to upgrade.</p>
</li>
<li>
<p>If you want to upgrade to the latest available release version, expand the <strong>Schedule a Job</strong> drop-down menu and select <strong>Upgrade with Leapp</strong>.</p>
</li>
<li>
<p>If you want to upgrade to a specific release version, click <strong>Schedule a job</strong>.
From the <strong>Job category</strong> list, select <strong>Leapp - Upgrade</strong>.
Follow the job wizard to start the upgrade.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="host-management-and-monitoring-by-using-cockpit"><a class="anchor" href="#host-management-and-monitoring-by-using-cockpit"></a>6. Host management and monitoring by using Cockpit</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>You can use the Cockpit interactive web interface to perform actions and monitor Enterprise Linux hosts.
You can enable a remote-execution feature to integrate Foreman with Cockpit.
When you install Cockpit on a host that you manage with Foreman, you can view the Cockpit dashboards of that host from within the Foreman web UI.
You can also use the features that are integrated with Cockpit, for example, Lorax Composer.</p>
</div>
<div class="sect2">
<h3 id="Enabling_Cockpit_on_Server_managing-hosts"><a class="anchor" href="#Enabling_Cockpit_on_Server_managing-hosts"></a>6.1. Enabling Cockpit on Foreman</h3>
<div class="paragraph _abstract">
<p>By default, Cockpit integration is disabled in Foreman.
If you want to access Cockpit features for your hosts from within Foreman, you must first enable Cockpit on Foreman&#160;server.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Enable Cockpit on your Foreman&#160;server:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-installer --enable-foreman-plugin-remote-execution-cockpit --reset-foreman-plugin-remote-execution-cockpit-ensure</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Managing_and_Monitoring_Hosts_Using_Cockpit_managing-hosts"><a class="anchor" href="#Managing_and_Monitoring_Hosts_Using_Cockpit_managing-hosts"></a>6.2. Managing and monitoring hosts using Cockpit</h3>
<div class="paragraph _abstract">
<p>You can access the Cockpit UI through the Foreman web UI and use the functionality to manage and monitor hosts in Foreman.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have enabled Cockpit in Foreman.</p>
</li>
<li>
<p>You have installed Cockpit on the host that you want to manage and monitor.</p>
<div class="paragraph">
<p>Foreman provides a job template named <strong>Service Action &#8211; Enable Web Console</strong> under the <strong>Ansible Services</strong> job category that you can use to install Cockpit.
For more information about running remote jobs, see <a href="#configuring-and-setting-up-remote-jobs">Configuring and setting up remote jobs</a>.</p>
</div>
</li>
<li>
<p>Foreman or Smart&#160;Proxy can authenticate to the host with SSH keys.
For more information, see <a href="#Distributing_SSH_Keys_for_Remote_Execution_managing-hosts">Distributing SSH keys for remote execution</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>All Hosts</strong> and select the host that you want to manage and monitor with Cockpit.</p>
</li>
<li>
<p>In the upper right of the host window, click the vertical ellipsis and select <strong>Web Console</strong>.</p>
<div class="paragraph">
<p>You can now access the full range of features available for host monitoring and management, for example, Lorax Composer, through Cockpit.</p>
</div>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://cockpit-project.org/documentation.html">Cockpit documentation</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="disabling-cockpit-on-project_managing-hosts"><a class="anchor" href="#disabling-cockpit-on-project_managing-hosts"></a>6.3. Disabling Cockpit on Foreman</h3>
<div class="paragraph _abstract">
<p>Perform the following procedure if you want to disable Cockpit on Foreman.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Disable Cockpit on your Foreman&#160;server:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-installer --foreman-plugin-remote-execution-cockpit-ensure absent</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>You can enable or disable Cockpit integration independently on Smart&#160;Proxy&#160;servers.
After completing the procedure on your Foreman&#160;server, you can disable Cockpit integration on your Smart&#160;Proxy&#160;servers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-installer --foreman-proxy-plugin-remote-execution-script-cockpit-integration false</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="connecting-ai-applications-to-the-mcp-server-for-foreman"><a class="anchor" href="#connecting-ai-applications-to-the-mcp-server-for-foreman"></a>7. Connecting AI applications to the MCP server for Foreman</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>Foreman provides a Model Context Protocol (MCP) server to enable integration with your MCP-compatible AI applications.
By connecting your MCP client to the MCP server, you can obtain comprehensive AI-generated reports and data analysis of your Foreman inventory.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>MCP server for Foreman is a Technology Preview feature only.
Technology Preview features are not supported by Foreman community.
Foreman community does not recommend using them in production.
These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="foreman-mcp-integration-overview"><a class="anchor" href="#foreman-mcp-integration-overview"></a>7.1. Foreman MCP integration overview</h3>
<div class="paragraph _abstract">
<p>Foreman provides a Model Context Protocol (MCP) server so that users can use their preferred AI applications to obtain and process data about Foreman inventory.</p>
</div>
<div class="paragraph">
<p>Foreman community provides a container image that you use to deploy an MCP server for Foreman.
On your system, you run an AI application, also known as MCP host.
Your AI application runs an MCP client.
The MCP client connects to your MCP server for Foreman.
The MCP server obtains the data about Foreman inventory by making API calls to your Foreman&#160;server with SSL-encrypted HTTP requests.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>For enhanced security, deploy the MCP server on the same system where the MCP client is running so that they can communicate over localhost.
Avoid deploying the MCP server on a system exposed to the network.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/common/mcp-architecture.png" alt="MCP integration with a single user">
</div>
</div>
<div class="paragraph">
<div class="title">Architecture of Foreman MCP integration with a single user</div>
<p>Each Foreman user deploys their own MCP server and uses their credentials to access the Foreman inventory data.
A user&#8217;s MCP client cannot obtain data that the user does not have permission to access.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/common/mcp-architecture-2.png" alt="MCP integration with multiple users">
</div>
</div>
<div class="paragraph">
<div class="title">Architecture of Foreman MCP integration with multiple users</div>
<p>When the connection is established, you query your AI application for data about your Foreman environment.
The MCP client within the AI application obtains the required data from your Foreman inventory and returns it to the AI application.
The AI application processes the data to answer your queries.</p>
</div>
<div class="paragraph">
<p>The MCP server runs in read-only mode.
It extracts data from your Foreman inventory but cannot write, edit, or make any updates to the inventory.</p>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://modelcontextprotocol.io">Model Context Protocol</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="deploying-the-mcp-server-for-Foreman"><a class="anchor" href="#deploying-the-mcp-server-for-Foreman"></a>7.2. Deploying the MCP server for Foreman</h3>
<div class="paragraph _abstract">
<p>Deploy the Model Context Protocol (MCP) server for Foreman as a container and make it accessible to your MCP client.</p>
</div>
<div class="paragraph">
<p>In this scenario, you deploy the MCP server on the same system where your MCP client will run.
This can also be the system Foreman&#160;server is running on.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>In this scenario, the MCP server uses the <em>Streamable HTTP</em> transport mode for client-server communication.
<em>Streamable HTTP</em> is the default MCP transport mode that can in some cases represent potential security risks.
Consider using <em>stdio</em> transport mode instead.
For more information, see <a href="https://modelcontextprotocol.io/specification/2025-06-18/basic/transports"><em>Transports</em> in the Model Context Protocol documentation</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The CA bundle for your Foreman is available on your system.
You can download it from <code>https://<em>foreman.example.com</em>/unattended/public/foreman_raw_ca</code>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Optional: Pull the latest version of the MCP container image from the registry:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ podman pull quay.io/foreman/foreman-mcp-server:latest</pre>
</div>
</div>
</li>
<li>
<p>Run the container:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ podman run --interactive --tty --publish 127.0.0.1:8080:8080 \
  --volume <em>Path_to_My_CA_Bundle</em>:/app/ca.pem:ro,Z \
  quay.io/foreman/foreman-mcp-server:latest \
  --foreman-url https://<em>foreman.example.com</em></pre>
</div>
</div>
<div class="paragraph">
<p>The options used in the command include the following:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>--publish</code></dt>
<dd>
<p>Maps port 8080 from inside the container to port 8080 on the host, binding the port to the localhost.</p>
</dd>
<dt class="hdlist1"><code>--volume</code></dt>
<dd>
<p>Mounts your CA certificate bundle from the host machine to the default location (<code>ca.pem</code>) inside the container.</p>
<div class="ulist">
<ul>
<li>
<p><code>ro</code> makes the read-only mode inside the container</p>
</li>
<li>
<p><code>Z</code> relabels the file with a private, unshared label</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><code><em>Path_to_My_CA_Bundle</em></code></dt>
<dd>
<p>Specifies the location of the Foreman CA bundle on the system.
This is required to verify the connection to Foreman.</p>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>Do not use the <code>--no-verify-ssl</code> option in production environments.
Disabling SSL certificate verification with <code>--no-verify-ssl</code> compromises the security of your connection, making you vulnerable to security threats such as man-in-the-middle (MITM) attacks.</p>
</div>
</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="connecting-the-mcp-client-to-the-mcp-server"><a class="anchor" href="#connecting-the-mcp-client-to-the-mcp-server"></a>7.3. Connecting the MCP client to the MCP server</h3>
<div class="paragraph _abstract">
<p>Connect your Model Context Protocol (MCP) client to the MCP server so that your AI application can obtain data about your Foreman inventory.</p>
</div>
<div class="paragraph">
<p>In this scenario, your MCP client runs on the same system where you deployed the MCP server.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Your MCP client must support setting custom HTTP headers.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Generate a personal access token (PAT) that the MCP client will use to connect to the MCP server:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In the Foreman web UI, click the user menu in the top bar and select <strong>My Account</strong>.</p>
</li>
<li>
<p>Select the <strong>Personal Access Tokens</strong> tab.</p>
</li>
<li>
<p>Click <strong>Add Personal Access Token</strong>.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>Foreman community recommends to set an expiration date for a PAT used to configure the MCP client.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Configure your client to pass credentials in an HTTP authorization request header.
The exact configuration steps depend on your MCP client.</p>
<div class="paragraph">
<p>For example, some clients require you to create a configuration file with the following contents:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">"my-mcp-server": {
	"url": "http://localhost:8080/mcp/sse",
	"type": "http",
	"headers": {
		"FOREMAN_USERNAME": "<em>My_Username</em>",
		"FOREMAN_TOKEN": "<em>My_PAT</em>"
	}
}</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://docs.theforeman.org/nightly/Project_API/index-foreman-el.html#creating-a-personal-access-token_rest-api">Creating a Personal Access Token in <em>Using the Foreman REST API</em></a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="querying-the-mcp-server-for-foreman"><a class="anchor" href="#querying-the-mcp-server-for-foreman"></a>7.4. Querying the MCP server for Foreman</h3>
<div class="paragraph _abstract">
<p>With your AI application connected to the Model Context Protocol (MCP) server for Foreman, you can use the AI application chatbot to request information about your Foreman deployment.
The AI application retrieves and processes the relevant data from the Foreman inventory.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>Always review content generated by AI before using it in production.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Foreman community provides examples of prompts and responses below.
Results in your environment and their quality might vary depending on the capabilities of the large language model (LLM) that your AI application uses.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Type a prompt into your AI application.
For example:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">Show a list of hosts that require patching.</pre>
</div>
</div>
<div class="paragraph">
<p>The AI application interprets the query and asks the MCP client to retrieve the relevant data from Foreman inventory through the MCP server.
The MCP client fetches the data and returns it to the AI application, which then processes it to provide an answer to the user.</p>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 3. Prompt examples</div>
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Querying hosts</dt>
<dd>
<div class="paragraph">
<p>To obtain a list of hosts that require patching and refine it, you can use the following prompts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">Show a list of hosts that require patching on my Foreman.</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">Categorize the list into hosts that require security patches
and hosts that require bug fix patches.</pre>
</div>
</div>
</dd>
<dt class="hdlist1">Querying subnets</dt>
<dd>
<div class="paragraph">
<p>To obtain a report of all subnets in Foreman inventory, you can use the following prompts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">Generate a static report of all subnets on my Foreman.
Read API documentation for each of the needed resources
before doing any searches.</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">For each subnet, report its name, address, network mask,
and number of hosts which are assigned to it.</pre>
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Using_Report_Templates_to_Monitor_Hosts_managing-hosts"><a class="anchor" href="#Using_Report_Templates_to_Monitor_Hosts_managing-hosts"></a>8. Using report templates to monitor hosts</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>You can use report templates to query Foreman data to obtain information about, for example, host status, registered hosts, applicable errata, applied errata, and user activity.
You can use the report templates that ship with Foreman or write your own custom report templates to suit your requirements.</p>
</div>
<div class="sect2">
<h3 id="generating-host-monitoring-reports-by-using-web-ui"><a class="anchor" href="#generating-host-monitoring-reports-by-using-web-ui"></a>8.1. Generating host monitoring reports by using Foreman web UI</h3>
<div class="paragraph _abstract">
<p>To view the report templates in the Foreman web UI, navigate to <strong>Monitor</strong> &gt; <strong>Reports</strong> &gt; <strong>Report Templates</strong>.
You can also schedule reports from the Foreman web UI.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Monitor</strong> &gt; <strong>Reports</strong> &gt; <strong>Report Templates</strong>.
For example, the <strong>Host &#8211; Installed Products</strong> template generates a report with installed product information along with other metrics, including system purpose attributes.</p>
</li>
<li>
<p>To the right of the report template that you want to use, click <strong>Generate</strong>.</p>
</li>
<li>
<p>Optional: To schedule a report, to the right of the <strong>Generate at</strong> field, click the icon to select the date and time you want to generate the report at.</p>
</li>
<li>
<p>Optional: To send a report to an e-mail address, select the <strong>Send report via e-mail</strong> checkbox, and in the <strong>Deliver to e-mail addresses</strong> field, enter the required e-mail address.</p>
</li>
<li>
<p>Optional: Apply search query filters.
To view all available results, do not populate the filter field with any values.</p>
</li>
<li>
<p>Click <strong>Submit</strong>.
A CSV file that contains the report is downloaded.
If you have selected the <strong>Send report via e-mail</strong> checkbox, the host monitoring report is sent to your e-mail address.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="generating-host-monitoring-reports-by-using-cli"><a class="anchor" href="#generating-host-monitoring-reports-by-using-cli"></a>8.2. Generating host monitoring reports by using Hammer CLI</h3>
<div class="paragraph _abstract">
<p>To view the report templates, use the <code>hammer report-template</code> command.
To schedule reports, configure a cron job.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>List all available report templates:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer report-template list</pre>
</div>
</div>
</li>
<li>
<p>Generate a report:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer report-template generate --id <em>My_Template_ID</em></pre>
</div>
</div>
<div class="paragraph">
<p>This command waits until the report fully generates before completing.
If you want to generate the report as a background task, you can use the <code>hammer report-template schedule</code> command.</p>
</div>
</li>
</ol>
</div>
<div class="exampleblock">
<div class="title">Example 4. Generating a report based on the <strong>Subscription - General</strong> template</div>
<div class="content">
<div class="paragraph">
<p>To generate the <strong>Subscription - General</strong> report, add the <code>Days from Now</code> option to specify the latest expiration time of general subscriptions.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To show all subscriptions:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer report-template generate \
--inputs "Days from Now=no limit" \
--name "Subscription - General Report"</pre>
</div>
</div>
</li>
<li>
<p>To show all subscriptions that are going to expire within 60 days:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer report-template generate \
--inputs "Days from Now=60" \
--name "Subscription - General Report"</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Creating_a_Report_Template_managing-hosts"><a class="anchor" href="#Creating_a_Report_Template_managing-hosts"></a>8.3. Creating a report template</h3>
<div class="paragraph _abstract">
<p>In Foreman, you can create a report template and customize the template to suit your requirements.
You can import existing report templates and further customize them with snippets and template macros.</p>
</div>
<div class="paragraph">
<p>Report templates use Embedded Ruby (ERB) syntax.
To view information about working with ERB syntax and macros, in the Foreman web UI, navigate to <strong>Monitor</strong> &gt; <strong>Reports</strong> &gt; <strong>Report Templates</strong>, and click <strong>Create Template</strong>, and then click the <strong>Help</strong> tab.</p>
</div>
<div class="paragraph">
<p>When you create a report template in Foreman, safe mode is enabled by default.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Monitor</strong> &gt; <strong>Reports</strong> &gt; <strong>Report Templates</strong>.</p>
</li>
<li>
<p>Click <strong>Create Template</strong>.</p>
</li>
<li>
<p>In the <strong>Name</strong> field, enter a unique name for your report template.</p>
</li>
<li>
<p>If you want the template to be available to all locations and organizations, select <strong>Default</strong>.</p>
</li>
<li>
<p>Create the template directly in the template editor or import a template from a text file by clicking <strong>Import</strong>.
For more information about importing templates, see <a href="#Importing_Report_Templates_managing-hosts">Importing report templates</a>.</p>
</li>
<li>
<p>Optional: In the <strong>Audit Comment</strong> field, you can add any useful information about this template.</p>
</li>
<li>
<p>Click the <strong>Input</strong> tab, and in the <strong>Name</strong> field, enter a name for the input that you can reference in the template in the following format: <code>input('name')</code>.
Note that you must save the template before you can reference this input value in the template body.</p>
</li>
<li>
<p>Select whether the input value is mandatory.
If the input value is mandatory, select the <strong>Required</strong> checkbox.</p>
</li>
<li>
<p>From the <strong>Value Type</strong> list, select the type of input value that the user must input.</p>
</li>
<li>
<p>Optional: If you want to use facts for template input, select the <strong>Advanced</strong> checkbox.</p>
</li>
<li>
<p>Optional: In the <strong>Options</strong> field, define the options that the user can select from.
If this field remains undefined, the users receive a free-text field in which they can enter the value they want.</p>
</li>
<li>
<p>Optional: In the <strong>Default</strong> field, enter a value, for example, a host name, that you want to set as the default template input.</p>
</li>
<li>
<p>Optional: In the <strong>Description</strong> field, you can enter information that you want to display as inline help about the input when you generate the report.</p>
</li>
<li>
<p>Optional: Click the <strong>Type</strong> tab, and select whether this template is a snippet to be included in other templates.</p>
</li>
<li>
<p>Click the <strong>Location</strong> tab and add the locations where you want to use the template.</p>
</li>
<li>
<p>Click the <strong>Organizations</strong> tab and add the organizations where you want to use the template.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to save your changes.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="#Template_Writing_Reference_managing-hosts">Template writing reference</a></p>
</li>
<li>
<p><a href="#Template_Macros_managing-hosts">Template macros</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="exporting-report-templates-by-using-web-ui"><a class="anchor" href="#exporting-report-templates-by-using-web-ui"></a>8.4. Exporting report templates by using Foreman web UI</h3>
<div class="paragraph _abstract">
<p>You can export report templates that you create in Foreman from Foreman web UI.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Monitor</strong> &gt; <strong>Reports</strong> &gt; <strong>Report Templates</strong>.</p>
</li>
<li>
<p>Locate the template that you want to export, and from the list in the <strong>Actions</strong> column, select <strong>Export</strong>.</p>
</li>
<li>
<p>Repeat this action for every report template that you want to download.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="exporting-report-templates-by-using-cli"><a class="anchor" href="#exporting-report-templates-by-using-cli"></a>8.5. Exporting report templates by using Hammer CLI</h3>
<div class="paragraph _abstract">
<p>You can export report templates that you create in Foreman by using Hammer CLI.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>To view the report templates available for export, enter the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer report-template list</pre>
</div>
</div>
<div class="paragraph">
<p>Note the template ID of the template that you want to export in the output of this command.</p>
</div>
</li>
<li>
<p>To export a report template, enter the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer report-template dump --id <em>My_Template_ID</em> &gt; <em>example_export</em>.erb</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Exporting_Report_Templates_Using_the_API_managing-hosts"><a class="anchor" href="#Exporting_Report_Templates_Using_the_API_managing-hosts"></a>8.6. Exporting report templates using the Foreman API</h3>
<div class="paragraph _abstract">
<p>You can use the Foreman <code>report_templates</code> API to export report templates from Foreman.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Use the following request to retrieve a list of available report templates.
For example:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl \
--insecure \
--user <em>My_User_Name</em>:<em>My_Password</em> \
--request GET \
--config https://<em>foreman.example.com</em>/api/report_templates \
| json_reformat</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the <code>json_reformat</code> tool is used to format the JSON output.</p>
</div>
<div class="paragraph">
<p>Example response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">{
    "total": 6,
    "subtotal": 6,
    "page": 1,
    "per_page": 20,
    "search": null,
    "sort": {
        "by": null,
        "order": null
    },
    "results": [
        {
            "created_at": "2019-11-20 17:49:52 UTC",
            "updated_at": "2019-11-20 17:49:52 UTC",
            "name": "Applicable errata",
            "id": 112
        },
        {
            "created_at": "2019-11-20 17:49:52 UTC",
            "updated_at": "2019-11-20 17:49:52 UTC",
            "name": "Applied Errata",
            "id": 113
        },
        {
            "created_at": "2019-11-30 16:15:24 UTC",
            "updated_at": "2019-11-30 16:15:24 UTC",
            "name": "Hosts - complete list",
            "id": 158
        },
        {
            "created_at": "2019-11-20 17:49:52 UTC",
            "updated_at": "2019-11-20 17:49:52 UTC",
            "name": "Host statuses",
            "id": 114
        },
        {
            "created_at": "2019-11-20 17:49:52 UTC",
            "updated_at": "2019-11-20 17:49:52 UTC",
            "name": "Registered hosts",
            "id": 115
        },
        {
            "created_at": "2019-11-20 17:49:52 UTC",
            "updated_at": "2019-11-20 17:49:52 UTC",
            "name": "Subscriptions",
            "id": 116
        }
    ]
}</pre>
</div>
</div>
</li>
<li>
<p>Note the <code>id</code> of the template that you want to export, and use the following request to export the template.</p>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl --insecure --output <em>/tmp/_Example_Export_Template</em>.erb_ \
--user <em>admin:password</em> --request GET --config \
https://<em>foreman.example.com</em>/api/report_templates/<em>My_Template_ID</em>/export</pre>
</div>
</div>
<div class="paragraph">
<p>Note that <code>158</code> is an example ID of the template to export.</p>
</div>
<div class="paragraph">
<p>In this example, the exported template is redirected to <code>host_complete_list.erb</code>.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Importing_Report_Templates_managing-hosts"><a class="anchor" href="#Importing_Report_Templates_managing-hosts"></a>8.7. Importing report templates</h3>
<div class="paragraph _abstract">
<p>You can import a report template into the body of a new template that you want to create.
Note that using the Foreman web UI, you can only import templates individually.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You must have exported templates from Foreman to import them to use in new templates.
For more information see <a href="#exporting-report-templates-by-using-web-ui">Exporting report templates by using Foreman web UI</a> and <a href="#exporting-report-templates-by-using-cli">Exporting report templates by using Hammer CLI</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Monitor</strong> &gt; <strong>Reports</strong> &gt; <strong>Report Templates</strong>.</p>
</li>
<li>
<p>In the upper right of the Report Templates window, click <strong>Create Template</strong>.</p>
</li>
<li>
<p>On the upper right of the <strong>Editor</strong> tab, click the folder icon, and select the <code>.erb</code> file that you want to import.</p>
</li>
<li>
<p>Edit the template to suit your requirements.</p>
</li>
<li>
<p>Click <strong>Submit</strong>.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="#Template_Writing_Reference_managing-hosts">Template writing reference</a></p>
</li>
<li>
<p><a href="#Importing_Report_Templates_Using_the_API_managing-hosts">Importing report templates using the Foreman API</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Importing_Report_Templates_Using_the_API_managing-hosts"><a class="anchor" href="#Importing_Report_Templates_Using_the_API_managing-hosts"></a>8.8. Importing report templates using the Foreman API</h3>
<div class="paragraph _abstract">
<p>You can use the Foreman API to import report templates into Foreman.
Importing report templates using the Foreman API automatically parses the report template metadata and assigns organizations and locations.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Create a template using <code>.erb</code> syntax or export a template from another Foreman.</p>
<div class="paragraph">
<p>For more information about writing templates, see <a href="#Template_Writing_Reference_managing-hosts">Template writing reference</a>.</p>
</div>
<div class="paragraph">
<p>For more information about exporting templates from Foreman, see <a href="#Exporting_Report_Templates_Using_the_API_managing-hosts">Exporting report templates using the Foreman API</a>.</p>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Use the following example to format the template that you want to import to a <code>.json</code> file:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># cat <em>Example_Template</em>.json
{
    "name": "<em>Example Template Name</em>",
    "template": "
    <em>Enter ERB Code Here</em>
"
}</pre>
</div>
</div>
<div class="paragraph">
<p>Example JSON file with ERB template:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
    "name": "Hosts - complete list",
    "template": "
&lt;%#
name: Hosts - complete list
snippet: false
template_inputs:
- name: host
  required: false
  input_type: user
  advanced: false
  value_type: plain
  resource_type: Katello::ActivationKey
model: ReportTemplate
-%&gt;
&lt;% load_hosts(search: input('host')).each_record do |host| -%&gt;
&lt;%
      report_row(
          'Server FQDN': host.name
      )
-%&gt;
&lt;%  end -%&gt;
&lt;%= report_render %&gt;
"
}</pre>
</div>
</div>
</li>
<li>
<p>Use the following request to import the template:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl \
--insecure \
--user <em>My_User_Name</em>:<em>My_Password</em> \
--data @<em>Example_Template</em>.json \
--header "Content-Type:application/json" \
--request POST \
--config https://<em>foreman.example.com</em>/api/report_templates/import</pre>
</div>
</div>
</li>
<li>
<p>Use the following request to retrieve a list of report templates and validate that you can view the template in Foreman:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl \
--insecure \
--user <em>My_User_Name</em>:<em>My_Password</em> \
--request GET \
--config https://<em>foreman.example.com</em>/api/report_templates | json_reformat</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Report_Template_Safe_Mode_managing-hosts"><a class="anchor" href="#Report_Template_Safe_Mode_managing-hosts"></a>8.9. Report template safe mode</h3>
<div class="paragraph _abstract">
<p>When you create report templates in Foreman, report template safe mode is enabled by default.
Safe mode helps prevent rendering problems and enforces best practices in report templates.</p>
</div>
<div class="paragraph">
<p>Report template safe mode limits the macros and variables that you can use in the report template.
The list of supported macros and variables is available in the Foreman web UI.</p>
</div>
<div class="paragraph">
<p>To view the macros and variables that are available, in the Foreman web UI, navigate to <strong>Monitor</strong> &gt; <strong>Reports</strong> &gt; <strong>Report Templates</strong> and click <strong>Create Template</strong>.
In the Create Template window, click the <strong>Help</strong> tab and expand <strong>Safe mode methods</strong>.</p>
</div>
<div class="paragraph">
<p>While safe mode is enabled, if you try to use a macro or variable that is not listed in <strong>Safe mode methods</strong>, the template editor displays an error message.</p>
</div>
<div class="paragraph">
<p>To view the status of safe mode in Foreman, in the Foreman web UI, navigate to <strong>Administer</strong> &gt; <strong>Settings</strong> and click the <strong>Provisioning</strong> tab.
Locate the <strong>Safemode rendering</strong> row to check the value.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-and-setting-up-remote-jobs"><a class="anchor" href="#configuring-and-setting-up-remote-jobs"></a>9. Configuring and setting up remote jobs</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>Foreman supports remote execution of commands on hosts.
Using remote execution, you can perform various tasks on multiple hosts simultaneously.</p>
</div>
<div class="sect2">
<h3 id="Remote-Execution-in-Foreman_managing-hosts"><a class="anchor" href="#Remote-Execution-in-Foreman_managing-hosts"></a>9.1. Remote execution in Foreman</h3>
<div class="paragraph _abstract">
<p>With remote execution, you can run jobs on hosts from Smart&#160;Proxies by using shell scripts or Ansible roles and playbooks.</p>
</div>
<div class="paragraph">
<p>Use remote execution for the following benefits in Foreman:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Run jobs on multiple hosts at once.</p>
</li>
<li>
<p>Use variables in your commands for more granular control over the jobs you run.</p>
</li>
<li>
<p>Use host facts and parameters to populate the variable values.</p>
</li>
<li>
<p>Specify custom values for templates when you run the command.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Communication for remote execution occurs through Smart&#160;Proxy&#160;server, which means that Foreman&#160;server does not require direct access to the target host, and can scale to manage many hosts.</p>
</div>
<div class="paragraph">
<p>To use remote execution, you must define a job template.
A job template is a command that you want to apply to remote hosts.
You can execute a job template multiple times.</p>
</div>
<div class="paragraph">
<p>Foreman uses ERB syntax job templates.
For more information, see <a href="#Template_Writing_Reference_managing-hosts">Template writing reference</a>.</p>
</div>
<div class="paragraph">
<p>By default, Foreman includes several job templates for shell scripts and Ansible.
For more information, see <a href="#customizing-job-templates">Customizing job templates</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="remote-execution-workflow_managing-hosts"><a class="anchor" href="#remote-execution-workflow_managing-hosts"></a>9.2. Remote execution workflow</h3>
<div class="paragraph _abstract">
<p>When you run a remote job on hosts, for every host, Foreman performs a series of actions to find a remote execution Smart&#160;Proxy to use.</p>
</div>
<div class="paragraph">
<p>For custom Ansible roles that you create, or roles that you download, you must install the package containing the roles on your Smart&#160;Proxy&#160;server.
Before you can use Ansible roles, you must import the roles into Foreman from the Smart&#160;Proxy where they are installed.</p>
</div>
<div class="paragraph">
<p>Foreman searches only for Smart&#160;Proxies that have the remote execution feature enabled.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Foreman finds the host&#8217;s interfaces that have the <strong>Remote execution</strong> checkbox selected.</p>
</li>
<li>
<p>Foreman finds the subnets of these interfaces.</p>
</li>
<li>
<p>Foreman finds remote execution Smart&#160;Proxies assigned to these subnets.</p>
</li>
<li>
<p>From this set of Smart&#160;Proxies, Foreman selects the Smart&#160;Proxy that has the least number of running jobs.
By doing this, Foreman ensures that the jobs load is balanced between remote execution Smart&#160;Proxies.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you have enabled <strong>Prefer registered through Smart&#160;Proxy for remote execution</strong>, Foreman runs the REX job by using the Smart&#160;Proxy to which the host is registered.</p>
</div>
<div class="paragraph">
<p>By default, <strong>Prefer registered through Smart&#160;Proxy for remote execution</strong> is set to <strong>No</strong>.
To enable it, in the Foreman web UI, navigate to <strong>Administer</strong> &gt; <strong>Settings</strong>, and on the <strong>Content</strong> tab, set <code>Prefer registered through Smart&#160;Proxy for remote execution</code> to <strong>Yes</strong>.
This ensures that Foreman performs REX jobs on hosts by the Smart&#160;Proxy to which they are registered to.</p>
</div>
<div class="paragraph">
<p>If Foreman does not find a remote execution Smart&#160;Proxy at this stage, and if the <strong>Fallback to Any Smart&#160;Proxy</strong> setting is enabled, Foreman adds another set of Smart&#160;Proxies to select the remote execution Smart&#160;Proxy from.
Foreman selects the most lightly loaded Smart&#160;Proxy from the following types of Smart&#160;Proxies that are assigned to the host:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>DHCP, DNS and TFTP Smart&#160;Proxies assigned to the host&#8217;s subnets</p>
</li>
<li>
<p>DNS Smart&#160;Proxy assigned to the host&#8217;s domain</p>
</li>
<li>
<p>Realm Smart&#160;Proxy assigned to the host&#8217;s realm</p>
</li>
<li>
<p>Puppet server Smart&#160;Proxy</p>
</li>
<li>
<p>Puppet CA Smart&#160;Proxy</p>
</li>
<li>
<p>OpenSCAP Smart&#160;Proxy</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If Foreman does not find a remote execution Smart&#160;Proxy at this stage, and if the <strong>Enable Global Smart&#160;Proxy</strong> setting is enabled, Foreman selects the most lightly loaded remote execution Smart&#160;Proxy from the set of all Smart&#160;Proxies in the host&#8217;s organization and location to execute a remote job.</p>
</div>
</div>
<div class="sect2">
<h3 id="permissions-for-remote-execution_managing-hosts"><a class="anchor" href="#permissions-for-remote-execution_managing-hosts"></a>9.3. Permissions for remote execution</h3>
<div class="paragraph _abstract">
<p>You can control which roles can run which jobs within your infrastructure, including which hosts they can target.</p>
</div>
<div class="paragraph">
<p>The remote execution feature provides two built-in roles:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Remote Execution Manager</strong>: Can access all remote execution features and functionality.</p>
</li>
<li>
<p><strong>Remote Execution User</strong>: Can only run jobs.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can clone the <strong>Remote Execution User</strong> role and customize its filter for increased granularity.
If you adjust the filter with the <code>view_job_templates</code> permission on a customized role, you can only see and trigger jobs based on matching job templates.
You can use the <code>view_hosts</code> and <code>view_smart_proxies</code> permissions to limit which hosts or Smart&#160;Proxies are visible to the role.</p>
</div>
<div class="paragraph">
<p>The <code>execute_template_invocation</code> permission is a special permission that is checked immediately before execution of a job begins.
This permission defines which job template you can run on a particular host.
This allows for even more granularity when specifying permissions.</p>
</div>
<div class="paragraph">
<p>You can run remote execution jobs against Foreman and Smart&#160;Proxy registered as hosts to Foreman with the <code>execute_jobs_on_infrastructure_hosts</code> permission.
Standard <strong>Manager</strong> and <strong>Site Manager</strong> roles have this permission by default.
If you use either the <strong>Manager</strong> or <strong>Site Manager</strong> role, or if you use a custom role with the <code>execute_jobs_on_infrastructure_hosts</code> permission, you can execute remote jobs against registered Foreman and Smart&#160;Proxy hosts.</p>
</div>
<div class="paragraph">
<p>For more information on working with roles and permissions, see <a href="https://docs.theforeman.org/nightly/Administering_Project/index-foreman-el.html#creating-and-managing-roles">Creating and managing roles</a> in <em>Administering Foreman</em>.</p>
</div>
<div class="paragraph">
<p>The following example shows filters for the <code>execute_template_invocation</code> permission:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">name = Reboot and host.name = staging.example.com
name = Reboot and host.name ~ *.staging.example.com
name = "Restart service" and host_group.name = webservers</pre>
</div>
</div>
<div class="paragraph">
<p>Use the first line in this example to apply the <strong>Reboot</strong> template to one selected host.
Use the second line to define a pool of hosts with names ending with <code>.staging.example.com</code>.
Use the third line to bind the template with a host group.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Permissions assigned to users with these roles can change over time.
If you have already scheduled some jobs to run in the future, and the permissions change, this can result in execution failure because permissions are checked immediately before job execution.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="transport-modes-for-remote-execution_managing-hosts"><a class="anchor" href="#transport-modes-for-remote-execution_managing-hosts"></a>9.4. Transport modes for remote execution</h3>
<div class="paragraph _abstract">
<p>You can configure your Foreman to use two different modes of transport for remote job execution.</p>
</div>
<div class="paragraph">
<p>The following transport modes are available for remote execution.
You can configure single Smart&#160;Proxy to use either one mode or the other but not both.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Push-based transport</dt>
<dd>
<p>On Smart&#160;Proxies in <code>ssh</code> mode, remote execution uses the SSH service to transport job details.
This is the default transport mode.
The SSH service must be enabled and active on the target hosts.
The remote execution Smart&#160;Proxy must have access to the SSH port on the target hosts.
Unless you have a different setting, the standard SSH port is 22.</p>
<div class="paragraph">
<p>This transport mode supports both Script and Ansible providers.</p>
</div>
</dd>
<dt class="hdlist1">Pull-based transport</dt>
<dd>
<p>On Smart&#160;Proxies in <code>pull-mqtt</code> mode, remote execution uses Message Queueing Telemetry Transport (MQTT) to initiate the job execution it receives from Foreman&#160;server.
The host subscribes to the MQTT broker on Smart&#160;Proxy for job notifications by using the <code>yggdrasil</code> pull client.
After the host receives a notification from the MQTT broker, it pulls job details from Smart&#160;Proxy over HTTPS, runs the job, and reports results back to Smart&#160;Proxy.</p>
<div class="paragraph">
<p>This transport mode supports the Script provider only.</p>
</div>
<div class="paragraph">
<p>To use the <code>pull-mqtt</code> mode, you must enable it on Smart&#160;Proxy&#160;server and configure the pull client on hosts.</p>
</div>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If your Smart&#160;Proxy already uses the <code>pull-mqtt</code> mode and you want to switch back to the <code>ssh</code> mode, run this <code>foreman-installer</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-installer --foreman-proxy-plugin-remote-execution-script-mode ssh</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="installing-the-remote-execution-plugin"><a class="anchor" href="#installing-the-remote-execution-plugin"></a>9.5. Installing the Remote Execution plugin</h3>
<div class="paragraph _abstract">
<p>You can install and enable the Remote Execution plugin to run commands and jobs on hosts.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Install the Remote Execution plugin on your Foreman&#160;server:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-installer \
--enable-foreman-plugin-remote-execution \
--enable-foreman-plugin-remote-execution-cockpit \
--enable-foreman-proxy-plugin-remote-execution-script</pre>
</div>
</div>
</li>
<li>
<p>Optional: Enable the Hammer CLI plugin on your Foreman&#160;server:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-installer \
--enable-foreman-cli-remote-execution</pre>
</div>
</div>
</li>
<li>
<p>Optional: Install the Remote Execution plugin on your Smart&#160;Proxy&#160;servers:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-installer \
--enable-foreman-proxy-plugin-remote-execution-script</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="creating-a-job-template-by-using-web-ui"><a class="anchor" href="#creating-a-job-template-by-using-web-ui"></a>9.6. Creating a job template by using Foreman web UI</h3>
<div class="paragraph _abstract">
<p>Use this procedure to create a job template from the Foreman web UI.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Job templates</strong>.</p>
</li>
<li>
<p>Click <strong>New Job Template</strong>.</p>
</li>
<li>
<p>Click the <strong>Template</strong> tab, and in the <strong>Name</strong> field, enter a unique name for your job template.</p>
</li>
<li>
<p>Select <strong>Default</strong> to make the template available for all organizations and locations.</p>
</li>
<li>
<p>Create the template directly in the template editor or upload it from a text file by clicking <strong>Import</strong>.</p>
</li>
<li>
<p>Optional: In the <strong>Audit Comment</strong> field, add information about the change.</p>
</li>
<li>
<p>Click the <strong>Job</strong> tab, and in the <strong>Job category</strong> field, enter your own category or select from the default categories.</p>
</li>
<li>
<p>Optional: In the <strong>Description Format</strong> field, enter a description template.
For example, <code>Install package %{package_name}</code>.
You can also use <code>%{template_name}</code> and <code>%{job_category}</code> in your template.</p>
</li>
<li>
<p>From the <strong>Provider Type</strong> list, select <strong>SSH</strong> for shell scripts and <strong>Ansible</strong> for Ansible tasks or playbooks.</p>
</li>
<li>
<p>Optional: In the <strong>Timeout to kill</strong> field, enter a timeout value to terminate the job if it does not complete.</p>
</li>
<li>
<p>Optional: Click <strong>Add Input</strong> to define an input parameter.
Parameters are requested when executing the job and do not have to be defined in the template.
For examples, see the <strong>Help</strong> tab.</p>
</li>
<li>
<p>Optional: Click <strong>Foreign input set</strong> to include other templates in this job.</p>
</li>
<li>
<p>Optional: In the <strong>Effective user</strong> area, configure a user if the command cannot use the default <code>remote_execution_effective_user</code> setting.</p>
</li>
<li>
<p>Optional: If this template is a snippet to be included in other templates, click the <strong>Type</strong> tab and select <strong>Snippet</strong>.</p>
</li>
<li>
<p>Optional: If you use the Ansible provider, click the <strong>Ansible</strong> tab.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Select <strong>Enable Ansible Callback</strong> to allow hosts to send facts, which are used to create configuration reports, back to Foreman after a job finishes.</p>
</li>
<li>
<p>Select <strong>Enable Ansible Check Mode</strong> to run jobs based on the template in Ansible check mode, which executes Ansible playbooks without making changes to hosts.
For more information on Ansible check mode, see <a href="https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_checkmode.html">Validating tasks: check mode and diff mode</a> in <em>Ansible Documentation</em>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Click the <strong>Location</strong> tab and add the locations where you want to use the template.</p>
</li>
<li>
<p>Click the <strong>Organizations</strong> tab and add the organizations where you want to use the template.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to save your changes.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://docs.theforeman.org/nightly/Managing_Hosts/index-foreman-el.html#Template_Writing_Reference_managing-hosts">Template writing reference</a></p>
</li>
<li>
<p><a href="https://docs.theforeman.org/nightly/Managing_Hosts/index-foreman-el.html#Job_Template_Examples_and_Extensions_managing-hosts">Job template examples and extensions in <em>Managing hosts</em></a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="creating-a-job-template-by-using-cli"><a class="anchor" href="#creating-a-job-template-by-using-cli"></a>9.7. Creating a job template by using Hammer CLI</h3>
<div class="paragraph _abstract">
<p>Use this procedure to create a job template by using Hammer CLI.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Create a job template using a template-definition file:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer job-template create \
--file "<em>Path_to_My_Template_File</em>" \
--job-category "<em>My_Category_Name</em>" \
--name "<em>My_Template_Name</em>" \
--provider-type SSH</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://docs.theforeman.org/nightly/Managing_Hosts/index-foreman-el.html#Template_Writing_Reference_managing-hosts">Template writing reference</a></p>
</li>
<li>
<p><a href="https://docs.theforeman.org/nightly/Managing_Hosts/index-foreman-el.html#Job_Template_Examples_and_Extensions_managing-hosts">Job template examples and extensions in <em>Managing hosts</em></a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="importing-an-ansible-playbook-by-name_managing-hosts"><a class="anchor" href="#importing-an-ansible-playbook-by-name_managing-hosts"></a>9.8. Importing an Ansible Playbook by name</h3>
<div class="paragraph _abstract">
<p>You can import Ansible Playbooks by name to Foreman from collections installed on Smart&#160;Proxy.</p>
</div>
<div class="paragraph">
<p>When you import an Ansible Playbook, Foreman creates a job template from the imported playbook and places the template in the <code>Ansible Playbook - Imported</code> job category.
If you have a custom collection, place it in <code>/etc/ansible/collections/ansible_collections/<em>My_Namespace</em>/<em>My_Collection</em></code>.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Ansible plugin is enabled.</p>
</li>
<li>
<p>Your Foreman account has a role that grants the <code>import_ansible_playbooks</code> permission.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Fetch the available Ansible Playbooks by using the following API request:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl \
--header 'Content-Type: application/json' \
--request GET \
https://<em>foreman.example.com</em>/ansible/api/v2/ansible_playbooks/fetch?proxy_id=<em>My_Smart_Proxy_ID</em></pre>
</div>
</div>
</li>
<li>
<p>Select the Ansible Playbook you want to import and note its name.</p>
</li>
<li>
<p>Import the Ansible Playbook by its name:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl \
--data '{ "playbook_names": ["<em>My_Playbook_Name</em>"] }' \
--header 'Content-Type: application/json' \
--request PUT \
https://<em>foreman.example.com</em>/ansible/api/v2/ansible_playbooks/sync?proxy_id=<em>My_Smart_Proxy_ID</em></pre>
</div>
</div>
<div class="paragraph">
<p>You get a notification in the Foreman web UI after the import completes.</p>
</div>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Next steps</div>
<ul>
<li>
<p>You can run the playbook by executing a remote job from the created job template.
For more information, see <a href="#configuring-and-setting-up-remote-jobs">Configuring and setting up remote jobs</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="importing-all-available-ansible-playbooks_managing-hosts"><a class="anchor" href="#importing-all-available-ansible-playbooks_managing-hosts"></a>9.9. Importing all available Ansible Playbooks</h3>
<div class="paragraph _abstract">
<p>You can import all the available Ansible Playbooks to Foreman from collections installed on Smart&#160;Proxy.</p>
</div>
<div class="paragraph">
<p>When you import an Ansible Playbook, Foreman creates job templates from the imported playbooks and places the templates in the <code>Ansible Playbook - Imported</code> job category.
If you have a custom collection, place it in <code>/etc/ansible/collections/ansible_collections/<em>My_Namespace</em>/<em>My_Collection</em></code>.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Ansible plugin is enabled.</p>
</li>
<li>
<p>Your Foreman account has a role that grants the <code>import_ansible_playbooks</code> permission.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Import the Ansible Playbooks by using the following API request:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># curl -X PUT -H 'Content-Type: application/json' https://<em>foreman.example.com</em>/ansible/api/v2/ansible_playbooks/sync?proxy_id=<em>My_Smart_Proxy_ID</em></pre>
</div>
</div>
<div class="paragraph">
<p>You get a notification in the Foreman web UI after the import completes.</p>
</div>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Next steps</div>
<ul>
<li>
<p>You can run the playbooks by executing a remote job from the created job templates.
For more information, see <a href="#configuring-and-setting-up-remote-jobs">Configuring and setting up remote jobs</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="configuring-the-fallback-to-any-smart-proxy-remote-execution-setting-by-using-web-ui"><a class="anchor" href="#configuring-the-fallback-to-any-smart-proxy-remote-execution-setting-by-using-web-ui"></a>9.10. Configuring the fallback to any Smart&#160;Proxy remote execution setting by using Foreman web UI</h3>
<div class="paragraph _abstract">
<p>You can enable the <strong>Fallback to Any Smart&#160;Proxy</strong> setting to configure Foreman to search for remote execution Smart&#160;Proxies from the list of Smart&#160;Proxies that are assigned to hosts.
This can be useful if you need to run remote jobs on hosts that have no subnets configured or if the subnets of the hosts are assigned to Smart&#160;Proxies that do not have the remote execution feature enabled.</p>
</div>
<div class="paragraph">
<p>If the <strong>Fallback to Any Smart&#160;Proxy</strong> setting is enabled, Foreman adds another set of Smart&#160;Proxies to select the remote execution Smart&#160;Proxy from.
Foreman also selects the most lightly loaded Smart&#160;Proxy from the set of all Smart&#160;Proxies assigned to the host, such as the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>DHCP, DNS and TFTP Smart&#160;Proxies assigned to the subnets of the hosts</p>
</li>
<li>
<p>DNS Smart&#160;Proxy assigned to the host domain</p>
</li>
<li>
<p>Realm Smart&#160;Proxy assigned to the host realm</p>
</li>
<li>
<p>Puppet server Smart&#160;Proxy</p>
</li>
<li>
<p>Puppet CA Smart&#160;Proxy</p>
</li>
<li>
<p>OpenSCAP Smart&#160;Proxy</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Administer</strong> &gt; <strong>Settings</strong>.</p>
</li>
<li>
<p>Click <strong>Remote Execution</strong>.</p>
</li>
<li>
<p>Configure the <strong>Fallback to Any Smart&#160;Proxy</strong> setting.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="configuring-the-fallback-to-any-smart-proxy-remote-execution-setting-by-using-cli"><a class="anchor" href="#configuring-the-fallback-to-any-smart-proxy-remote-execution-setting-by-using-cli"></a>9.11. Configuring the fallback to any Smart&#160;Proxy remote execution setting by using Hammer CLI</h3>
<div class="paragraph _abstract">
<p>You can enable the <strong>Fallback to Any Smart&#160;Proxy</strong> setting to configure Foreman to search for remote execution Smart&#160;Proxies from the list of Smart&#160;Proxies that are assigned to hosts.
This can be useful if you need to run remote jobs on hosts that have no subnets configured or if the subnets of the hosts are assigned to Smart&#160;Proxies that do not have the remote execution feature enabled.</p>
</div>
<div class="paragraph">
<p>If the <strong>Fallback to Any Smart&#160;Proxy</strong> setting is enabled, Foreman adds another set of Smart&#160;Proxies to select the remote execution Smart&#160;Proxy from.
Foreman also selects the most lightly loaded Smart&#160;Proxy from the set of all Smart&#160;Proxies assigned to the host, such as the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>DHCP, DNS and TFTP Smart&#160;Proxies assigned to the host&#8217;s subnets</p>
</li>
<li>
<p>DNS Smart&#160;Proxy assigned to the host&#8217;s domain</p>
</li>
<li>
<p>Realm Smart&#160;Proxy assigned to the host&#8217;s realm</p>
</li>
<li>
<p>Puppet server Smart&#160;Proxy</p>
</li>
<li>
<p>Puppet CA Smart&#160;Proxy</p>
</li>
<li>
<p>OpenSCAP Smart&#160;Proxy</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Configure the <strong>Fallback to Any Smart&#160;Proxy</strong> setting:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer settings set \
--name remote_execution_fallback_proxy \
--value true</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="configuring-the-global-smart-proxy-remote-execution-setting-by-using-web-ui"><a class="anchor" href="#configuring-the-global-smart-proxy-remote-execution-setting-by-using-web-ui"></a>9.12. Configuring the global Smart&#160;Proxy remote execution setting by using Foreman web UI</h3>
<div class="paragraph _abstract">
<p>By default, Foreman searches for remote execution Smart&#160;Proxies in hosts' organizations and locations regardless of whether Smart&#160;Proxies are assigned to hosts' subnets or not.
You can disable the <strong>Enable Global Smart&#160;Proxy</strong> setting if you want to limit the search to the Smart&#160;Proxies that are assigned to hosts' subnets.</p>
</div>
<div class="paragraph">
<p>If the <strong>Enable Global Smart&#160;Proxy</strong> setting is enabled, Foreman adds another set of Smart&#160;Proxies to select the remote execution Smart&#160;Proxy from.
Foreman also selects the most lightly loaded remote execution Smart&#160;Proxy from the set of all Smart&#160;Proxies in the host&#8217;s organization and location to execute a remote job.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Administer</strong> &gt; <strong>Settings</strong>.</p>
</li>
<li>
<p>Click <strong>Remote Execution</strong>.</p>
</li>
<li>
<p>Configure the <strong>Enable Global Smart&#160;Proxy</strong> setting.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="configuring-the-global-smart-proxy-remote-execution-setting-by-using-cli"><a class="anchor" href="#configuring-the-global-smart-proxy-remote-execution-setting-by-using-cli"></a>9.13. Configuring the global Smart&#160;Proxy remote execution setting by using Hammer CLI</h3>
<div class="paragraph _abstract">
<p>By default, Foreman searches for remote execution Smart&#160;Proxies in hosts' organizations and locations regardless of whether Smart&#160;Proxies are assigned to hosts' subnets or not.
You can disable the <strong>Enable Global Smart&#160;Proxy</strong> setting if you want to limit the search to the Smart&#160;Proxies that are assigned to hosts' subnets.</p>
</div>
<div class="paragraph">
<p>If the <strong>Enable Global Smart&#160;Proxy</strong> setting is enabled, Foreman adds another set of Smart&#160;Proxies to select the remote execution Smart&#160;Proxy from.
Foreman also selects the most lightly loaded remote execution Smart&#160;Proxy from the set of all Smart&#160;Proxies in the host&#8217;s organization and location to execute a remote job.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Enter the <code>hammer settings set</code> command on Foreman to configure the <code>Enable Global Smart&#160;Proxy</code> setting.
To set the value to <code>true</code>, enter the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer settings set \
--name remote_execution_global_proxy \
--value true</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="setting-an-alternative-directory-for-remote-execution-jobs-in-push-mode_managing-hosts"><a class="anchor" href="#setting-an-alternative-directory-for-remote-execution-jobs-in-push-mode_managing-hosts"></a>9.14. Setting an alternative directory for remote execution jobs in push mode</h3>
<div class="paragraph _abstract">
<p>By default, Foreman uses the <code>/var/tmp</code> directory on hosts for remote execution jobs in push mode.
If the <code>/var/tmp</code> directory on your host is mounted with the <code>noexec</code> flag, Foreman cannot execute remote execution job scripts in this directory.
You can use <code>foreman-installer</code> to set an alternative directory for executing remote execution jobs in push mode.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>On your host, create a new directory:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># mkdir <em>/My_Remote_Working_Directory</em></pre>
</div>
</div>
</li>
<li>
<p>Copy the SELinux context from the default <code>/var/tmp</code> directory:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># chcon --reference=/var/tmp <em>/My_Remote_Working_Directory</em></pre>
</div>
</div>
</li>
<li>
<p>Configure your Foreman&#160;server or Smart&#160;Proxy&#160;server to use the new directory:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-installer \
--foreman-proxy-plugin-remote-execution-script-remote-working-dir <em>/My_Remote_Working_Directory</em></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="setting-an-alternative-directory-for-remote-execution-jobs-in-pull-mode_managing-hosts"><a class="anchor" href="#setting-an-alternative-directory-for-remote-execution-jobs-in-pull-mode_managing-hosts"></a>9.15. Setting an alternative directory for remote execution jobs in pull mode</h3>
<div class="paragraph _abstract">
<p>By default, Foreman uses the <code>/run</code> directory on hosts for remote execution jobs in pull mode.
If the <code>/run</code> directory on your host is mounted with the <code>noexec</code> flag, Foreman cannot execute remote execution job scripts in this directory.
You can use the Yggdrasil service to set an alternative directory for executing remote execution jobs in pull mode.</p>
</div>
<div class="ulist">
<div class="title">Prerequisite</div>
<ul>
<li>
<p>Determine which version of the <code>yggdrasil</code> package is installed on the host:</p>
<div class="ulist">
<ul>
<li>
<p>On Enterprise Linux and SUSE Linux Enterprise Server hosts:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ rpm --query yggdrasil</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create a new directory:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># mkdir <em>/My_Remote_Working_Directory</em></pre>
</div>
</div>
</li>
<li>
<p>Access the Yggdrasil service configuration:</p>
<div class="ulist">
<ul>
<li>
<p>If your host has <code>yggdrasil</code> version 0.4.z or later installed:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl edit com.redhat.Yggdrasil1.Worker1.foreman</pre>
</div>
</div>
</li>
<li>
<p>If your host has <code>yggdrasil</code> version 0.2.z or earlier installed:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl edit yggdrasild</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Specify the alternative directory by adding the following line to the configuration:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">Environment=FOREMAN_YGG_WORKER_WORKDIR=<em>/My_Remote_Working_Directory</em></pre>
</div>
</div>
</li>
<li>
<p>Restart the Yggdrasil services:</p>
<div class="ulist">
<ul>
<li>
<p>If your host has <code>yggdrasil</code> version 0.4.z or later installed:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl restart yggdrasil com.redhat.Yggdrasil1.Worker1.foreman</pre>
</div>
</div>
</li>
<li>
<p>If your host has <code>yggdrasil</code> version 0.2.z or earlier installed:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl restart yggdrasild</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="altering-the-privilege-elevation-method_managing-hosts"><a class="anchor" href="#altering-the-privilege-elevation-method_managing-hosts"></a>9.16. Altering the privilege elevation method</h3>
<div class="paragraph _abstract">
<p>By default, push-based remote execution uses <code>sudo</code> to switch from the SSH user to the effective user that executes the script on your host.
In some situations, you might require to use another method, such as <code>su</code> or <code>dzdo</code>.
You can globally configure an alternative method in your Foreman settings.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Your user account has a role assigned that grants the <code>view_settings</code> and <code>edit_settings</code> permissions.</p>
</li>
<li>
<p>If you want to use <code>dzdo</code> for Ansible jobs, ensure the <code>community.general</code> Ansible collection, which contains the required <strong>dzdo</strong> become plugin, is installed.
For more information, see <a href="https://docs.ansible.com/ansible/latest/collections_guide/collections_installing.html">Installing collections</a> in <em>Ansible documentation</em>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to <strong>Administer</strong> &gt; <strong>Settings</strong>.</p>
</li>
<li>
<p>Select the <strong>Remote Execution</strong> tab.</p>
</li>
<li>
<p>Click the value of the <strong>Effective User Method</strong> setting.</p>
</li>
<li>
<p>Select the new value.</p>
</li>
<li>
<p>Click <strong>Submit</strong>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Distributing_SSH_Keys_for_Remote_Execution_managing-hosts"><a class="anchor" href="#Distributing_SSH_Keys_for_Remote_Execution_managing-hosts"></a>9.17. Distributing SSH keys for remote execution</h3>
<div class="paragraph _abstract">
<p>For Smart&#160;Proxies in <code>ssh</code> mode, remote execution connections are authenticated using SSH.
The public SSH key from Smart&#160;Proxy must be distributed to its attached hosts that you want to manage.</p>
</div>
<div class="paragraph">
<p>Ensure that the SSH service is enabled and running on the hosts.
Configure any network or host-based firewalls to enable access to port 22.</p>
</div>
<div class="paragraph">
<p>Use one of the following methods to distribute the public SSH key from Smart&#160;Proxy to target hosts:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#distributing-ssh-keys-for-remote-execution-manually_managing-hosts">Distributing SSH keys for remote execution manually</a>.</p>
</li>
<li>
<p><a href="#Using_the_foreman_API_to_Obtain_SSH_Keys_for_Remote_Execution_managing-hosts">Using the Foreman API to obtain SSH keys for remote execution</a>.</p>
</li>
<li>
<p><a href="#Configuring_a_Kickstart_Template_to_Distribute_SSH_Keys_During_Provisioning_managing-hosts">Configuring a Kickstart template to distribute SSH keys during provisioning</a>.</p>
</li>
<li>
<p>For new Foreman hosts, you can deploy SSH keys to Foreman hosts during registration using the global registration template.
For more information, see <a href="https://docs.theforeman.org/nightly/Managing_Hosts/index-foreman-el.html#Registering_Hosts_by_Using_Global_Registration_managing-hosts">Registering hosts by using global registration</a> in <em>Managing hosts</em>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Foreman distributes SSH keys for the remote execution feature to the hosts provisioned from Foreman by default.</p>
</div>
<div class="paragraph">
<p>If the hosts are running on Amazon Web Services, enable password authentication.
For more information, see <a href="https://aws.amazon.com/premiumsupport/knowledge-center/new-user-accounts-linux-instance">New User Accounts</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="adding-foreman-server-ssh-key-to-authorized-keys"><a class="anchor" href="#adding-foreman-server-ssh-key-to-authorized-keys"></a>9.18. Adding Foreman&#160;server SSH key to authorized keys</h3>
<div class="paragraph _abstract">
<p>If you want to run remote execution jobs on Foreman&#160;server itself, add the following SSH key to authorized keys on your Foreman&#160;server.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You can access your Foreman&#160;server by using SSH as root.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>If the <code>~root/.ssh/authorized_keys</code> file does not exist, create it with restrictive ownership and permissions:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If the <code>~root/.ssh</code> directory does not exist, create it:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># mkdir ~root/.ssh</pre>
</div>
</div>
</li>
<li>
<p>Ensure that the directory is owned by the <code>root</code> user:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># chown root:root ~root/.ssh</pre>
</div>
</div>
</li>
<li>
<p>Ensure that the directory is accessible only to the <code>root</code> user:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># chmod 700 ~root/.ssh</pre>
</div>
</div>
</li>
<li>
<p>Create the <code>authorized_keys</code> file:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># touch ~root/.ssh/authorized_keys</pre>
</div>
</div>
</li>
<li>
<p>Ensure that the <code>authorized_keys</code> file is owned by the <code>root</code> user:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># chown root:root ~root/.ssh/authorized_keys</pre>
</div>
</div>
</li>
<li>
<p>Ensure that the <code>authorized_keys</code> file is accessible only to the <code>root</code> user:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># chmod 600 ~root/.ssh/authorized_keys</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Add the SSH key of the <code>foreman-proxy</code> user to the <code>authorized_keys</code> file:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># cat ~foreman-proxy/.ssh/id_rsa_foreman_proxy.pub &gt;&gt;~root/.ssh/authorized_keys</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="distributing-ssh-keys-for-remote-execution-manually_managing-hosts"><a class="anchor" href="#distributing-ssh-keys-for-remote-execution-manually_managing-hosts"></a>9.19. Distributing SSH keys for remote execution manually</h3>
<div class="paragraph _abstract">
<p>You can distribute SSH keys for remote execution manually.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Copy the SSH pub key from your Smart&#160;Proxy to your target host:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># ssh-copy-id -i ~foreman-proxy/.ssh/id_rsa_foreman_proxy.pub <em>root@client.example.com</em></pre>
</div>
</div>
<div class="paragraph">
<p>Repeat this step for each target host you want to manage.</p>
</div>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Verification</div>
<ul>
<li>
<p>On your Smart&#160;Proxy, confirm that the key was successfully copied to the target host:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># ssh -i ~foreman-proxy/.ssh/id_rsa_foreman_proxy <em>root@client.example.com</em></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="adding-a-passphrase-to-ssh-key-used-for-remote-execution_managing-hosts"><a class="anchor" href="#adding-a-passphrase-to-ssh-key-used-for-remote-execution_managing-hosts"></a>9.20. Adding a passphrase to SSH key used for remote execution</h3>
<div class="paragraph _abstract">
<p>By default, Smart&#160;Proxy uses a non-passphrase protected SSH key to execute remote jobs on hosts.
You can protect the SSH key with a passphrase by following this procedure.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>On your Foreman&#160;server or Smart&#160;Proxy&#160;server, use <code>ssh-keygen</code> to add a passphrase to your SSH key:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># ssh-keygen -p -f ~foreman-proxy/.ssh/id_rsa_foreman_proxy</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Next steps</div>
<ul>
<li>
<p>Users now must use a passphrase when running remote execution jobs on hosts.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Using_the_foreman_API_to_Obtain_SSH_Keys_for_Remote_Execution_managing-hosts"><a class="anchor" href="#Using_the_foreman_API_to_Obtain_SSH_Keys_for_Remote_Execution_managing-hosts"></a>9.21. Using the Foreman API to obtain SSH keys for remote execution</h3>
<div class="paragraph _abstract">
<p>To use the Foreman API to download the public key from Smart&#160;Proxy, complete this procedure on each target host.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>On the target host, create the <code>~/.ssh</code> directory to store the SSH key:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># mkdir ~/.ssh</pre>
</div>
</div>
</li>
<li>
<p>Download the SSH key from Smart&#160;Proxy:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># curl https://<em>smartproxy.example.com</em>:8443/ssh/pubkey &gt;&gt; ~/.ssh/authorized_keys</pre>
</div>
</div>
</li>
<li>
<p>Configure permissions for the <code>~/.ssh</code> directory:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># chmod 700 ~/.ssh</pre>
</div>
</div>
</li>
<li>
<p>Configure permissions for the <code>authorized_keys</code> file:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># chmod 600 ~/.ssh/authorized_keys</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Configuring_a_AutoYaST_Template_to_Distribute_SSH_Keys_During_Provisioning_managing-hosts"><a class="anchor" href="#Configuring_a_AutoYaST_Template_to_Distribute_SSH_Keys_During_Provisioning_managing-hosts"></a>9.22. Configuring a AutoYaST template to distribute SSH keys during provisioning</h3>
<div class="paragraph _abstract">
<p>You can add a <code>remote_execution_ssh_keys</code> snippet to your custom AutoYaST template to deploy SSH keys to hosts during provisioning.
AutoYaST templates that Foreman ships include this snippet by default.
Foreman copies the SSH key for remote execution to the systems during provisioning.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>To include the public key in newly-provisioned hosts, add the following snippet to the AutoYaST template that you use:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">&lt;%= snippet 'remote_execution_ssh_keys' %&gt;</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Configuring_a_Kickstart_Template_to_Distribute_SSH_Keys_During_Provisioning_managing-hosts"><a class="anchor" href="#Configuring_a_Kickstart_Template_to_Distribute_SSH_Keys_During_Provisioning_managing-hosts"></a>9.23. Configuring a Kickstart template to distribute SSH keys during provisioning</h3>
<div class="paragraph _abstract">
<p>You can add a <code>remote_execution_ssh_keys</code> snippet to your custom Kickstart template to deploy SSH keys to hosts during provisioning.
Kickstart templates that Foreman ships include this snippet by default.
Foreman copies the SSH key for remote execution to the systems during provisioning.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>To include the public key in newly-provisioned hosts, add the following snippet to the Kickstart template that you use:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">&lt;%= snippet 'remote_execution_ssh_keys' %&gt;</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Configuring_a_Preseed_Template_to_Distribute_SSH_Keys_During_Provisioning_managing-hosts"><a class="anchor" href="#Configuring_a_Preseed_Template_to_Distribute_SSH_Keys_During_Provisioning_managing-hosts"></a>9.24. Configuring a Preseed template to distribute SSH keys during provisioning</h3>
<div class="paragraph _abstract">
<p>You can add a <code>remote_execution_ssh_keys</code> snippet to your custom Preseed template to deploy SSH keys to hosts during provisioning.
Preseed templates that Foreman ships include this snippet by default.
Foreman copies the SSH key for remote execution to the systems during provisioning.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>To include the public key in newly-provisioned hosts, add the following snippet to the Preseed template that you use:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">&lt;%= snippet 'remote_execution_ssh_keys' %&gt;</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="configuring-smart-proxy-and-hosts-to-authenticate-with-ssh-certificates-during-remote-execution"><a class="anchor" href="#configuring-smart-proxy-and-hosts-to-authenticate-with-ssh-certificates-during-remote-execution"></a>9.25. Configuring Smart&#160;Proxy and hosts to authenticate with SSH certificates during remote execution</h3>
<div class="paragraph _abstract">
<p>By default, Foreman follows the Trust on First Use (TOFU) model when establishing a remote execution connection.
You can reconfigure your Smart&#160;Proxy to use SSH certificates instead.
SSH certificates are signed by a Certificate Authority (CA), which allows centralized trust management and revocation capabilities.</p>
</div>
<div class="paragraph">
<p>You can configure SSH certificate authentication in the following ways.
You can configure one or both of these authentication methods depending on your security requirements:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Using user certificates</dt>
<dd>
<p>When your Smart&#160;Proxy connects to hosts, it presents a signed certificate.
Hosts trust the CA that signed the certificate, eliminating the need to distribute individual SSH public keys to each host.</p>
</dd>
<dt class="hdlist1">Using host certificates</dt>
<dd>
<p>When your Smart&#160;Proxy connects to hosts, the hosts present signed certificates.
Smart&#160;Proxy verifies that it is connecting to legitimate hosts, helping prevent man-in-the-middle attacks.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>If you configure Smart&#160;Proxy to use SSH certificates, the configuration will apply to running Ansible jobs as well.</p>
</div>
<div class="sect3">
<h4 id="enabling-ssh-certificate-authentication-on-smart-proxy"><a class="anchor" href="#enabling-ssh-certificate-authentication-on-smart-proxy"></a>9.25.1. Enabling SSH certificate authentication on Smart&#160;Proxy</h4>
<div class="paragraph _abstract">
<p>You can configure Smart&#160;Proxy to present an SSH certificate signed by a Certificate Authority (CA) to hosts instead of a plain SSH public key.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>After enabling this feature, SSH certificate authentication works on all newly registered or provisioned hosts.
Existing hosts will continue to trust plain SSH keys of your Smart&#160;Proxy until you configure those hosts to trust the CA.
To configure existing hosts to accept the SSH certificate from your Smart&#160;Proxy, complete <a href="#configuring-registered-hosts-to-accept-ssh-certificate-from-smart-proxy">Configuring registered hosts to accept an SSH certificate from Smart&#160;Proxy</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have a CA for signing SSH certificates.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>On the Smart&#160;Proxy&#160;server, locate the SSH key pair that Smart&#160;Proxy uses for remote execution.
You can find the private key location in <code>/etc/foreman-proxy/settings.d/remote_execution_ssh.yml</code> under the <code>:ssh_identity_key_file:</code> setting.
By default, the location is <code>/var/lib/foreman-proxy/ssh/id_rsa_foreman_proxy</code>.</p>
</li>
<li>
<p>If the CA is on a different server than your Smart&#160;Proxy&#160;server, copy the public key file of the Smart&#160;Proxy to the CA server.</p>
</li>
<li>
<p>Sign the Smart&#160;Proxy SSH public key with your CA.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>ssh-keygen</code> command creates the certificate file with the name <code><em>My_Smart_Proxy_Private_Key</em>-cert.pub</code>.
Do not change the name of the file.
By default, the created SSH certificate is named <code>id_rsa_foreman_proxy-cert.pub</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>If the CA is on a different server than your Smart&#160;Proxy&#160;server, ensure the Smart&#160;Proxy&#160;server has the SSH certificate and the CA public key file:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Copy the created SSH certificate file back to the Smart&#160;Proxy&#160;server into the same directory as the original SSH key pair.</p>
</li>
<li>
<p>Copy the CA public key file to the Smart&#160;Proxy&#160;server.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>By default, the <code>foreman-proxy</code> user has read access to the CA public key file.
Do not store the file in non-standard directories so that the <code>foreman-proxy</code> user can read the file.
Foreman community recommends storing the file in the <code>/etc/ssh/</code> directory.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Enable SSH certificate authentication on your Smart&#160;Proxy:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-installer \
--foreman-proxy-plugin-remote-execution-script-ssh-user-ca-public-key-file <em>My_CA_Public_Key_File_Path</em></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Verification</div>
<ol class="arabic">
<li>
<p>Run a remote execution job on a host through your Smart&#160;Proxy with SSH certificate authentication enabled.</p>
</li>
<li>
<p>On the host, view the <code>sshd</code> logs:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># journalctl -u sshd</pre>
</div>
</div>
</li>
<li>
<p>Find the log message that confirms that the SSH certificate was used for authentication:</p>
<div class="listingblock">
<div class="content">
<pre>Accepted publickey for &lt;SSH USER&gt; from &lt;IP&gt; port 22 ssh2: RSA-CERT ID foreman-proxy CA RSA</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="disabling-ssh-certificate-authentication-on-smart-proxy"><a class="anchor" href="#disabling-ssh-certificate-authentication-on-smart-proxy"></a>9.25.2. Disabling SSH certificate authentication on Smart&#160;Proxy</h4>
<div class="paragraph _abstract">
<p>If you disable SSH certificate authentication on Smart&#160;Proxy, you will revert to plain SSH key pair authentication.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Distribute your Smart&#160;Proxy SSH keys to the hosts that use your Smart&#160;Proxy for remote execution.
For more information, see <a href="#Distributing_SSH_Keys_for_Remote_Execution_managing-hosts">Distributing SSH keys for remote execution</a>.</p>
</li>
<li>
<p>Delete the SSH certificate file of the Smart&#160;Proxy.
By default, the path of this file is <code>/var/lib/foreman-proxy/ssh/id_rsa_foreman_proxy-cert.pub</code>.</p>
</li>
<li>
<p>Disable the SSH certificate authentication:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-installer \
--reset-foreman-proxy-plugin-remote-execution-script-ssh-user-ca-public-key-file</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="rotating-smart-proxy-ssh-certificate"><a class="anchor" href="#rotating-smart-proxy-ssh-certificate"></a>9.25.3. Rotating Smart&#160;Proxy SSH certificate</h4>
<div class="paragraph _abstract">
<p>You can rotate the SSH certificate used by Smart&#160;Proxy for remote execution by generating a new SSH key pair and having it signed by your configured CA.
For example, this is useful if the SSH certificate used by Smart&#160;Proxy for remote execution is no longer valid.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have SSH certificate authentication enabled on Smart&#160;Proxy.</p>
</li>
<li>
<p>You have a configured CA for signing SSH certificates.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>On the Smart&#160;Proxy&#160;server, locate the directory that Smart&#160;Proxy uses for remote execution by checking where the configured Smart&#160;Proxy SSH private key is stored.
You can find the location of the SSH private key in <code>/etc/foreman-proxy/settings.d/remote_execution_ssh.yml</code> under the <code>:ssh_identity_key_file:</code> setting.
By default, the directory is <code>/var/lib/foreman-proxy/ssh/</code>.</p>
</li>
<li>
<p>On the Smart&#160;Proxy&#160;server, generate a new SSH key pair in the directory:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># ssh-keygen -f <em>My_Smart_Proxy_SSH_Directory</em>/<em>My_New_SSH_Key</em></pre>
</div>
</div>
</li>
<li>
<p>Set the correct ownership for the new key files:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># chown foreman-proxy:foreman-proxy <em>My_Smart_Proxy_SSH_Directory</em>/<em>My_New_SSH_Key</em>*</pre>
</div>
</div>
</li>
<li>
<p>If the CA is on a different server than your Smart&#160;Proxy&#160;server, copy the new public key file to the CA server.</p>
</li>
<li>
<p>Sign the new SSH public key with your CA.</p>
</li>
<li>
<p>If the CA is on a different server than your Smart&#160;Proxy&#160;server, copy the created SSH certificate file back to the Smart&#160;Proxy&#160;server into the Smart&#160;Proxy SSH directory.</p>
</li>
<li>
<p>Set the correct ownership for the certificate file:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># chown foreman-proxy:foreman-proxy <em>My_Smart_Proxy_SSH_Directory</em>/<em>My_New_SSH_Key</em>-cert.pub</pre>
</div>
</div>
</li>
<li>
<p>Configure Smart&#160;Proxy to use the new SSH key:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-installer \
--foreman-proxy-plugin-remote-execution-script-ssh-identity-file <em>My_Smart_Proxy_SSH_Directory</em>/<em>My_New_SSH_Key</em></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If you created the new SSH key pair with the same name as the old one and thus replaced the old key pair, you do not need to update your Smart&#160;Proxy configuration with foreman-installer.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Optional: Remove the old SSH key files from the Smart&#160;Proxy SSH directory.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Verification</div>
<ol class="arabic">
<li>
<p>Run a remote execution job on a host through your Smart&#160;Proxy with SSH certificate authentication enabled.</p>
</li>
<li>
<p>On the host, view the <code>sshd</code> logs:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># journalctl -u sshd</pre>
</div>
</div>
</li>
<li>
<p>Find the log message that confirms that the SSH certificate was used for authentication:</p>
<div class="listingblock">
<div class="content">
<pre>Accepted publickey for &lt;SSH USER&gt; from &lt;IP&gt; port 22 ssh2: RSA-CERT ID foreman-proxy CA RSA</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="configuring-registered-hosts-to-accept-ssh-certificate-from-smart-proxy"><a class="anchor" href="#configuring-registered-hosts-to-accept-ssh-certificate-from-smart-proxy"></a>9.25.4. Configuring registered hosts to accept an SSH certificate from Smart&#160;Proxy</h4>
<div class="paragraph _abstract">
<p>After you enable SSH certificate authentication on your Smart&#160;Proxy, you can configure hosts to accept SSH certificates from your Smart&#160;Proxy.
This ensures the hosts will no longer accept plain SSH keys during a remote execution connection.</p>
</div>
<div class="paragraph">
<p>You can use remote execution to apply these changes.</p>
</div>
<div class="paragraph">
<p>Perform these steps on each host that uses your Smart&#160;Proxy for remote execution and was registered before you enabled SSH certificate authentication on your Smart&#160;Proxy.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have a Certificate Authority (CA) for signing SSH certificates.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Copy the CA public key file to the host.</p>
</li>
<li>
<p>Ensure that the <code>/etc/ssh/sshd_config.d/</code> directory exists:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># mkdir --parents /etc/ssh/sshd_config.d/</pre>
</div>
</div>
</li>
<li>
<p>Configure the <code>sshd</code> service to trust the CA:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># echo 'TrustedUserCAKeys <em>My_CA_Public_Key_File_Path</em>' &gt; /etc/ssh/sshd_config.d/60-foreman-user-ca.conf</pre>
</div>
</div>
</li>
<li>
<p>Set the correct SELinux context for the created file:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># restorecon /etc/ssh/sshd_config.d/60-foreman-user-ca.conf</pre>
</div>
</div>
</li>
<li>
<p>Restart the <code>sshd</code> service:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl restart sshd</pre>
</div>
</div>
</li>
<li>
<p>Remove existing SSH keys of the Smart&#160;Proxy from the <code>authorized_keys</code> file of your SSH user.
By default, the SSH user is root and the SSH keys are associated with the <code>foreman-proxy</code> user:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># sed -i '/foreman-proxy/d' ~/.ssh/authorized_keys</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>This command might not work if you configured custom SSH keys on your Smart&#160;Proxy.
In that case, manually edit the <code>authorized_keys</code> file.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="enabling-ssh-host-certificate-verification-on-smart-proxy"><a class="anchor" href="#enabling-ssh-host-certificate-verification-on-smart-proxy"></a>9.25.5. Enabling SSH host certificate verification on Smart&#160;Proxy</h4>
<div class="paragraph _abstract">
<p>Your Smart&#160;Proxy can use SSH host certificates to verify the identity of hosts.
In this configuration, Smart&#160;Proxy verifies that hosts present valid certificates signed by a trusted Certificate Authority (CA) during SSH connections.
Your Smart&#160;Proxy can trust host certificates signed by multiple CAs.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>After you enable host certificate verification on Smart&#160;Proxy, all hosts that use this Smart&#160;Proxy for remote execution can authenticate only if they are configured to use host certificates.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have a CA for signing SSH host certificates.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>On each host that uses this Smart&#160;Proxy for remote execution, prepare the SSH certificate for the host:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Copy one of the public key files of the host to the CA server.
The public keys are located in <code>/etc/ssh/</code>.</p>
</li>
<li>
<p>Sign the public key with your CA to create an SSH host certificate.
Use the <code>-h</code> option when generating the SSH host certificate with <code>ssh-keygen</code>.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>ssh-keygen</code> command creates the certificate file with the name <code><em>My_Host_Private_SSH_Key</em>-cert.pub</code>.
Do not change the name of the file.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Copy the SSH certificate file back to the host.
The location must be the same as the location of the private key.</p>
</li>
<li>
<p>Configure the host to use the certificate:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># mkdir --parents /etc/ssh/sshd_config.d/
# echo 'HostCertificate <em>My_Host_SSH_Certificate_Path</em>' &gt; /etc/ssh/sshd_config.d/60-host-cert.conf
# restorecon -R /etc/ssh/</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If the host SSH public key you used for the certificate is not one of the default keys (<code>/etc/ssh/ssh_host_ecdsa_key.pub</code>, <code>/etc/ssh/ssh_host_ed25519_key.pub</code>, or <code>/etc/ssh/ssh_host_rsa_key.pub</code>), also add the host key configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># echo 'HostKey <em>My_Host_Private_SSH_Key_Path</em>' &gt;&gt; /etc/ssh/sshd_config.d/60-host-cert.conf</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Restart the <code>sshd</code> service:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl restart sshd</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>On the Smart&#160;Proxy, configure host certificate verification:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If the host CA is not located on the Smart&#160;Proxy&#160;server, copy the host CA public key file to your Smart&#160;Proxy&#160;server.
If you have multiple host CAs, place all of their public keys in a single file, with each key on a separate line.</p>
</li>
<li>
<p>Enable host certificate verification:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-installer \
--foreman-proxy-plugin-remote-execution-script-ssh-host-ca-public-keys-file <em>My_Host_CA_Public_Keys_File_Path</em></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Verification</div>
<ul>
<li>
<p>Run a remote execution job on a host that is not configured with a host certificate signed by a trusted CA.
The attempt results in an authentication failure.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="disabling-ssh-host-certificate-verification-on-smart-proxy"><a class="anchor" href="#disabling-ssh-host-certificate-verification-on-smart-proxy"></a>9.25.6. Disabling SSH host certificate verification on Smart&#160;Proxy</h4>
<div class="paragraph _abstract">
<p>If you disable SSH host certificate verification on Smart&#160;Proxy, you will revert to the Trust On First Use (TOFU) model.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>On Smart&#160;Proxy, disable SSH host certificate verification:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-installer \
--reset-foreman-proxy-plugin-remote-execution-script-ssh-host-ca-public-keys-file</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configuring-a-keytab-for-kerberos-ticket-granting-tickets_managing-hosts"><a class="anchor" href="#configuring-a-keytab-for-kerberos-ticket-granting-tickets_managing-hosts"></a>9.26. Configuring a keytab for Kerberos ticket granting tickets</h3>
<div class="paragraph _abstract">
<p>Use this procedure to configure Foreman to use a keytab to obtain Kerberos ticket granting tickets.
If you do not set up a keytab, you must manually retrieve tickets.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Find the ID of the <code>foreman-proxy</code> user:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># id -u foreman-proxy</pre>
</div>
</div>
</li>
<li>
<p>Modify the <code>umask</code> value so that new files have the permissions <code>600</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># umask 077</pre>
</div>
</div>
</li>
<li>
<p>Create the directory for the keytab:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># mkdir -p "/var/kerberos/krb5/user/<em>My_User_ID</em>"</pre>
</div>
</div>
</li>
<li>
<p>Create a keytab or copy an existing keytab to the directory:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># cp <em>My_Client.keytab</em> /var/kerberos/krb5/user/<em>My_User_ID</em>/client.keytab</pre>
</div>
</div>
</li>
<li>
<p>Change the directory owner to the <code>foreman-proxy</code> user:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># chown -R foreman-proxy:foreman-proxy "/var/kerberos/krb5/user/<em>My_User_ID</em>"</pre>
</div>
</div>
</li>
<li>
<p>Ensure that the keytab file is read-only:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># chmod -wx "/var/kerberos/krb5/user/<em>My_User_ID</em>/client.keytab"</pre>
</div>
</div>
</li>
<li>
<p>Restore the SELinux context:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># restorecon -RvF /var/kerberos/krb5</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="configuring-kerberos-authentication-for-remote-execution_managing-hosts"><a class="anchor" href="#configuring-kerberos-authentication-for-remote-execution_managing-hosts"></a>9.27. Configuring Kerberos authentication for remote execution</h3>
<div class="paragraph _abstract">
<p>You can use Kerberos authentication to establish an SSH connection for remote execution on Foreman hosts.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Enroll Foreman&#160;server on the Kerberos server</p>
</li>
<li>
<p>Enroll the Foreman target host on the Kerberos server</p>
</li>
<li>
<p>Configure and initialize a Kerberos user account for remote execution</p>
</li>
<li>
<p>Ensure that the <code>foreman-proxy</code> user on Foreman has a valid Kerberos ticket-granting ticket (TGT)</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Enable Kerberos authentication for remote execution:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-installer --foreman-proxy-plugin-remote-execution-script-ssh-kerberos-auth true</pre>
</div>
</div>
</li>
<li>
<p>To edit the default user for remote execution, in the Foreman web UI, navigate to <strong>Administer</strong> &gt; <strong>Settings</strong> and click the <strong>Remote Execution</strong> tab.
In the <strong>SSH User</strong> row, edit the second column and add the user name for the Kerberos account.</p>
</li>
<li>
<p>Navigate to <strong>remote_execution_effective_user</strong> and edit the second column to add the user name for the Kerberos account.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Verification</div>
<ul>
<li>
<p>To confirm that Kerberos authentication is ready to use, run a remote job on the host.
For more information, see <a href="#configuring-and-setting-up-remote-jobs">Configuring and setting up remote jobs</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="customizing-job-templates"><a class="anchor" href="#customizing-job-templates"></a>9.28. Customizing job templates</h3>
<div class="paragraph _abstract">
<p>Foreman provides default job templates that you can use for executing jobs.
Default job templates are locked for editing but you can clone them and edit the clone.</p>
</div>
<div class="paragraph">
<p>Job templates use the Embedded Ruby (ERB) syntax.
Ansible job templates use YAML syntax.</p>
</div>
<div class="paragraph">
<p>At run time, job templates can accept parameter variables that you define for a host.
Note that only the parameters visible on the <strong>Parameters</strong> tab at the host&#8217;s edit page can be used as input parameters for job templates.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Job templates</strong>.</p>
</li>
<li>
<p>To clone a template, in the <strong>Actions</strong> column, select <strong>Clone</strong>.</p>
</li>
<li>
<p>Enter a unique name for the clone and click <strong>Submit</strong> to save the changes.</p>
</li>
<li>
<p>In the list of job templates, click the cloned template to start editing it.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>An Ansible template must begin with <code>---</code>.
You can embed an Ansible Playbook YAML file into the job template body.
You can also add ERB syntax to customize your YAML Ansible template.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://docs.theforeman.org/nightly/Managing_Hosts/index-foreman-el.html#Template_Writing_Reference_managing-hosts">Template Writing Reference in <em>Managing hosts</em></a></p>
</li>
<li>
<p><a href="https://docs.theforeman.org/nightly/Administering_Project/index-foreman-el.html#synchronizing-template-repositories">Synchronizing template repositories in <em>Administering Foreman</em></a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="executing-a-remote-job-by-using-web-ui"><a class="anchor" href="#executing-a-remote-job-by-using-web-ui"></a>9.29. Executing a remote job by using Foreman web UI</h3>
<div class="paragraph _abstract">
<p>You can execute a job that is based on a job template against one or more hosts from the Foreman web UI.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Ansible jobs run in batches on multiple hosts, so you cannot cancel a job running on a specific host.
A job completes only after the Ansible Playbook runs on all hosts in the batch.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have the Remote Execution plugin enabled.
For more information, see <a href="#installing-the-remote-execution-plugin">Installing the Remote Execution plugin</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Monitor</strong> &gt; <strong>Jobs</strong> and click <strong>Run job</strong>.</p>
</li>
<li>
<p>Select the <strong>Job category</strong> and the <strong>Job template</strong> you want to use, then click <strong>Next</strong>.</p>
</li>
<li>
<p>Select hosts on which you want to run the job.
If you do not select any hosts, the job will run on all hosts you can see in the current context.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If you want to select a host group and all of its subgroups, it is not sufficient to select the host group as the job would only run on hosts directly in that group and not on hosts in subgroups.
Instead, you must either select the host group and all of its subgroups or use this search query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">hostgroup_fullname ~ "<em>My_Host_Group</em>*"</pre>
</div>
</div>
<div class="paragraph">
<p>Replace <em>My_Host_Group</em> with the name of the top-level host group.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>If required, provide inputs for the job template.
Different templates have different inputs and some templates do not have any inputs.
After entering all the required inputs, click <strong>Next</strong>.</p>
</li>
<li>
<p>Optional: To configure advanced settings for the job, fill in the <strong>Advanced fields</strong>.
To learn more about advanced settings, see <a href="#advanced-settings-in-the-job-wizard_managing-hosts">Advanced settings in the job wizard</a>.</p>
</li>
<li>
<p>Click <strong>Next</strong>.</p>
</li>
<li>
<p>Schedule time for the job.</p>
<div class="ulist">
<ul>
<li>
<p>To execute the job immediately, keep the pre-selected <strong>Immediate execution</strong>.</p>
</li>
<li>
<p>To execute the job in future time, select <strong>Future execution</strong>.</p>
</li>
<li>
<p>To execute the job on regular basis, select <strong>Recurring execution</strong>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Optional: If you selected future or recurring execution, select the <strong>Query type</strong>, otherwise click <strong>Next</strong>.</p>
<div class="ulist">
<ul>
<li>
<p><strong>Static query</strong> means that job executes on the exact list of hosts that you provided.</p>
</li>
<li>
<p><strong>Dynamic query</strong> means that the list of hosts is evaluated just before the job is executed.
If you entered the list of hosts based on some filter, the results can be different from when you first used that filter.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Click <strong>Next</strong> after you have selected the query type.</p>
</div>
</li>
<li>
<p>Optional: If you selected future or recurring execution, provide additional details:</p>
<div class="ulist">
<ul>
<li>
<p>For <strong>Future execution</strong>, enter the <strong>Starts at</strong> date and time.
You also have the option to select the <strong>Starts before</strong> date and time.
If the job cannot start before that time, it will be canceled.</p>
</li>
<li>
<p>For <strong>Recurring execution</strong>, select the start date and time, frequency, and the condition for ending the recurring job.
You can choose the recurrence to never end, end at a certain time, or end after a given number of repetitions.
You can also add <strong>Purpose</strong> - a special label for tracking the job.
There can only be one active job with a given purpose at a time.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Click <strong>Next</strong> after you have entered the required information.</p>
</div>
</li>
<li>
<p>Review job details.
You have the option to return to any part of the job wizard and edit the information.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to schedule the job for execution.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="executing-a-remote-job-by-using-cli"><a class="anchor" href="#executing-a-remote-job-by-using-cli"></a>9.30. Executing a remote job by using Hammer CLI</h3>
<div class="paragraph _abstract">
<p>You can execute a job that is based on a job template against one or more hosts.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Ansible jobs run in batches on multiple hosts, so you cannot cancel a job running on a specific host.
A job completes only after the Ansible Playbook runs on all hosts in the batch.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For more information about creating, monitoring, or canceling remote jobs with Hammer CLI, enter <code>hammer job-template --help</code> and <code>hammer job-invocation --help</code>.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have the Remote Execution plugin enabled.
For more information, see <a href="#installing-the-remote-execution-plugin">Installing the Remote Execution plugin</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Enter the following command on Foreman:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer settings set \
--name remote_execution_global_proxy \
--value false</pre>
</div>
</div>
</li>
<li>
<p>Find the ID of the job template you want to use:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer job-template list</pre>
</div>
</div>
</li>
<li>
<p>Show the template details to see parameters required by your template:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer job-template info --id <em>My_Template_ID</em></pre>
</div>
</div>
</li>
<li>
<p>Execute a remote job with custom parameters:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer job-invocation create \
--inputs <em>My_Key_1</em>="<em>My_Value_1</em>",<em>My_Key_2</em>="<em>My_Value_2</em>",... \
--job-template "<em>My_Template_Name</em>" \
--search-query "<em>My_Search_Query</em>"</pre>
</div>
</div>
<div class="paragraph">
<p>Replace <code><em>My_Search_Query</em></code> with the filter expression that defines hosts, for example <code>"name ~ <em>My_Pattern</em>"</code>.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="advanced-settings-in-the-job-wizard_managing-hosts"><a class="anchor" href="#advanced-settings-in-the-job-wizard_managing-hosts"></a>9.31. Advanced settings in the job wizard</h3>
<div class="paragraph _abstract">
<p>Some job templates require you to enter advanced settings.
Some of the advanced settings are only visible to certain job templates.
Below is the list of general advanced settings.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">SSH user</dt>
<dd>
<p>A user to be used for connecting to the host through SSH.</p>
</dd>
<dt class="hdlist1">Effective user</dt>
<dd>
<p>A user to be used for executing the job.
By default it is the SSH user.
If it differs from the SSH user, su or sudo, depending on your settings, is used to switch the accounts.</p>
<div class="ulist">
<ul>
<li>
<p>If you set an effective user in the advanced settings, Ansible sets <code>ansible_become_user</code> to your input value and <code>ansible_become</code> to <code>true</code>.
This means that if you use the parameters <code>become: true</code> and <code>become_user: <em>My_User</em></code> within a playbook, these will be overwritten by Foreman.</p>
</li>
<li>
<p>If your <em>SSH user</em> and <em>effective user</em> are identical, Foreman does not overwrite the <code>become_user</code>.
Therefore, you can set a custom <code>become_user</code> in your Ansible Playbook.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Description</dt>
<dd>
<p>A description template for the job.</p>
</dd>
<dt class="hdlist1">Timeout to kill</dt>
<dd>
<p>Time in seconds from the start of the job after which the job should be killed if it is not finished already.</p>
</dd>
<dt class="hdlist1">Time to pickup</dt>
<dd>
<p>Time in seconds after which the job is canceled if it is not picked up by a client.
This setting only applies to hosts using <code>pull-mqtt</code> transport.</p>
</dd>
<dt class="hdlist1">Password</dt>
<dd>
<p>Is used if SSH authentication method is a password instead of the SSH key.</p>
</dd>
<dt class="hdlist1">Private key passphrase</dt>
<dd>
<p>Is used if SSH keys are protected by a passphrase.</p>
</dd>
<dt class="hdlist1">Effective user password</dt>
<dd>
<p>Is used if effective user is different from the ssh user.</p>
</dd>
<dt class="hdlist1">Concurrency level</dt>
<dd>
<p>Defines the maximum number of jobs executed at once.
This can prevent overload of system resources in a case of executing the job on a large number of hosts.</p>
</dd>
<dt class="hdlist1">Execution ordering</dt>
<dd>
<p>Determines the order in which the job is executed on hosts.
It can be alphabetical or randomized.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="using-extended-cron-lines_managing-hosts"><a class="anchor" href="#using-extended-cron-lines_managing-hosts"></a>9.32. Using extended cron lines</h3>
<div class="paragraph _abstract">
<p>When scheduling a cron job with remote execution, you can use an extended cron line to specify the cadence of the job.</p>
</div>
<div class="paragraph">
<p>The standard cron line contains five fields that specify minute, hour, day of the month, month, and day of the week.
For example, <code>0 5 * * *</code> stands for every day at 5 AM.
If you want to learn more about the standard cron line, check <a href="https://crontab.guru">crontab guru</a>.</p>
</div>
<div class="paragraph">
<p>The extended cron line provides the following features:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">You can use <code>#</code> to specify a concrete week day in a month</dt>
<dd>
<p>For example:</p>
<div class="ulist">
<ul>
<li>
<p><code>0 0 * * mon#1</code> specifies first Monday of the month</p>
</li>
<li>
<p><code>0 0 * * fri#3,fri#4</code> specifies 3rd and 4th Fridays of the month</p>
</li>
<li>
<p><code>0 7 * * fri#-1</code> specifies the last Friday of the month at 07:00</p>
</li>
<li>
<p><code>0 7 * * fri#L</code> also specifies the last Friday of the month at 07:00</p>
</li>
<li>
<p><code>0 23 * * mon#2,tue</code> specifies the 2nd Monday of the month and every Tuesday, at 23:00</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">You can use <code>%</code> to specify every n-th day of the month</dt>
<dd>
<p>For example:</p>
<div class="ulist">
<ul>
<li>
<p><code>9 0 * * sun%2</code> specifies every other Sunday at 00:09</p>
</li>
<li>
<p><code>0 0 * * sun%2+1</code> specifies every odd Sunday</p>
</li>
<li>
<p><code>9 0 * * sun%2,tue%3</code> specifies every other Sunday and every third Tuesday</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">You can use <code>&amp;</code> to specify that the day of the month has to match the day of the week</dt>
<dd>
<p>For example:</p>
<div class="ulist">
<ul>
<li>
<p><code>0 0 30 * 1&amp;</code> specifies 30th day of the month, but only if it is Monday</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="scheduling-a-recurring-ansible-job-for-a-host"><a class="anchor" href="#scheduling-a-recurring-ansible-job-for-a-host"></a>9.33. Scheduling a recurring Ansible job for a host</h3>
<div class="paragraph _abstract">
<p>You can schedule a recurring job to run Ansible roles on hosts.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Ensure you have the <code>view_foreman_tasks</code>, <code>view_job_invocations</code>, and <code>view_recurring_logics</code> permissions.</p>
</li>
<li>
<p>Ensure you have assigned at least one Ansible role to your host.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>All Hosts</strong>.</p>
</li>
<li>
<p>Select your host.</p>
</li>
<li>
<p>On the <strong>Ansible</strong> tab, select <strong>Jobs</strong>.</p>
</li>
<li>
<p>Click <strong>Schedule recurring job</strong>.</p>
</li>
<li>
<p>In the <strong>Repeat</strong> list, select the interval.</p>
</li>
<li>
<p>In the <strong>Start time</strong> field, enter the start time of the recurring job.</p>
</li>
<li>
<p>In the <strong>Start date</strong> field, enter the start date of the recurring job.</p>
</li>
<li>
<p>Click <strong>Submit</strong>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="scheduling-a-recurring-ansible-job-for-a-host-group"><a class="anchor" href="#scheduling-a-recurring-ansible-job-for-a-host-group"></a>9.34. Scheduling a recurring Ansible job for a host group</h3>
<div class="paragraph _abstract">
<p>You can schedule a recurring job to run Ansible roles on host groups.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Ensure that you have assigned at least one Ansible role to your host group.</p>
</li>
<li>
<p>Ensure that you have assigned at least one host to your host group.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Configure</strong> &gt; <strong>Host Groups</strong>.</p>
</li>
<li>
<p>In the <strong>Actions</strong> column, select <strong>Configure Ansible Job</strong> for the host group you want to schedule an Ansible roles run for.</p>
</li>
<li>
<p>Click <strong>Schedule recurring job</strong>.</p>
</li>
<li>
<p>In the <strong>Repeat</strong> list, select the interval.</p>
</li>
<li>
<p>In the <strong>Start time</strong> field, enter the start time of the recurring job.</p>
</li>
<li>
<p>In the <strong>Start date</strong> field, enter the start date of the recurring job.</p>
</li>
<li>
<p>Click <strong>Submit</strong>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="setting-the-job-rate-limit-on-smart-proxy_managing-hosts"><a class="anchor" href="#setting-the-job-rate-limit-on-smart-proxy_managing-hosts"></a>9.35. Setting the job rate limit on Smart&#160;Proxy</h3>
<div class="paragraph _abstract">
<p>You can limit the maximum number of active jobs on a Smart&#160;Proxy at a time to prevent performance spikes.</p>
</div>
<div class="paragraph">
<p>The job is active from the time Smart&#160;Proxy first tries to notify the host about the job until the job is finished on the host.</p>
</div>
<div class="paragraph">
<p>The job rate limit only applies to mqtt based jobs.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The optimal maximum number of active jobs depends on the computing resources of your Smart&#160;Proxy&#160;server.
By default, the maximum number of active jobs is unlimited.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Set the maximum number of active jobs using <code>foreman-installer</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-installer \
--foreman-proxy-plugin-remote-execution-script-mqtt-rate-limit <em>MAX_JOBS_NUMBER</em></pre>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-installer \
--foreman-proxy-plugin-remote-execution-script-mqtt-rate-limit 200</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Host_Status_managing-hosts"><a class="anchor" href="#Host_Status_managing-hosts"></a>10. Host status in Foreman</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>In Foreman, each host has a global status that indicates which hosts need attention.
Each host also has sub-statuses that represent status of a particular feature.
With any change of a sub-status, the global status is recalculated and the result is determined by statuses of all sub-statuses.</p>
</div>
<div class="sect2">
<h3 id="host-global-status-overview_managing-hosts"><a class="anchor" href="#host-global-status-overview_managing-hosts"></a>10.1. Host global status overview</h3>
<div class="paragraph _abstract">
<p>The global status represents the overall status of a particular host.</p>
</div>
<div class="paragraph">
<p>The status can have one of three possible values: <strong>OK</strong>, <strong>Warning</strong>, or <strong>Error</strong>.
You can find global status on the Hosts Overview page.
The status displays a small icon next to host name and has a color that corresponds with the status.
Hovering over the icon renders a tooltip with sub-status information to quickly find out more details.
To view the global status for a host, in the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>All Hosts</strong>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">OK</dt>
<dd>
<p>No errors were reported by any sub-status.
This status is highlighted with the color green.</p>
</dd>
<dt class="hdlist1">Warning</dt>
<dd>
<p>While no error was detected, some sub-status raised a warning.
For example, there are no configuration management reports for the host even though the host is configured to send reports.
It is a good practice to investigate any warnings to ensure that your deployment remains healthy.
This status is highlighted with the color yellow.</p>
</dd>
<dt class="hdlist1">Error</dt>
<dd>
<p>Some sub-status reports a failure.
For example, a run contains some failed resources.
This status is highlighted with the color red.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>If you want to search for hosts according to their status, use the syntax for searching in Foreman that is outlined in the <a href="https://docs.theforeman.org/nightly/Administering_Project/index-foreman-el.html#Searching_and_Bookmarking_admin">Searching and Bookmarking</a> in <em>Administering Foreman</em>, and then build your searches out by using the following status-related examples:</p>
</div>
<div class="paragraph">
<p>To search for hosts that have an <strong>OK</strong> status:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">global_status = ok</pre>
</div>
</div>
<div class="paragraph">
<p>To search for all hosts that deserve attention:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">global_status = error or global_status = warning</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="host-substatus-overview_managing-hosts"><a class="anchor" href="#host-substatus-overview_managing-hosts"></a>10.2. Host sub-status overview</h3>
<div class="paragraph _abstract">
<p>A sub-status monitors only a part of a host&#8217;s capabilities.</p>
</div>
<div class="paragraph">
<p>To view the sub-statuses of a host, in the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>All Hosts</strong> and click on the host whose full status you want to inspect.
You can view the global host status next to the name of the host and the host sub-statuses on the <strong>Host status</strong> card.</p>
</div>
<div class="paragraph">
<p>Each sub-status has its own set of possible values that are mapped to the three global status values.</p>
</div>
<div class="paragraph">
<p>Below are listed sub-statuses that Foreman contains.
There can be more sub-statuses depending on which plugins you add to your Foreman.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Configuration</dt>
<dd>
<p>This sub-status is only relevant if Foreman uses a configuration management system like Ansible, Puppet, or Salt.</p>
<div class="paragraph">
<p>Possible values:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Global host status</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alerts disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OK</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Active</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OK</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OK</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">No changes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OK</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">No reports</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OK / Warning</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Out of sync</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Warning</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Additional information about the values of this sub-status:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Active</strong>: During the last configuration, some resources were applied.</p>
</li>
<li>
<p><strong>Pending</strong>: During the last configuration, some resources would be applied but your configuration management integration was configured to run in <code>noop</code> mode.</p>
</li>
<li>
<p><strong>No changes</strong>: During the last configuration, nothing changed.</p>
</li>
<li>
<p><strong>No reports</strong>: This can be both a <strong>Warning</strong> or <strong>OK</strong> status.
When there are no reports but the host uses an associated Smart&#160;Proxy for configuration management or the <code>always_show_configuration_status</code> setting is set to <code>true</code>, it maps to <strong>Warning</strong>.
Otherwise it maps to <strong>OK</strong>.</p>
</li>
<li>
<p><strong>Error</strong>: This indicates an error during configuration.
For example, a configuration run failed to install a package.</p>
</li>
<li>
<p><strong>Out of sync</strong>: A configuration report was not received within the expected interval, based on the <code>outofsync_interval</code> setting.
Reports are identified by an origin and can have different intervals based upon it.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Build</dt>
<dd>
<p>This sub-status is only relevant for hosts provisioned from Foreman or hosts registered through global registration.</p>
<div class="paragraph">
<p>Possible values:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Global host status</th>
<th class="tableblock halign-left valign-top">Number value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Installed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending installation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Token expired</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Installation error</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
</tr>
</tbody>
</table>
</dd>
<dt class="hdlist1">Compliance</dt>
<dd>
<p>Indicates if the host is compliant with OpenSCAP policies.</p>
<div class="paragraph">
<p>Possible values:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Global host status</th>
<th class="tableblock halign-left valign-top">Number value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compliant</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inconclusive</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Warning</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">At least one incompliant</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
</tbody>
</table>
</dd>
<dt class="hdlist1">Execution</dt>
<dd>
<p>Status of the last completed remote execution job.</p>
<div class="paragraph">
<p>Only applies if you have the Remote Execution plugin installed.</p>
</div>
<div class="paragraph">
<p>Possible values:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Global host status</th>
<th class="tableblock halign-left valign-top">Number value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Last execution succeeded / No execution finished yet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Last execution failed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unknown execution status</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 or 3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Last execution cancelled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</div>
<div class="paragraph">
<p>If you want to search for hosts according to their sub-status, use the syntax for searching in Foreman that is outlined in the <a href="https://docs.theforeman.org/nightly/Administering_Project/index-foreman-el.html#Searching_and_Bookmarking_admin">Searching and Bookmarking</a> chapter of the <em>Administering Foreman</em> guide, and then build your searches out by using the following status-related examples:</p>
</div>
<div class="paragraph">
<p>You search for hosts' configuration sub-statuses based on their last reported state.</p>
</div>
<div class="paragraph">
<p>For example, to find hosts that have at least one pending resource:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">status.pending &gt; 0</pre>
</div>
</div>
<div class="paragraph">
<p>To find hosts that restarted some service during last run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">status.restarted &gt; 0</pre>
</div>
</div>
<div class="paragraph">
<p>To find hosts that have an interesting last run that might indicate something has happened:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">status.interesting = true</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="troubleshooting-remote-jobs-timing-out-after-yggdrasil-update"><a class="anchor" href="#troubleshooting-remote-jobs-timing-out-after-yggdrasil-update"></a>Appendix A: Troubleshooting: Remote jobs timing out after <code>yggdrasil</code> update</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>On hosts that have weak dependencies disabled and are configured to use the <code>yggdrasil</code> pull client, remote jobs can start failing due to timeouts after the <code>yggdrasil</code> package has been updated to version 0.4.z or later.
You can manually install the <code>foreman_ygg_migration</code> package to address the problem.</p>
</div>
<div class="paragraph">
<p>The pull-based transport configuration relies on the Yggdrasil service and differs based on the version of the <code>yggdrasil</code> package that is installed on the host.
For pull-based remote execution mode to work correctly after <code>yggdrasil</code> version 0.4.z is installed on the host, the Yggdrasil client configuration must be updated.
Installing the <code>foreman_ygg_migration</code> package on the host ensures that Foreman applies the required changes to Yggdrasil configuration.</p>
</div>
<div class="paragraph">
<p>On hosts with weak dependencies enabled, Foreman automatically installs the <code>foreman_ygg_migration</code> package.
No further steps are required.</p>
</div>
<div class="paragraph">
<p>On hosts with weak dependencies disabled, you must install the <code>foreman_ygg_migration</code> package manually.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Determine which version of the <code>yggdrasil</code> package is installed on the host:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ rpm --query yggdrasil</pre>
</div>
</div>
</li>
<li>
<p>If your host has <code>yggdrasil</code> version 0.4.z or later installed, the <code>yggdrasil</code> and <code>com.redhat.Yggdrasil1.Worker1.foreman</code> services are expected to be running.
Check the status of these services:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl status yggdrasil com.redhat.Yggdrasil1.Worker1.foreman</pre>
</div>
</div>
<div class="paragraph">
<p>If the above services are not running, it means that Yggdrasil might not be configured correctly.</p>
</div>
</li>
<li>
<p>Install the <code>foreman_ygg_migration</code> package manually:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># dnf install foreman_ygg_migration</pre>
</div>
</div>
<div class="paragraph">
<p>Installing <code>foreman_ygg_migration</code> ensures that Foreman applies the required Yggdrasil configuration changes and enables remote execution in pull mode to work as expected.</p>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Verification</div>
<ol class="arabic">
<li>
<p>Check the status of the Yggdrasil services again:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl status yggdrasil com.redhat.Yggdrasil1.Worker1.foreman</pre>
</div>
</div>
<div class="paragraph">
<p>These services should now be running.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Template_Writing_Reference_managing-hosts"><a class="anchor" href="#Template_Writing_Reference_managing-hosts"></a>Appendix B: Template writing reference</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>Embedded Ruby (ERB) is a tool for generating text files based on templates that combine plain text with Ruby code.
This section provides an overview of Foreman-specific macros and variables that can be used in ERB templates along with some usage examples.</p>
</div>
<div class="paragraph">
<p>When provisioning a host or running a remote job, the code in the ERB is executed and the variables are replaced with the host specific values.
This process is referred to as <strong>rendering</strong>.
Foreman&#160;server has the safemode rendering option enabled by default, which prevents any harmful code being executed from templates.</p>
</div>
<div class="paragraph">
<p>Note that the default templates provided by Foreman (<strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Provisioning Templates</strong>, <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Job templates</strong>, <strong>Monitor</strong> &gt; <strong>Reports</strong> &gt; <strong>Report Templates</strong> ) also provide a good source of ERB syntax examples.</p>
</div>
<div class="paragraph">
<p>Foreman uses ERB syntax in the following cases:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Provisioning templates</dt>
<dd>
<p>For more information, see <a href="https://docs.theforeman.org/nightly/Provisioning_Hosts/index-foreman-el.html#creating-provisioning-templates-by-using-web-ui">Creating provisioning templates in Foreman web UI</a> in <em>Provisioning hosts</em>.</p>
</dd>
<dt class="hdlist1">Remote execution job templates</dt>
<dd>
<p>For more information, see <a href="#configuring-and-setting-up-remote-jobs">Configuring and setting up remote jobs</a>.</p>
</dd>
<dt class="hdlist1">Report templates</dt>
<dd>
<p>For more information, see <a href="#Using_Report_Templates_to_Monitor_Hosts_managing-hosts">Using report templates to monitor hosts</a>.</p>
</dd>
<dt class="hdlist1">Templates for partition tables</dt>
<dd>
<p>For more information, see <a href="https://docs.theforeman.org/nightly/Provisioning_Hosts/index-foreman-el.html#creating-partition-tables-by-using-web-ui">Creating partition tables by using Foreman web UI</a> in <em>Provisioning hosts</em>.</p>
</dd>
<dt class="hdlist1">Smart Class Parameters</dt>
<dd>
<p>For more information, see <a href="https://docs.theforeman.org/nightly/Managing_Configurations_Puppet/index-foreman-el.html#Configuring_Puppet_Smart_Class_Parameters_managing-configurations-puppet">Configuring Puppet smart class parameters</a> in <em>Configuring hosts by using Puppet</em>.</p>
</dd>
</dl>
</div>
<div class="sect2">
<h3 id="Accessing_the_Template_Writing_Reference_managing-hosts"><a class="anchor" href="#Accessing_the_Template_Writing_Reference_managing-hosts"></a>Accessing the template writing reference in the Foreman web UI</h3>
<div class="paragraph _abstract">
<p>You can access the template writing reference document in the Foreman web UI.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Log in to the Foreman web UI.</p>
</li>
<li>
<p>In the Foreman web UI, navigate to <strong>Administer</strong> &gt; <strong>About</strong>.</p>
</li>
<li>
<p>Click the <strong>Templates DSL</strong> link in the Support section.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Using_Autocompletion_in_Templates_managing-hosts"><a class="anchor" href="#Using_Autocompletion_in_Templates_managing-hosts"></a>Using autocompletion in templates</h3>
<div class="paragraph _abstract">
<p>You can access a list of available macros and usage information in the template editor with the autocompletion option.
This works for all templates within Foreman.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to either <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Partition tables</strong>, <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Provisioning Templates</strong>, or <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Job templates</strong>.</p>
</li>
<li>
<p>Click the <strong>settings</strong> icon at the top right corner of the template editor and select <strong>Autocompletion</strong>.</p>
</li>
<li>
<p>Press <code><strong>Ctrl</strong></code> + <code><strong>Space</strong></code> in the template editor to access a list of all available macros.
You can narrow down the list of macros by typing in more information about what you are looking for.
For example, if you are looking for a method to list the ID of the content source for a host, you can type <code>host</code> and check the list of available macros for content source.</p>
</li>
<li>
<p>A window next to the dropdown provides a description of the macro, its usage, and the value it will return.</p>
</li>
<li>
<p>When you find the method you are looking for, hit <code>Enter</code> to input the method.</p>
<div class="paragraph">
<p>You can also enable <strong>Live Autocompletion</strong> in the <strong>settings</strong> menu to view a list of macros that match the pattern whenever you type something.
However, this might input macros in unintended places, like package names in a provisioning template.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Writing_ERB_Templates_managing-hosts"><a class="anchor" href="#Writing_ERB_Templates_managing-hosts"></a>Writing ERB templates</h3>
<div class="paragraph _abstract">
<p>You can use the following common tags in your ERB templates.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Because of the varying lengths of the ERB tags, indenting the ERB syntax might seem messy.
ERB syntax ignores white space.
One method of handling the indentation is to declare the ERB tag at the beginning of each new line and then use white space within the ERB tag to outline the relationships within the syntax, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;%- load_hosts.each do |host| -%&gt;
&lt;%-   if host.build? %&gt;
&lt;%=     host.name %&gt; build is in progress
&lt;%-   end %&gt;
&lt;%- end %&gt;</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">&lt;%  %&gt;</dt>
<dd>
<p>All Ruby code is enclosed within <code>&lt;%  %&gt;</code> in an ERB template.
The code is executed when the template is rendered.
It can contain Ruby control flow structures as well as Foreman-specific macros and variables.
For example:</p>
<div class="listingblock">
<div class="content">
<pre>&lt;% if @host.operatingsystem.family == "Redhat" &amp;&amp; @host.operatingsystem.major.to_i &gt; 6 -%&gt;
systemctl &lt;%= input("action") %&gt; &lt;%= input("service") %&gt;
&lt;% else -%&gt;
service &lt;%= input("service") %&gt; &lt;%= input("action") %&gt;
&lt;% end -%&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Note that this template silently performs an action with a service and returns nothing at the output.</p>
</div>
</dd>
<dt class="hdlist1">&lt;%=  %&gt;</dt>
<dd>
<p>This provides the same functionality as <code>&lt;%  %&gt;</code>  but when the template is executed, the code output is inserted into the template.
This is useful for variable substitution, for example:</p>
<div class="paragraph">
<p>Example input:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>echo &lt;%= @host.name %&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Example rendering:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"><em>host.example.com</em></pre>
</div>
</div>
<div class="paragraph">
<p>Example input:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;% server_name = @host.fqdn %&gt;
&lt;%= server_name %&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Example rendering:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"><em>host.example.com</em></pre>
</div>
</div>
<div class="paragraph">
<p>Note that if you enter an incorrect variable, no output is returned.
However, if you try to call a method on an incorrect variable, the following error message returns:</p>
</div>
<div class="paragraph">
<p>Example input:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">&lt;%= @<em>example_incorrect_variable</em>.fqdn -%&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Example rendering:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>undefined method `fqdn' for nil:NilClass</pre>
</div>
</div>
</dd>
<dt class="hdlist1">&lt;%  -%&gt;, &lt;%=  -%&gt;</dt>
<dd>
<p>By default, a newline character is inserted after a Ruby block if it is closed at the end of a line:</p>
<div class="paragraph">
<p>Example input:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;%= "line1" %&gt;
&lt;%= "line2" %&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Example rendering:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>line1
line2</pre>
</div>
</div>
<div class="paragraph">
<p>To change the default behavior, modify the enclosing mark with <code>-%&gt;</code>:</p>
</div>
<div class="paragraph">
<p>Example input:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;%= "line1" -%&gt;
&lt;%= "line2" %&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Example rendering:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>line1line2</pre>
</div>
</div>
<div class="paragraph">
<p>This is used to reduce the number of lines, where Ruby syntax permits, in rendered templates.
White spaces in ERB tags are ignored.</p>
</div>
<div class="paragraph">
<p>An example of how this would be used in a report template to remove unnecessary newlines between a FQDN and IP address:</p>
</div>
<div class="paragraph">
<p>Example input:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;%= @host.fqdn -%&gt;
&lt;%= @host.ip -%&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Example rendering:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"><em>host.example.com10.10.181.216</em></pre>
</div>
</div>
</dd>
<dt class="hdlist1">&lt;%#  %&gt;</dt>
<dd>
<p>Encloses a comment that is ignored during template rendering:</p>
<div class="paragraph">
<p>Example input:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;%# A comment %&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>This generates no output.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="Troubleshooting_ERB_Templates_managing-hosts"><a class="anchor" href="#Troubleshooting_ERB_Templates_managing-hosts"></a>Troubleshooting ERB templates</h3>
<div class="paragraph _abstract">
<p>You can use the Foreman web UI to troubleshoot ERB templates.</p>
</div>
<div class="paragraph">
<p>The Foreman web UI provides two ways to verify the template rendering for a specific host:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Directly in the template editor</strong> – when editing a template (under <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Partition tables</strong>, <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Provisioning Templates</strong>, or <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Job templates</strong>), on the <strong>Template</strong> tab click <strong>Preview</strong> and select a host from the list.
The template then renders in the text field using the selected host&#8217;s parameters.
Preview failures can help to identify issues in your template.</p>
</li>
<li>
<p><strong>At the host&#8217;s details page</strong> – select a host at <strong>Hosts</strong> &gt; <strong>All Hosts</strong> and click the <strong>Templates</strong> tab to list templates associated with the host.
Select <strong>Review</strong> from the list next to the selected template to view it&#8217;s rendered version.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Generic_Project-specific_Macros_managing-hosts"><a class="anchor" href="#Generic_Project-specific_Macros_managing-hosts"></a>Generic Foreman-specific macros</h3>
<div class="paragraph _abstract">
<p>This section lists Foreman-specific macros for ERB templates.
You can use the macros listed in the following table across all kinds of templates.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Generic macros</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">indent(n)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indents the block of code by n spaces, useful when using a snippet template that is not indented.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">foreman_url(kind)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the full URL to host-rendered templates of the given kind.
For example, templates of the "provision" type usually reside at <code>http://foreman.example.com/unattended/provision</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">snippet(name)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Renders the specified snippet template.
Useful for nesting provisioning templates.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">snippets(file)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Renders the specified snippet found in the Foreman database, attempts to load it from the <code>unattended/snippets/</code> directory if it is not found in the database.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">snippet_if_exists(name)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Renders the specified snippet, skips if no snippet with the specified name is found.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="Template_Macros_managing-hosts"><a class="anchor" href="#Template_Macros_managing-hosts"></a>Template macros</h3>
<div class="paragraph _abstract">
<p>If you want to write custom templates, you can use some of the following macros.
For more information about the available macros for report templates, in the Foreman web UI, navigate to <strong>Monitor</strong> &gt; <strong>Reports</strong> &gt; <strong>Report Templates</strong>, and click <strong>Create Template</strong>.
In the Create Template window, click the <strong>Help</strong> tab.</p>
</div>
<div class="paragraph">
<p>For more information about the available macros for job templates, in the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Job templates</strong>, and click the <strong>New Job Template</strong>.
In the New Job Template window, click the <strong>Help</strong> tab.</p>
</div>
<div class="paragraph">
<p>Depending on the template type, some of the following macros have different requirements.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">input</dt>
<dd>
<p>Using the <code>input</code> macro, you can customize the input data that the template can work with.
You can define the input name, type, and the options that are available for users.
For report templates, you can only use user inputs.
When you define a new input and save the template, you can then reference the input in the ERB syntax of the template body.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">&lt;%= input('cpus') %&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>This loads the value from user input <code>cpus</code>.</p>
</div>
</dd>
<dt class="hdlist1">load_hosts</dt>
<dd>
<p>Using the <code>load_hosts</code> macro, you can generate a complete list of hosts.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">&lt;%- load_hosts().each_record do |host| -%&gt;
&lt;%=     host.name %&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Use the <code>load_hosts</code> macro with the <code>each_record</code> macro to load records in batches of 1000 to reduce memory consumption.</p>
</div>
<div class="paragraph">
<p>If you want to filter the list of hosts for the report, you can add the option <code>search: input('<em>Example_Host</em>')</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">&lt;% load_hosts(search: input('<em>Example_Host</em>')).each_record do |host| -%&gt;
&lt;%=  host.name %&gt;
&lt;% end -%&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, you first create an input that you then use to refine the search criteria that the <code>load_hosts</code> macro retrieves.</p>
</div>
</dd>
<dt class="hdlist1">report_row</dt>
<dd>
<p>Using the <code>report_row</code> macro, you can create a formatted report for ease of analysis.
The <code>report_row</code> macro requires the <code>report_render</code> macro to generate the output.</p>
<div class="paragraph">
<p>Example input:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">&lt;%- load_hosts(search: input('<em>Example_Host</em>')).each_record do |host| -%&gt;
&lt;%-   report_row(
        'Server FQDN': host.name
      ) -%&gt;
&lt;%- end -%&gt;
&lt;%= report_render -%&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Example rendering:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">Server FQDN
<em>host1.example.com</em>
<em>host2.example.com</em>
<em>host3.example.com</em>
<em>host4.example.com</em>
<em>host5.example.com</em>
<em>host6.example.com</em></pre>
</div>
</div>
<div class="paragraph">
<p>You can add extra columns to the report by adding another header.
The following example adds IP addresses to the report:</p>
</div>
<div class="paragraph">
<p>Example input:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">&lt;%- load_hosts(search: input('host')).each_record do |host| -%&gt;
&lt;%-   report_row(
      'Server FQDN': host.name,
           'IP': host.ip
      ) -%&gt;
&lt;%- end -%&gt;
&lt;%= report_render -%&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Example rendering:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">Server FQDN,IP
<em>host1.example.com</em>,<em>10.8.30.228</em>
<em>host2.example.com</em>,<em>10.8.30.227</em>
<em>host3.example.com</em>,<em>10.8.30.226</em>
<em>host4.example.com</em>,<em>10.8.30.225</em>
<em>host5.example.com</em>,<em>10.8.30.224</em>
<em>host6.example.com</em>,<em>10.8.30.223</em></pre>
</div>
</div>
</dd>
<dt class="hdlist1">report_render</dt>
<dd>
<div class="paragraph">
<p>This macro is available only for report templates.</p>
</div>
<div class="paragraph">
<p>Using the <code>report_render</code> macro, you create the output for the report.
During the template rendering process, you can select the format that you want for the report.
YAML, JSON, HTML, and CSV formats are supported.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">&lt;%= report_render -%&gt;</pre>
</div>
</div>
</dd>
<dt class="hdlist1">render_template()</dt>
<dd>
<div class="paragraph">
<p>This macro is available only for job templates.</p>
</div>
<div class="paragraph">
<p>Using this macro, you can render a specific template.
You can also enable and define arguments that you want to pass to the template.</p>
</div>
</dd>
<dt class="hdlist1">truthy</dt>
<dd>
<div class="paragraph">
<p>Using the <code>truthy</code> macro, you can declare if the value passed is true or false, regardless of whether the value is an integer or boolean or string.</p>
</div>
<div class="paragraph">
<p>This macro helps to avoid confusion when your template contains multiple value types.
For example, the boolean value <code>true</code> is not the same as the string value <code>"true"</code>.
With this macro, you can declare how you want the template to interpret the value and avoid confusion.</p>
</div>
<div class="paragraph">
<p>You can use <code>truthy</code> to declare values as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">truthy?("true") =&gt; true
truthy?(1) =&gt; true
truthy?("false") =&gt; false
truthy?(0) =&gt; false</pre>
</div>
</div>
</dd>
<dt class="hdlist1">falsy</dt>
<dd>
<div class="paragraph">
<p>The falsy macro serves the same purpose as the truthy macro.</p>
</div>
<div class="paragraph">
<p>Using the <code>falsy</code> macro, you can declare if the value passed in is true or false, regardless of whether the value is an integer or boolean or string.</p>
</div>
<div class="paragraph">
<p>You can use <code>falsy</code> to declare values as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>falsy?("true") =&gt; false
falsy?(1) =&gt; false
falsy?("false") =&gt; true
falsy?(0) =&gt; true</pre>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="Host_Specific_Variables_managing-hosts"><a class="anchor" href="#Host_Specific_Variables_managing-hosts"></a>Host-specific variables</h3>
<div class="paragraph _abstract">
<p>The following variables enable using host data within templates.</p>
</div>
<div class="paragraph">
<p>Note that job templates accept only <code>@host</code> variables.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Host-specific variables and macros</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.architecture</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The architecture of the host.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.bond_interfaces</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns an array of all bonded interfaces.
See <a href="#Parsing_Arrays_managing-hosts">Parsing arrays</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.capabilities</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The method of system provisioning, can be either build (for example Kickstart) or image.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.certname</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The SSL certificate name of the host.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.diskLayout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The disk layout of the host.
Can be inherited from the operating system.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.domain</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The domain of the host.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.environment</code> <strong>Deprecated</strong> Use the <code>host_puppet_environment</code> variable instead.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Puppet environment of the host.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.facts</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a Ruby hash of facts from Facter.
For example to access the 'ipaddress' fact from the output, specify @host.facts['ipaddress'].</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.grub_pass</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the host&#8217;s boot loader password.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.hostgroup</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The host group of the host.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>host_enc['parameters']</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a Ruby hash containing information on host parameters.
For example, use host_enc['parameters']['lifecycle_environment'] to get the lifecycle environment of a host.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.image_build?</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <code>true</code> if the host is provisioned using an image.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.interfaces</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains an array of all available host interfaces including the primary interface.
See <a href="#Parsing_Arrays_managing-hosts">Parsing arrays</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.interfaces_with_identifier('IDs')</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns array of interfaces with given identifier.
You can pass an array of multiple identifiers as an input, for example @host.interfaces_with_identifier(['eth0', 'eth1']).
See <a href="#Parsing_Arrays_managing-hosts">Parsing arrays</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.ip</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The IP address of the host.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.location</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The location of the host.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.mac</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The MAC address of the host.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.managed_interfaces</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns an array of managed interfaces (excluding BMC and bonded interfaces).
See <a href="#Parsing_Arrays_managing-hosts">Parsing arrays</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.medium</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The assigned operating system installation medium.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The full name of the host.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.operatingsystem.family</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The operating system family.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.operatingsystem.major</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The major version number of the assigned operating system.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.operatingsystem.minor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The minor version number of the assigned operating system.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.operatingsystem.name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The assigned operating system name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.operatingsystem.boot_files_uri(medium_provider)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Full path to the kernel and initrd, returns an array.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.os.medium_uri(@host)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The URI used for provisioning (path configured in installation media).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>host_param('parameter_name')</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the value of the specified host parameter.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>host_param_false?('parameter_name')</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <code>false</code> if the specified host parameter evaluates to false.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>host_param_true?('parameter_name')</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <code>true</code> if the specified host parameter evaluates to true.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.primary_interface</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the primary interface of the host.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.provider</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The compute resource provider.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.provision_interface</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the provisioning interface of the host.
Returns an interface object.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.ptable</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The partition table name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.puppet_ca_server</code> <strong>Deprecated</strong> Use the <code>host_puppet_ca_server</code> variable instead.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Puppet CA server the host must use.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.puppetmaster</code> <strong>Deprecated</strong> Use the <code>host_puppet_server</code> variable instead.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Puppet server the host must use.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.pxe_build?</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <code>true</code> if the host is provisioned using the network or PXE.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.shortname</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The short name of the host.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.sp_ip</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The IP address of the BMC interface.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.sp_mac</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The MAC address of the BMC interface.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.sp_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the BMC interface.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.sp_subnet</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The subnet of the BMC network.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.subnet.dhcp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <code>true</code> if a DHCP proxy is configured for this host.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.subnet.dns_primary</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The primary DNS server of the host.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.subnet.dns_secondary</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The secondary DNS server of the host.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.subnet.gateway</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The gateway of the host.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.subnet.mask</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The subnet mask of the host.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.url_for_boot(:initrd)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Full path to the initrd image associated with this host.
Not recommended, as it does not interpolate variables.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@host.url_for_boot(:kernel)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Full path to the kernel associated with this host.
Not recommended, as it does not interpolate variables, prefer boot_files_uri.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@provisioning_type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Equals to <code>host</code> or <code>hostgroup</code> depending on type of provisioning.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@static</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <code>true</code> if the network configuration is static.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@template_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the template being rendered.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>grub_pass</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a boot loader argument to set the encrypted boot loader password, such as <strong>--md5pass=#{@host.grub_pass}</strong>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ks_console</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a string assembled using the port and the baud rate of the host which can be added to a kernel line.
For example <strong>console=ttyS1,9600</strong>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>root_pass</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the root password configured for the system.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The majority of common Ruby methods can be applied on host-specific variables.
For example, to extract the last segment of the host&#8217;s IP address, you can use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;% @host.ip.split('.').last %&gt;</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Kickstart_Specific_Variables_managing-hosts"><a class="anchor" href="#Kickstart_Specific_Variables_managing-hosts"></a>Kickstart-specific variables</h3>
<div class="paragraph _abstract">
<p>The following variables are designed to be used within Kickstart provisioning templates.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Kickstart-specific variables</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@arch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The host architecture name, same as @host.architecture.name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@dynamic</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <code>true</code> if the partition table being used is a %pre script (has the #Dynamic option as the first line of the table).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@epel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A command which will automatically install the correct version of the epel-release RPM.
Use in a %post script.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@mediapath</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The full Kickstart line to provide the URL command.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@osver</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The operating system major version number, same as @host.operatingsystem.major.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="Conditional_Statements_managing-hosts"><a class="anchor" href="#Conditional_Statements_managing-hosts"></a>Conditional statements</h3>
<div class="paragraph _abstract">
<p>In your templates, you might perform different actions depending on which value exists.
To achieve this, you can use conditional statements in your ERB syntax.</p>
</div>
<div class="paragraph">
<p>In the following example, the ERB syntax searches for a specific host name and returns an output depending on the value it finds:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Example input:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">&lt;% load_hosts().each_record do |host| -%&gt;
&lt;% if @host.name == "<em>host1.example.com</em>" -%&gt;
&lt;%      result="positive" -%&gt;
&lt;%  else -%&gt;
&lt;%      result="negative" -%&gt;
&lt;%  end -%&gt;
&lt;%= result -%&gt;</pre>
</div>
</div>
</li>
<li>
<p>Example rendering:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"><em>host1.example.com</em>
positive</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Parsing_Arrays_managing-hosts"><a class="anchor" href="#Parsing_Arrays_managing-hosts"></a>Parsing arrays</h3>
<div class="paragraph _abstract">
<p>While writing or modifying templates, you might encounter variables that return arrays.
For example, host variables related to network interfaces, such as <code>@host.interfaces</code> or <code>@host.bond_interfaces</code>, return interface data grouped in an array.
To extract a parameter value of a specific interface, use Ruby methods to parse the array.</p>
</div>
<div class="paragraph">
<p>The following procedure is an example that you can use to find the relevant methods to parse arrays in your template.
In this example, a report template is used, but the steps are applicable to other templates.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>To retrieve the NIC of a host, in this example, using the <code>@host.interfaces</code> variable returns class values that you can then use to find methods to parse the array.</p>
<div class="paragraph">
<p>Example input:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;%= @host.interfaces -%&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Example rendering:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;Nic::Base::ActiveRecord_Associations_CollectionProxy:0x00007f734036fbe0&gt;</pre>
</div>
</div>
</li>
<li>
<p>In the Create Template window, click the <strong>Help</strong> tab and search for the <code>ActiveRecord_Associations_CollectionProxy</code> and <code>Nic::Base</code> classes.</p>
</li>
<li>
<p>For <code>ActiveRecord_Associations_CollectionProxy</code>, in the <strong>Allowed methods or members</strong> column, you can view the following methods to parse the array:</p>
<div class="listingblock">
<div class="content">
<pre>[] each find_in_batches first map size to_a</pre>
</div>
</div>
</li>
<li>
<p>For <code>Nic::Base</code>, in the <strong>Allowed methods or members</strong> column, you can view the following method to parse the array:</p>
<div class="listingblock">
<div class="content">
<pre>alias? attached_devices attached_devices_identifiers attached_to bond_options children_mac_addresses domain fqdn identifier inheriting_mac ip ip6 link mac managed? mode mtu nic_delay physical? primary provision shortname subnet subnet6 tag virtual? vlanid</pre>
</div>
</div>
</li>
<li>
<p>To iterate through an interface array, add the relevant methods to the ERB syntax:</p>
<div class="paragraph">
<p>Example input:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;% load_hosts().each_record do |host| -%&gt;
&lt;%    host.interfaces.each do |iface| -%&gt;
  iface.alias?: &lt;%= iface.alias? %&gt;
  iface.attached_to: &lt;%= iface.attached_to %&gt;
  iface.bond_options: &lt;%= iface.bond_options %&gt;
  iface.children_mac_addresses: &lt;%= iface.children_mac_addresses %&gt;
  iface.domain: &lt;%= iface.domain %&gt;
  iface.fqdn: &lt;%= iface.fqdn %&gt;
  iface.identifier: &lt;%= iface.identifier %&gt;
  iface.inheriting_mac: &lt;%= iface.inheriting_mac %&gt;
  iface.ip: &lt;%= iface.ip %&gt;
  iface.ip6: &lt;%= iface.ip6 %&gt;
  iface.link: &lt;%= iface.link %&gt;
  iface.mac: &lt;%= iface.mac %&gt;
  iface.managed?: &lt;%= iface.managed? %&gt;
  iface.mode: &lt;%= iface.mode %&gt;
  iface.mtu: &lt;%= iface.mtu %&gt;
  iface.physical?: &lt;%= iface.physical? %&gt;
  iface.primary: &lt;%= iface.primary %&gt;
  iface.provision: &lt;%= iface.provision %&gt;
  iface.shortname: &lt;%= iface.shortname %&gt;
  iface.subnet: &lt;%= iface.subnet %&gt;
  iface.subnet6: &lt;%= iface.subnet6 %&gt;
  iface.tag: &lt;%= iface.tag %&gt;
  iface.virtual?: &lt;%= iface.virtual? %&gt;
  iface.vlanid: &lt;%= iface.vlanid %&gt;
&lt;%- end -%&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Example rendering:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"><em>host1.example.com</em>
  iface.alias?: false
  iface.attached_to:
  iface.bond_options:
  iface.children_mac_addresses: []
  iface.domain:
  iface.fqdn: <em>host1.example.com</em>
  iface.identifier: ens192
  iface.inheriting_mac: 00:50:56:8d:4c:cf
  iface.ip: 10.10.181.13
  iface.ip6:
  iface.link: true
  iface.mac: 00:50:56:8d:4c:cf
  iface.managed?: true
  iface.mode: balance-rr
  iface.mtu:
  iface.physical?: true
  iface.primary: true
  iface.provision: true
  iface.shortname: <em>host1.example.com</em>
  iface.subnet:
  iface.subnet6:
  iface.tag:
  iface.virtual?: false
  iface.vlanid:</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Example_Template_Snippets_managing-hosts"><a class="anchor" href="#Example_Template_Snippets_managing-hosts"></a>Example template snippets</h3>
<div class="paragraph _abstract">
<p>Example template snippets show the correct ERB template syntax and common use cases.
You can use these snippets as a starting point when writing your own templates.</p>
</div>
<div class="exampleblock">
<div class="title">Example 5. Checking if a host has Puppet and Puppetlabs enabled</div>
<div class="content">
<div class="paragraph">
<p>The following example checks if the host has the Puppet and Puppetlabs repositories enabled:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;%
pm_set = @host.puppetmaster.empty? ? false : true
puppet_enabled = pm_set || host_param_true?('force-puppet')
puppetlabs_enabled = host_param_true?('enable-puppetlabs-repo')
%&gt;</pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 6. Capturing major and minor versions of a host&#8217;s operating system</div>
<div class="content">
<div class="paragraph">
<p>The following example shows how to capture the minor and major version of the host&#8217;s operating system, which can be used for package related decisions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;%
os_major = @host.operatingsystem.major.to_i
os_minor = @host.operatingsystem.minor.to_i
%&gt;

&lt;% if ((os_minor &lt; 2) &amp;&amp; (os_major &lt; 14)) -%&gt;
...
&lt;% end -%&gt;</pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 7. Importing snippets to a template</div>
<div class="content">
<div class="paragraph">
<p>The following example imports the <strong>subscription_manager_registration</strong> snippet to the template and indents it by four spaces:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;%= indent 4 do
snippet 'subscription_manager_registration'
end %&gt;</pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 8. Conditionally importing a Kickstart snippet</div>
<div class="content">
<div class="paragraph">
<p>The following example imports the <code>kickstart_networking_setup</code> snippet if the host&#8217;s subnet has the DHCP boot mode enabled:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;% subnet = @host.subnet %&gt;
&lt;% if subnet.respond_to?(:dhcp_boot_mode?) -%&gt;
&lt;%= snippet 'kickstart_networking_setup' %&gt;
&lt;% end -%&gt;</pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 9. Parsing values from host custom facts</div>
<div class="content">
<div class="paragraph">
<p>You can use the <code>host.facts</code> variable to parse values from a host&#8217;s facts and custom facts.
In this example <code>luks_stat</code> is a custom fact that you can parse in the same manner as <code>dmi::system::serial_number</code>, which is a host fact:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>'Serial': host.facts['dmi::system::serial_number'],
'Encrypted': host.facts['luks_stat'],</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, you can customize the Applicable Errata report template to parse for custom information about the kernel version of each host:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;%-     report_row(
          'Host': host.name,
          'Operating System': host.operatingsystem,
          'Kernel': host.facts['uname::release'],
          'Environment': host.single_lifecycle_environment ? host.single_lifecycle_environment.name : nil,
          'Erratum': erratum.errata_id,
          'Type': erratum.errata_type,
          'Published': erratum.issued,
          'Applicable since': erratum.created_at,
          'Severity': erratum.severity,
          'Packages': erratum.package_names,
          'CVEs': erratum.cves,
          'Reboot suggested': erratum.reboot_suggested,
        ) -%&gt;</pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Job_Template_Examples_and_Extensions_managing-hosts"><a class="anchor" href="#Job_Template_Examples_and_Extensions_managing-hosts"></a>Appendix C: Job template examples and extensions</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>Use this section as a reference to help modify, customize, and extend your job templates to suit your requirements.</p>
</div>
<div class="sect2">
<h3 id="Customizing_Job_Templates_managing-hosts"><a class="anchor" href="#Customizing_Job_Templates_managing-hosts"></a>Customizing job templates</h3>
<div class="paragraph _abstract">
<p>When creating a job template, you can include an existing template in the template editor field.
This way you can combine templates, or create more specific templates from the general ones.</p>
</div>
<div class="paragraph">
<p>The following template combines default templates to install and start the <strong>nginx</strong> service on clients:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">&lt;%= render_template 'Package Action - Script Default', :action =&gt; 'install', :package =&gt; 'nginx' %&gt;
&lt;%= render_template 'Service Action - Script Default', :action =&gt; 'start', :service_name =&gt; 'nginx' %&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above template specifies parameter values for the rendered template directly.
It is also possible to use the <strong>input()</strong> method to allow users to define input for the rendered template on job execution.
For example, you can use the following syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">&lt;%= render_template 'Package Action - Script Default', :action =&gt; 'install', :package =&gt; input("package") %&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>With the above template, you have to import the parameter definition from the rendered template.
To do so, navigate to the <strong>Jobs</strong> tab, click <strong>Add Foreign Input Set</strong>, and select the rendered template from the <strong>Target template</strong> list.
You can import all parameters or specify a comma separated list.</p>
</div>
</div>
<div class="sect2">
<h3 id="creating-a-job-template-to-restore-selinux-context"><a class="anchor" href="#creating-a-job-template-to-restore-selinux-context"></a>Creating a job template to restore SELinux context</h3>
<div class="paragraph _abstract">
<p>This example shows how to create a template called <strong>Run Command - restorecon</strong> that restores the default <strong>SELinux</strong> context for all files in the selected directory on target hosts.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Job templates</strong>.</p>
</li>
<li>
<p>Click <strong>New Job Template</strong>.</p>
</li>
<li>
<p>Enter <strong>Run Command - restorecon</strong> in the <strong>Name</strong> field.
Select <strong>Default</strong> to make the template available to all organizations.
Add the following text to the template editor:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">restorecon -RvF &lt;%= input("directory") %&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>&lt;%= input("directory") %&gt;</code> string is replaced by a user-defined directory during job invocation.</p>
</div>
</li>
<li>
<p>On the <strong>Job</strong> tab, set <strong>Job category</strong> to <code>Commands</code>.</p>
</li>
<li>
<p>Click <strong>Add Input</strong> to allow job customization.
Enter <code>directory</code> to the <strong>Name</strong> field.
The input name must match the value specified in the template editor.</p>
</li>
<li>
<p>Click <strong>Required</strong> so that the command cannot be executed without the user specified parameter.</p>
</li>
<li>
<p>Select <strong>User input</strong> from the <strong>Input type</strong> list.
Enter a description to be shown during job invocation, for example <code>Target directory for restorecon</code>.</p>
</li>
<li>
<p>Click <strong>Submit</strong>.
For more information, see <a href="#Executing_a_restorecon_Template_on_Multiple_Hosts_managing-hosts">Executing a restorecon template on multiple hosts</a>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Rendering_a_restorecon_Template_managing-hosts"><a class="anchor" href="#Rendering_a_restorecon_Template_managing-hosts"></a>Rendering a restorecon template</h3>
<div class="paragraph _abstract">
<p>This example shows how to create a template derived from the <strong>Run command - restorecon</strong> template created in <a href="#creating-a-job-template-to-restore-selinux-context">Creating a job template to restore SELinux context</a>.</p>
</div>
<div class="paragraph">
<p>This template does not require user input on job execution, it will restore the SELinux context in all files under the <code>/home/</code> directory on target hosts.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Create a new template as described in <a href="#customizing-job-templates">Customizing job templates</a>, and specify the following string in the template editor:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">&lt;%= render_template("Run Command - restorecon", :directory =&gt; "/home") %&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Executing_a_restorecon_Template_on_Multiple_Hosts_managing-hosts"><a class="anchor" href="#Executing_a_restorecon_Template_on_Multiple_Hosts_managing-hosts"></a>Executing a restorecon template on multiple hosts</h3>
<div class="paragraph _abstract">
<p>This example shows how to run a job based on the template created in <a href="#creating-a-job-template-to-restore-selinux-context">Creating a job template to restore SELinux context</a> on multiple hosts.
The job restores the SELinux context in all files under the <code>/home/</code> directory.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Monitor</strong> &gt; <strong>Jobs</strong> and click <strong>Run job</strong>.</p>
</li>
<li>
<p>Select <strong>Commands</strong> as <strong>Job category</strong> and <strong>Run Command &#8211; restorecon</strong> as <strong>Job template</strong> and click <strong>Next</strong>.</p>
</li>
<li>
<p>Select the hosts on which you want to run the job.
If you do not select any hosts, the job will run on all hosts you can see in the current context.</p>
</li>
<li>
<p>In the <strong>directory</strong> field, provide a directory, for example <code>/home</code>, and click <strong>Next</strong>.</p>
</li>
<li>
<p>Optional: To configure advanced settings for the job, fill in the <strong>Advanced fields</strong>.
To learn more about advanced settings, see <a href="#advanced-settings-in-the-job-wizard_managing-hosts">Advanced settings in the job wizard</a>.
When you are done entering the advanced settings or if it is not required, click <strong>Next</strong>.</p>
</li>
<li>
<p>Schedule time for the job.</p>
<div class="ulist">
<ul>
<li>
<p>To execute the job immediately, keep the pre-selected <strong>Immediate execution</strong>.</p>
</li>
<li>
<p>To execute the job in future time, select <strong>Future execution</strong>.</p>
</li>
<li>
<p>To execute the job on regular basis, select <strong>Recurring execution</strong>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Optional: If you selected future or recurring execution, select the <strong>Query type</strong>, otherwise click <strong>Next</strong>.</p>
<div class="ulist">
<ul>
<li>
<p><strong>Static query</strong> means that the job executes on the exact list of hosts that you provided.</p>
</li>
<li>
<p><strong>Dynamic query</strong> means that the list of hosts is evaluated just before the job is executed.
If you entered the list of hosts based on some filter, the results can be different from when you first used that filter.</p>
<div class="paragraph">
<p>Click <strong>Next</strong> after you have selected the query type.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Optional: If you selected future or recurring execution, provide additional details:</p>
<div class="ulist">
<ul>
<li>
<p>For <strong>Future execution</strong>, enter the <strong>Starts at</strong> date and time.
You also have the option to select the <strong>Starts before</strong> date and time.
If the job cannot start before that time, it will be canceled.</p>
</li>
<li>
<p>For <strong>Recurring execution</strong>, select the start date and time, frequency, and condition for ending the recurring job.
You can choose the recurrence to never end, end at a certain time, or end after a given number of repetitions.
You can also add <strong>Purpose</strong> - a special label for tracking the job.
There can only be one active job with a given purpose at a time.</p>
<div class="paragraph">
<p>Click <strong>Next</strong> after you have entered the required information.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Review job details.
You have the option to return to any part of the job wizard and edit the information.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to schedule the job for execution.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Including_Power_Actions_in_Templates_managing-hosts"><a class="anchor" href="#Including_Power_Actions_in_Templates_managing-hosts"></a>Including power actions in templates</h3>
<div class="paragraph _abstract">
<p>This example shows how to set up a job template for performing power actions, such as reboot.
This procedure prevents Foreman from interpreting the disconnect exception upon reboot as an error, and consequently, remote execution of the job works correctly.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Create a new template as described in <a href="#customizing-job-templates">Customizing job templates</a>, and specify the following string in the template editor:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">&lt;%= render_template("Power Action - Script Default", :action =&gt; "restart") %&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Host_Parameter_Hierarchy_managing-hosts"><a class="anchor" href="#Host_Parameter_Hierarchy_managing-hosts"></a>Appendix D: Host parameter hierarchy</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>You can access host parameters when provisioning hosts.</p>
</div>
<div class="paragraph">
<p>Hosts inherit their parameters from the following locations, in order of increasing precedence:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter Level</th>
<th class="tableblock halign-left valign-top">Set in Foreman web UI</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Globally defined parameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Configure</strong> &gt; <strong>Global parameters</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Organization-level parameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Administer</strong> &gt; <strong>Organizations</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Location-level parameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Administer</strong> &gt; <strong>Locations</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Domain-level parameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Infrastructure</strong> &gt; <strong>Domains</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Subnet-level parameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Infrastructure</strong> &gt; <strong>Subnets</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operating system-level parameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Hosts</strong> &gt; <strong>Provisioning Setup</strong> &gt; <strong>Operating Systems</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Host group-level parameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Configure</strong> &gt; <strong>Host Groups</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Host parameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Hosts</strong> &gt; <strong>All Hosts</strong></p></td>
</tr>
</tbody>
</table>
<!-- "Fork me on GitHub" CSS ribbon v0.2.3 | MIT License -->
<!-- https://github.com/simonwhitaker/github-fork-ribbon-css -->
<a class="release-ribbon right-top fixed" data-ribbon="Pre-release version" title="Pre-release version">
Pre-release version
</a>
<a class="issue-ribbon right-bottom fixed" href="https://github.com/theforeman/foreman-documentation/issues/new?template=report-issue.md" data-ribbon="Report issue" title="Report issue">
Report issue
</a>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version Nightly<br>
Last updated Feb 2026
</div>
</div>
<script>
;(function () { /*! Asciidoctor Tabs | Copyright (c) 2018-present Dan Allen | MIT License */
  'use strict'

  var config = (document.currentScript || {}).dataset || {}
  var forEach = Array.prototype.forEach

  init(document.querySelectorAll('.tabs'))

  function init (tabsBlocks) {
    if (!tabsBlocks.length) return
    forEach.call(tabsBlocks, function (tabs) {
      var syncIds = tabs.classList.contains('is-sync') ? {} : undefined
      var tablist = tabs.querySelector('.tablist ul')
      tablist.setAttribute('role', 'tablist')
      var start
      forEach.call(tablist.querySelectorAll('li'), function (tab, idx) {
        tab.tabIndex = -1
        tab.setAttribute('role', tab.classList.add('tab') || 'tab')
        var id, anchor, syncId
        if (!(id = tab.id) && (anchor = tab.querySelector('a[id]'))) {
          id = tab.id = anchor.parentNode.removeChild(anchor).id
        }
        var panel = id && tabs.querySelector('.tabpanel[aria-labelledby~="' + id + '"]')
        if (!panel) return idx ? undefined : toggleSelected(tab, true) // invalid state
        syncIds && (((syncId = tab.textContent.trim()) in syncIds) ? (syncId = undefined) : true) &&
          (syncIds[(tab.dataset.syncId = syncId)] = tab)
        idx || (syncIds && (start = { tab: tab, panel: panel })) ? toggleHidden(panel, true) : toggleSelected(tab, true)
        tab.setAttribute('aria-controls', panel.id)
        panel.setAttribute('role', 'tabpanel')
        var onClick = syncId === undefined ? activateTab : activateTabSync
        tab.addEventListener('click', onClick.bind({ tabs: tabs, tab: tab, panel: panel }))
      })
      if (!tabs.closest('.tabpanel')) {
        forEach.call(tabs.querySelectorAll('.tabpanel table.tableblock'), function (table) {
          var container = Object.assign(document.createElement('div'), { className: 'tablecontainer' })
          table.parentNode.insertBefore(container, table).appendChild(table)
        })
      }
      if (start) {
        var syncGroupId
        for (var i = 0, lst = tabs.classList, len = lst.length, className; i !== len; i++) {
          if (!(className = lst.item(i)).startsWith('data-sync-group-id=')) continue
          tabs.dataset.syncGroupId = syncGroupId = lst.remove(className) || className.slice(19).replace(/\u00a0/g, ' ')
          break
        }
        if (syncGroupId === undefined) tabs.dataset.syncGroupId = syncGroupId = Object.keys(syncIds).sort().join('|')
        var preferredSyncId = 'syncStorageKey' in config &&
          window[(config.syncStorageScope || 'local') + 'Storage'].getItem(config.syncStorageKey + '-' + syncGroupId)
        var tab = preferredSyncId && syncIds[preferredSyncId]
        tab && Object.assign(start, { tab: tab, panel: document.getElementById(tab.getAttribute('aria-controls')) })
        toggleSelected(start.tab, true) || toggleHidden(start.panel, false)
      }
    })
    onHashChange()
    toggleClassOnEach(tabsBlocks, 'is-loading', 'remove')
    window.setTimeout(toggleClassOnEach.bind(null, tabsBlocks, 'is-loaded', 'add'), 0)
    window.addEventListener('hashchange', onHashChange)
  }

  function activateTab (e) {
    var tab = this.tab
    var tabs = this.tabs || (this.tabs = tab.closest('.tabs'))
    var panel = this.panel || (this.panel = document.getElementById(tab.getAttribute('aria-controls')))
    querySelectorWithSiblings(tabs, '.tablist .tab', 'tab').forEach(function (el) {
      toggleSelected(el, el === tab)
    })
    querySelectorWithSiblings(tabs, '.tabpanel', 'tabpanel').forEach(function (el) {
      toggleHidden(el, el !== panel)
    })
    if (!this.isSync && 'syncStorageKey' in config && 'syncGroupId' in tabs.dataset) {
      var storageKey = config.syncStorageKey + '-' + tabs.dataset.syncGroupId
      window[(config.syncStorageScope || 'local') + 'Storage'].setItem(storageKey, tab.dataset.syncId)
    }
    if (!e) return
    var loc = window.location
    var hashIdx = loc.hash ? loc.href.indexOf('#') : -1
    if (~hashIdx) window.history.replaceState(null, '', loc.href.slice(0, hashIdx))
    e.preventDefault()
  }

  function activateTabSync (e) {
    activateTab.call(this, e)
    var thisTabs = this.tabs
    var thisTab = this.tab
    var initialY = thisTabs.getBoundingClientRect().y
    forEach.call(document.querySelectorAll('.tabs'), function (tabs) {
      if (tabs === thisTabs || tabs.dataset.syncGroupId !== thisTabs.dataset.syncGroupId) return
      querySelectorWithSiblings(tabs, '.tablist .tab', 'tab').forEach(function (tab) {
        if (tab.dataset.syncId === thisTab.dataset.syncId) activateTab.call({ tabs: tabs, tab: tab, isSync: true })
      })
    })
    var shiftedBy = thisTabs.getBoundingClientRect().y - initialY
    if (shiftedBy && (shiftedBy = Math.round(shiftedBy))) window.scrollBy({ top: shiftedBy, behavior: 'instant' })
  }

  function querySelectorWithSiblings (scope, selector, siblingClass) {
    var el = scope.querySelector(selector)
    if (!el) return []
    var result = [el]
    while ((el = el.nextElementSibling) && el.classList.contains(siblingClass)) result.push(el)
    return result
  }

  function toggleClassOnEach (elements, className, method) {
    forEach.call(elements, function (el) {
      el.classList[method](className)
    })
  }

  function toggleHidden (el, state) {
    el.classList[(el.hidden = state) ? 'add' : 'remove']('is-hidden')
  }

  function toggleSelected (el, state) {
    el.setAttribute('aria-selected', '' + state)
    el.classList[state ? 'add' : 'remove']('is-selected')
    el.tabIndex = state ? 0 : -1
  }

  function onHashChange () {
    var id = window.location.hash.slice(1)
    if (!id) return
    var tab = document.getElementById(~id.indexOf('%') ? decodeURIComponent(id) : id)
    if (!(tab && tab.classList.contains('tab'))) return
    'syncId' in tab.dataset ? activateTabSync.call({ tab: tab }) : activateTab.call({ tab: tab })
  }
})()
</script>
</body>
</html>