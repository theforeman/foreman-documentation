<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.18">
<title>Upgrading and Updating Foreman</title>
<style>
*,::before,::after{box-sizing:border-box}html{font-size:100%;-webkit-text-size-adjust:100%}body{background:#fff;color:rgba(0,0,0,0.8);padding:0;margin:0;font-family:"Noto Serif", "DejaVu Serif", serif;font-size:inherit;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,pre,p,blockquote,th,td{margin:0;padding:0}a{background:none;color:#2156a5;text-decoration:underline;line-height:inherit}a:active,a:hover{cursor:pointer;outline:0}a:focus{outline:thin dotted}a:hover,a:focus{color:#1d4b8f}abbr{font-size:0.9em}abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}b,strong{font-weight:bold;line-height:inherit}strong strong{font-weight:400}code,kbd,pre{font-family:"Droid Sans Mono", "DejaVu Sans Mono", monospace;font-size:1em}code{font-weight:400;color:rgba(0,0,0,0.9)}pre{color:rgba(0,0,0,0.9);line-height:1.45;text-rendering:optimizeSpeed;white-space:pre-wrap}dfn{font-style:italic}em,i{font-style:italic;line-height:inherit}em em{font-style:normal}hr{border:solid #dddddf;border-width:1px 0 0;clear:both;height:0;margin:1.25em 0 1.1875em}mark{background:#ff0;color:#000}p{line-height:1.6;margin-bottom:1.25rem;text-rendering:optimizeLegibility}q{quotes:"\201C" "\201D" "\2018" "\2019"}small{font-size:60%;line-height:inherit}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-0.5em}sub{bottom:-0.25em}img,object[type^="image/"],svg{display:inline-block;height:auto;max-width:100%;vertical-align:middle}img{border:0;-ms-interpolation-mode:bicubic}object{max-width:100%}svg:not(:root){overflow:hidden}figure{margin:0}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}.left{float:left !important}.right{float:right !important}.text-left{text-align:left !important}.text-right{text-align:right !important}.text-center{text-align:center !important}.text-justify{text-align:justify !important}.hide{display:none}.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:0.25em}p aside{font-size:.875em;line-height:1.35;font-style:italic}h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans", "DejaVu Sans", sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.2;word-spacing:-0.05em}h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{color:#e99b8f;line-height:0}h1{font-size:2.125em}h2{font-size:1.6875em}h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}h4,h5{font-size:1.125em}h6{font-size:1em}ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}ul,ol{margin-left:1.5em}ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}ul.square{list-style-type:square}ul.circle{list-style-type:circle}ul.disc{list-style-type:disc}ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}dl dt{margin-bottom:.3125em;font-weight:bold}dl dd{margin-bottom:1.25em;margin-left:1.125em}blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,0.85)}@media screen and (min-width: 768px){h1{font-size:2.75em}h2{font-size:2.3125em}h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}h4{font-size:1.4375em}}table{background:#fff;border:1px solid #dedede;border-collapse:collapse;border-spacing:0;margin-bottom:1.25em;word-wrap:normal}table thead,table tfoot{background:#f7f8f7}table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,0.8);text-align:left}table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,0.8)}table tr.even,table tr.alt{background:#f8f8f7}table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}.center{margin-left:auto;margin-right:auto}.stretch{width:100%}.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:"";display:table}.clearfix::after,.float-group::after{clear:both}:not(pre).nobreak{word-wrap:normal}:not(pre).nowrap{white-space:nowrap}:not(pre).pre-wrap{white-space:pre-wrap}:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal !important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}pre>code{display:block}pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}.keyseq{color:rgba(51,51,51,0.8)}kbd{display:inline-block;color:rgba(0,0,0,0.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,0.2),inset 0 0 0 0.1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}.keyseq kbd:first-child{margin-left:0}.keyseq kbd:last-child{margin-right:0}.menuseq,.menuref{color:#000}.menuseq b:not(.caret),.menuref{font-weight:inherit}.menuseq{word-spacing:-0.02em}.menuseq b.caret{font-size:1.25em;line-height:0.8}.menuseq i.caret{font-weight:bold;text-align:center;width:0.45em}b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}b.button::before{content:"[";padding:0 3px 0 2px}b.button::after{content:"]";padding:0 2px 0 3px}p a>code:hover{color:rgba(0,0,0,0.9)}body>div[id]{margin:0 auto;max-width:62.5em;position:relative;padding-left:.9375em;padding-right:.9375em;width:100%}body>div[id]::before,body>div[id]::after,#content #footnotes::before{content:"";display:table;clear:both}#content{margin-top:1.25em;margin-bottom:0.625em}#content::before{content:none}#header>h1:first-child{color:rgba(0,0,0,0.85);margin-top:2.25rem;margin-bottom:0}#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,0.6);display:flex;flex-flow:row wrap}#header .details span:first-child{margin-left:-0.125em}#header .details span.email a{color:rgba(0,0,0,0.85)}#header .details br{display:none}#header .details br+span::before{content:"\00a0\2013\00a0"}#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,0.85)}#header .details br+span#revremark::before{content:"\00a0|\00a0"}#header #revnumber{text-transform:capitalize}#header #revnumber::after{content:"\00a0"}#content>h1:first-child:not([class]){color:rgba(0,0,0,0.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}#toc{border-bottom:1px solid #e7e7e9;padding-bottom:0.5em}#toc>ul{margin-left:0.125em}#toc ul.sectlevel0>li>a{font-style:italic}#toc ul.sectlevel0 ul.sectlevel1{margin:0.5em 0}#toc ul{font-family:"Open Sans", "DejaVu Sans", sans-serif;list-style-type:none}#toc li{line-height:1.3334;margin-top:0.3334em}#toc a{text-decoration:none}#toc a:active{text-decoration:underline}#toctitle{color:#7a2518;font-size:1.2em}@media screen and (min-width: 768px){#toctitle{font-size:1.375em}body.toc2{padding-left:15em;padding-right:0}#toc.toc2{margin-top:0 !important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0 !important;border-bottom-width:0 !important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}#toc.toc2>ul{font-size:.9em;margin-bottom:0}#toc.toc2 ul ul{margin-left:0;padding-left:1em}#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:0.5em}body.toc2.toc-right{padding-left:0;padding-right:15em}body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}@media screen and (min-width: 1280px){body.toc2{padding-left:20em;padding-right:0}#toc.toc2{width:20em}#toc.toc2 #toctitle{font-size:1.375em}#toc.toc2>ul{font-size:0.95em}#toc.toc2 ul ul{padding-left:1.25em}body.toc2.toc-right{padding-left:0;padding-right:20em}}#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}#content #toc>:first-child{margin-top:0}#content #toc>:last-child{margin-bottom:0}#footer{max-width:none;background:#025d8c;padding:1.25em}#footer-text{color:rgba(255,255,255,0.8);line-height:1.44}.sect1{padding-bottom:0.625em}@media screen and (min-width: 768px){#content{margin-bottom:1.25em}.sect1{padding-bottom:1.25em}}.sect1:last-child{padding-bottom:0}.sect1+.sect1{border-top:1px solid #e7e7e9}#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none !important;visibility:hidden;text-align:center;font-weight:400}#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:0.1em}#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}details{margin-left:1.25rem}details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}details>summary::-webkit-details-marker{display:none}details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif", "DejaVu Serif", serif;font-size:1rem;font-style:italic}table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,0.85)}.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}.admonitionblock>table td.icon{text-align:center;width:80px}.admonitionblock>table td.icon img{max-width:none}.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans", "DejaVu Sans", sans-serif;text-transform:uppercase}.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,0.6);word-wrap:anywhere}.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}.exampleblock>.content{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#fffef7;border-radius:4px;box-shadow:0 1px 4px #e0e0dc}.exampleblock>.content>:first-child{margin-top:0}.exampleblock>.content>:last-child{margin-bottom:0}.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}.sidebarblock>:first-child{margin-top:0}.sidebarblock>:last-child{margin-bottom:0}.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:0.8125em}@media screen and (min-width: 768px){.literalblock pre,.listingblock>.content>pre{font-size:0.90625em}}@media screen and (min-width: 1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,0.9)}.listingblock>.content{position:relative}.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:0.5}.listingblock:hover code[data-lang]::before{display:block}.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:0.5}.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}.listingblock pre.highlightjs{padding:0}.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}.listingblock pre.prettyprint{border-width:0}.prettyprint{background:#f7f7f8}pre.prettyprint .linenums{line-height:1.45;margin-left:2em}pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}pre.prettyprint li code[data-lang]::before{opacity:1}pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}table.linenotable td.code{padding-left:0.75em}table.linenotable td.linenos{width:0.01%}table.linenotable td.linenos,pre.pygments .linenos,pre.rouge .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}pre.pygments span.linenos,pre.rouge span.linenos{display:inline-block;margin-right:0.75em}.quoteblock{margin:0 1em 1.25em 1.5em;display:table}.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:0.75em}.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,0.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}.quoteblock blockquote{margin:0;padding:0;border:0}.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,0.1)}.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}.verseblock{margin:0 1em 1.25em}.verseblock pre{font-family:"Open Sans", "DejaVu Sans", sans-serif;font-size:1.15rem;color:rgba(0,0,0,0.85);font-weight:300;text-rendering:optimizeLegibility}.verseblock pre strong{font-weight:400}.verseblock .attribution{margin-top:1.25rem;margin-left:0.5ex}.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}.quoteblock .attribution br,.verseblock .attribution br{display:none}.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,0.6)}.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}.quoteblock.abstract{margin:0 1em 1.25em;display:block}.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:0.25em solid #dddddf}.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}p.tableblock:last-child{margin-bottom:0}td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}td.tableblock>.content>:last-child{margin-bottom:-1.25em}table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}table.grid-all>*>tr>*{border-width:1px}table.grid-cols>*>tr>*{border-width:0 1px}table.grid-rows>*>tr>*{border-width:1px 0}table.frame-all{border-width:1px}table.frame-ends{border-width:1px 0}table.frame-sides{border-width:0 1px}table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}th.halign-left,td.halign-left{text-align:left}th.halign-right,td.halign-right{text-align:right}th.halign-center,td.halign-center{text-align:center}th.valign-top,td.valign-top{vertical-align:top}th.valign-bottom,td.valign-bottom{vertical-align:bottom}th.valign-middle,td.valign-middle{vertical-align:middle}table thead th,table tfoot th{font-weight:bold}tbody tr th{background:#f7f8f7}tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,0.8);font-weight:bold}p.tableblock>code:only-child{background:none;padding:0}p.tableblock{font-size:1em}ol{margin-left:1.75em}ul li ol{margin-left:1.5em}dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:0.625em}ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:0.625em}ul.unstyled,ol.unstyled{margin-left:0}li>p:empty:only-child::before{content:"";display:inline-block}ul.checklist>li>p:first-child{margin-left:-1em}ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:0.125em}ul.checklist>li>p:first-child>input[type=checkbox]:first-child{font:inherit;margin:0 .25em 0 0;padding:0}ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 0.625em -1.25em}ul.inline>li{margin-left:1.25em}.unstyled dl dt{font-weight:400;font-style:normal}ol.arabic{list-style-type:decimal}ol.decimal{list-style-type:decimal-leading-zero}ol.loweralpha{list-style-type:lower-alpha}ol.upperalpha{list-style-type:upper-alpha}ol.lowerroman{list-style-type:lower-roman}ol.upperroman{list-style-type:upper-roman}ol.lowergreek{list-style-type:lower-greek}.hdlist>table,.colist>table{border:0;background:none}.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}td.hdlist1,td.hdlist2{vertical-align:top;padding:0 0.625em}td.hdlist1{font-weight:bold;padding-bottom:1.25em}td.hdlist2{word-wrap:anywhere}.literalblock+.colist,.listingblock+.colist{margin-top:-0.5em}.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}.colist td:not([class]):first-child img{max-width:none}.colist td:not([class]):last-child{padding:0.25em 0}.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}.imageblock.left{margin:0.25em 0.625em 1.25em 0}.imageblock.right{margin:0.25em 0 1.25em 0.625em}.imageblock>.title{margin-bottom:0}.imageblock.thumb,.imageblock.th{border-width:6px}.imageblock.thumb>.title,.imageblock.th>.title{padding:0 0.125em}.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}.image.left{margin-right:0.625em}.image.right{margin-left:0.625em}a.image{text-decoration:none;display:inline-block}a.image object{pointer-events:none}sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}sup.footnote a,sup.footnoteref a{text-decoration:none}sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:0.625em}#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:0.2em}#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}#footnotes .footnote:last-of-type{margin-bottom:0}#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:0.75em 0}div.page-break{display:none}div.unbreakable{page-break-inside:avoid}.big{font-size:larger}.small{font-size:smaller}.underline{text-decoration:underline}.overline{text-decoration:overline}.line-through{text-decoration:line-through}.aqua{color:#00bfbf}.aqua-background{background:#00fafa}.black{color:#000}.black-background{background:#000}.blue{color:#0000bf}.blue-background{background:#0000fa}.fuchsia{color:#bf00bf}.fuchsia-background{background:#fa00fa}.gray{color:#606060}.gray-background{background:#7d7d7d}.green{color:#006000}.green-background{background:#007d00}.lime{color:#00bf00}.lime-background{background:#00fa00}.maroon{color:#600000}.maroon-background{background:#7d0000}.navy{color:#000060}.navy-background{background:#00007d}.olive{color:#606000}.olive-background{background:#7d7d00}.purple{color:#600060}.purple-background{background:#7d007d}.red{color:#bf0000}.red-background{background:#fa0000}.silver{color:#909090}.silver-background{background:#bcbcbc}.teal{color:#006060}.teal-background{background:#007d7d}.white{color:#bfbfbf}.white-background{background:#fafafa}.yellow{color:#bfbf00}.yellow-background{background:#fafa00}span.icon>.fa{cursor:default}a span.icon>.fa{cursor:inherit}.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,0.5);cursor:default}.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,0.8);color:#111}.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}.conum[data-value]{display:inline-block;color:#fff !important;background:rgba(0,0,0,0.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans", "DejaVu Sans", sans-serif;font-style:normal;font-weight:bold}.conum[data-value] *{color:#fff !important}.conum[data-value]+b{display:none}.conum[data-value]::after{content:attr(data-value)}pre .conum[data-value]{position:relative;top:-0.125em}b.conum *{color:inherit !important}.conum:not([data-value]):empty{display:none}dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}h1,h2,p,td.content,span.alt,summary{letter-spacing:-0.01em}p strong,td.content strong,div.footnote strong{letter-spacing:-0.005em}p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}.print-only{display:none !important}@page{margin:1.25cm 0.75cm}@media print{*{box-shadow:none !important;text-shadow:none !important}html{font-size:80%}a{color:inherit !important;text-decoration:underline !important}a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none !important}a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:0.25em}abbr[title]{border-bottom:1px dotted}abbr[title]::after{content:" (" attr(title) ")"}pre,blockquote,tr,img,object,svg{page-break-inside:avoid}thead{display:table-header-group}p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}body>div[id]{max-width:none}#toc,.sidebarblock,.exampleblock>.content{background:none !important}#toc{border-bottom:1px solid #dddddf !important;padding-bottom:0 !important}body.book #header{text-align:center}body.book #header>h1:first-child{border:0 !important;margin:2.5em 0 1em}body.book #header .details{border:0 !important;display:block;padding:0 !important}body.book #header .details span:first-child{margin-left:0 !important}body.book #header .details br{display:block}body.book #header .details br+span::before{content:none !important}body.book #toc{border:0 !important;text-align:left !important;padding:0 !important;margin:0 !important}body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}.listingblock code[data-lang]::before{display:block}div.page-break{display:block;page-break-after:always}#footer{padding:0 0.9375em}.hide-on-print{display:none !important}.print-only{display:block !important}.hide-for-print{display:none !important}.show-for-print{display:inherit !important}}@media amzn-kf8, print{#header>h1:first-child{margin-top:1.25rem}.sect1{padding:0 !important}.sect1+.sect1{border:0}#footer{background:none}#footer-text{color:rgba(0,0,0,0.6);font-size:0.9em}}@media amzn-kf8{body>div[id]{padding:0}}body{padding:0;margin:0;margin-top:70px !important}.container{position:relative;z-index:1;padding-top:50px;min-height:100%}.container p{font-family:sans-serif;font-size:1.2em}nav{position:fixed;z-index:9999;left:0;right:0;top:0;height:70px;padding:0 1.5em;background-color:#025d8c;font-family:sans-serif;line-height:70px}nav .logo{width:50px;vertical-align:middle}nav .nav-menu{position:absolute;right:0.3em;top:0;padding:0;margin:0;list-style:none}nav .nav-item{display:inline-block}nav .nav-item>a{display:inline-block;padding:0 2.5em;line-height:70px;color:#fff;text-decoration:none}nav .dropdown{position:relative}nav .dropdown a::after{content:"";display:inline-block;margin-left:0.5em;vertical-align:middle;border-top:0.3em solid #fff;border-right:0.3em solid transparent;border-left:0.3em solid transparent}nav .dropdown.show a::after{transform:rotate(180deg)}nav .dropdown-menu{display:none;position:absolute;left:0;right:0;top:100%;padding:0.5em 0;margin-top:-0.5em;border:1px solid rgba(0,0,0,0.3);border-radius:0.5em;background-color:#fff;width:max-content}nav .dropdown-menu-left{left:auto;right:0}nav .dropdown.show .dropdown-menu{display:block}nav .dropdown-div{display:block;padding:0.4em 0;line-height:4em}nav .dropdown-div a::after{content:none;margin-left:0;border-top:0;border-right:0;border-left:0}nav .dropdown-item{display:block;padding:0 1.5em;font-size:0.875em;color:#000;line-height:1.6em;text-decoration:none}nav .btn-hamburger{display:none;position:absolute;right:1.5em;top:50%;background-color:transparent;border:0;cursor:pointer;outline:none;transform:translateY(-50%)}nav .btn-hamburger span{display:block;width:30px;height:4px;background-color:#fff;margin:6px;border-radius:2px;transition:0.3s ease-in-out}nav .btn-hamburger span:nth-child(4),nav .btn-hamburger span:nth-child(5){position:absolute;top:10px;opacity:0.5}nav .btn-hamburger span:nth-child(4){transform:rotate(45deg) scale(0)}nav .btn-hamburger span:nth-child(5){transform:rotate(-45deg) scale(0)}nav.opened .btn-hamburger span:nth-child(4){opacity:1;transform:rotate(45deg) scale(1)}nav.opened .btn-hamburger span:nth-child(5){opacity:1;transform:rotate(-45deg) scale(1)}nav.opened .btn-hamburger span:nth-child(1),nav.opened .btn-hamburger span:nth-child(2),nav.opened .btn-hamburger span:nth-child(3){opacity:0}@media screen and (max-width: 768px){nav .nav-menu{position:fixed;left:0;right:0;top:70px;bottom:100%;display:flex;flex-direction:column;justify-content:start;background-color:#363d4e;transition:bottom 0.5s ease-in-out;overflow:hidden}nav.opened .nav-menu{bottom:0}nav .nav-item>a{display:block}nav .dropdown-menu{position:relative;top:0;margin:0 1.5em}nav .btn-hamburger{display:block}}@media screen{div.narrow{max-width:1080px;margin:0 auto !important;margin-top:70px auto !important;float:none !important}#toc.toc2{margin-top:70px !important}}

</style>
<!-- docinfo -->
</head>
<body class="book toc2 toc-left">
    <div id="wrap">
      <script src="/js/versions.js"></script>
      <script src="/js/nav.js"></script>
      <script>
        document.open();
        document.write(buildNavigation());
        addNavbarListeners();
        document.close();
      </script>
    </div>
<div id="header">
<h1>Upgrading and Updating Foreman</h1>
<div class="details">
<span id="revnumber">version 3.5 (unsupported),</span>
<span id="revdate">published Nov 29 2022</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#upgrading_overview">1. Upgrading Overview</a>
<ul class="sectlevel2">
<li><a href="#upgrading_prerequisites">1.1. Prerequisites</a></li>
<li><a href="#upgrade_paths">1.2. Upgrade Paths</a></li>
<li><a href="#following_the_progress_of_the_upgrade">1.3. Following the Progress of the Upgrade</a></li>
<li><a href="#Upgrading_Proxies_Separately_from_Server_upgrade-guide">1.4. Upgrading Smart&#160;Proxies Separately from Foreman</a></li>
</ul>
</li>
<li><a href="#upgrading_foreman">2. Upgrading Foreman</a>
<ul class="sectlevel2">
<li><a href="#Upgrading_Server_upgrade-guide">2.1. Upgrading Foreman&#160;server</a></li>
<li><a href="#upgrading_capsule_server">2.2. Upgrading Smart&#160;Proxy&#160;servers</a></li>
<li><a href="#Upgrading_the_External_Database_upgrade-guide">2.3. Upgrading the External Database</a></li>
<li><a href="#performing-post-upgrade-tasks_upgrade-guide">2.4. Performing Post-Upgrade Tasks</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In this guide, the terms upgrade, update, and migrate have the following meanings:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Upgrading</dt>
<dd>
<p>The process of advancing your Foreman&#160;server and Smart&#160;Proxy&#160;server installations from a y-stream release to the next, for example Foreman 3.4 to Foreman 3.5.
For more information, see <a href="#upgrading_overview">Upgrading Overview</a>.</p>
</dd>
<dt class="hdlist1">Updating</dt>
<dd>
<p>The process of advancing your Foreman&#160;server and Smart&#160;Proxy&#160;server installations from a z-stream release to the next, for example Foreman 3.5.0 to Foreman 3.5.1.</p>
</dd>
<dt class="hdlist1">Migrating</dt>
<dd>
<p>The process of moving an existing Foreman installation to a new instance.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="upgrading_overview"><a class="anchor" href="#upgrading_overview"></a>1. Upgrading Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Review prerequisites and available upgrade paths below before upgrading your current Foreman installation to Foreman 3.5.</p>
</div>
<div class="paragraph">
<p>Note that you can upgrade Smart&#160;Proxies separately from Foreman.
For more information, see <a href="#Upgrading_Proxies_Separately_from_Server_upgrade-guide">Upgrading Smart&#160;Proxies Separately from Foreman</a>.</p>
</div>
<div class="sect2">
<h3 id="upgrading_prerequisites"><a class="anchor" href="#upgrading_prerequisites"></a>1.1. Prerequisites</h3>
<div class="paragraph">
<p>Upgrading to Foreman 3.5 affects your entire Foreman infrastructure.
Before proceeding, complete the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Read the Foreman 3.5 <a href="https://docs.theforeman.org/3.5/Release_Notes/index-foreman-el.html#">Release Notes</a>.</p>
</li>
<li>
<p>Plan your upgrade path.
For more information, see <a href="#upgrade_paths">Upgrade Paths</a>.</p>
</li>
<li>
<p>Plan for the required downtime. Foreman services are shut down during the upgrade.
The upgrade process duration might vary depending on your hardware configuration, network speed, and the amount of data that is stored on the server.</p>
<div class="paragraph">
<p>Upgrading Foreman takes approximately 1&#8202;&#8211;&#8202;2 hours.</p>
</div>
<div class="paragraph">
<p>Upgrading Smart&#160;Proxy takes approximately 10&#8202;&#8211;&#8202;30 minutes.</p>
</div>
</li>
<li>
<p>Ensure that you have sufficient storage space on your server.
For more information, see <a href="https://docs.theforeman.org/3.5/Installing_Server/index-foreman-el.html#Preparing_your_Environment_for_Installation_foreman">Preparing your Environment for Installation</a> in <em>Installing Foreman 3.5 Server on RHEL/CentOS</em> and <a href="https://docs.theforeman.org/3.5/Installing_Proxy/index-foreman-el.html#preparing-environment-for-capsule-installation">Preparing your Environment for Installation</a> in <em>Installing Smart&#160;Proxy&#160;server</em>.</p>
</li>
<li>
<p>Back up your Foreman&#160;server and all Smart&#160;Proxy&#160;servers.
For more information, see <a href="https://docs.theforeman.org/3.5/Administering_Project/index-foreman-el.html#backing-up-foreman-server-and-smart-proxy_admin">Backing Up Foreman&#160;server and Smart&#160;Proxy&#160;server</a> in <em>Administering Foreman</em>.</p>
</li>
<li>
<p>Plan for updating any scripts you use that contain Foreman API commands because some API commands differ between versions of Foreman.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
If you customize configuration files, manually or use a tool such as Hiera, these customizations are overwritten when the installation script runs during upgrading or updating.
You can use the <code>--noop</code> option with the foreman-installer script to test for changes.
For more information, see the Red Hat Knowledgebase solution <a href="https://access.redhat.com/solutions/3351311">How to use the noop option to check for changes in Foreman config files during an upgrade.</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="upgrade_paths"><a class="anchor" href="#upgrade_paths"></a>1.2. Upgrade Paths</h3>
<div class="paragraph">
<p>You can upgrade to Foreman 3.5 from Foreman 3.4.</p>
</div>
<div class="paragraph">
<p>Foreman&#160;servers and Smart&#160;Proxy&#160;servers on earlier versions must first be upgraded to Foreman 3.4.
For more information, see the Foreman 3.4 Upgrade documentation.</p>
</div>
<div class="paragraph">
<div class="title">High-Level Upgrade Steps</div>
<p>The high-level steps in upgrading Foreman to 3.5 are as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Upgrade Foreman&#160;server to 3.5.
For more information, see <a href="#Upgrading_Server_upgrade-guide">Upgrading Foreman&#160;server</a>.</p>
</li>
<li>
<p>Upgrade all Smart&#160;Proxy&#160;servers to 3.5.
For more information, see <a href="#upgrading_capsule_server">Upgrading Smart&#160;Proxy&#160;servers</a>.</p>
</li>
<li>
<p>Continue with <a href="#performing-post-upgrade-tasks_upgrade-guide">Performing Post-Upgrade Tasks</a>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="following_the_progress_of_the_upgrade"><a class="anchor" href="#following_the_progress_of_the_upgrade"></a>1.3. Following the Progress of the Upgrade</h3>
<div class="paragraph">
<p>Because of the lengthy upgrade time, use a utility such as <code>tmux</code> to suspend and reattach a communication session.
You can then check the upgrade progress without staying connected to the command shell continuously.
For more information, see the <code>tmux</code> manual page.</p>
</div>
<div class="paragraph">
<p>If you lose connection to the command shell where the upgrade command is running you can see the logs in <code>/var/log/foreman-installer/foreman.log</code> to check if the process completed successfully.</p>
</div>
</div>
<div class="sect2">
<h3 id="Upgrading_Proxies_Separately_from_Server_upgrade-guide"><a class="anchor" href="#Upgrading_Proxies_Separately_from_Server_upgrade-guide"></a>1.4. Upgrading Smart&#160;Proxies Separately from Foreman</h3>
<div class="paragraph">
<p>You can upgrade Foreman to version 3.5 and keep Smart&#160;Proxies at version 3.4 until you have the capacity to upgrade them too.</p>
</div>
<div class="paragraph">
<p>All the functionality that worked previously works on 3.4 Smart&#160;Proxies.
However, the functionality added in the 3.5 release will not work until you upgrade Smart&#160;Proxies to 3.5.</p>
</div>
<div class="paragraph">
<p>Upgrading Smart&#160;Proxies after upgrading Foreman can be useful in the following example scenarios:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If you want to have several smaller outage windows instead of one larger window.</p>
</li>
<li>
<p>If Smart&#160;Proxies in your organization are managed by several teams and are located in different locations.</p>
</li>
<li>
<p>If you use a load-balanced configuration, you can upgrade one load-balanced Smart&#160;Proxy and keep other load-balanced Smart&#160;Proxies at one version lower.
This allows you to upgrade all Smart&#160;Proxies one after another without any outage.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="upgrading_foreman"><a class="anchor" href="#upgrading_foreman"></a>2. Upgrading Foreman</h2>
<div class="sectionbody">
<div id="introduction_upgrading_satellite" class="paragraph">
<p>Use the following procedures to upgrade your existing Foreman to Foreman 3.5:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Review <a href="#upgrading_prerequisites">Prerequisites</a>.</p>
</li>
<li>
<p><a href="#Upgrading_Server_upgrade-guide">Upgrading Foreman&#160;server</a></p>
</li>
<li>
<p><a href="#upgrading_capsule_server">Upgrading Smart&#160;Proxy&#160;servers</a></p>
</li>
<li>
<p><a href="#performing-post-upgrade-tasks_upgrade-guide">Performing Post-Upgrade Tasks</a></p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="Upgrading_Server_upgrade-guide"><a class="anchor" href="#Upgrading_Server_upgrade-guide"></a>2.1. Upgrading Foreman&#160;server</h3>
<div class="paragraph">
<p>This section describes how to upgrade Foreman&#160;server from 3.4 to 3.5.
You can upgrade from any minor version of Foreman&#160;server 3.4.</p>
</div>
<div id="upgrading_satellite_server_prerequisites" class="ulist">
<div class="title">Before You Begin</div>
<ul>
<li>
<p>Note that you can upgrade Smart&#160;Proxies separately from Foreman.
For more information, see <a href="#Upgrading_Proxies_Separately_from_Server_upgrade-guide">Upgrading Smart&#160;Proxies Separately from Foreman</a>.</p>
</li>
<li>
<p>Review and update your firewall configuration prior to upgrading your Foreman&#160;server.
For more information, see <a href="https://docs.theforeman.org/3.5/Installing_Server/index-foreman-el.html#Preparing_your_Environment_for_Installation_foreman">Preparing your environment for installation</a> in <em>Installing Foreman 3.5 Server on RHEL/CentOS</em>.</p>
</li>
<li>
<p>If you have edited any of the default templates, back up the files either by cloning or exporting them.
Cloning is the recommended method because that prevents them being overwritten in future updates or upgrades.
To confirm if a template has been edited, you can view its <strong>History</strong> before you upgrade or view the changes in the audit log after an upgrade.
In the Foreman web UI, navigate to <strong>Monitor</strong> &gt; <strong>Audits</strong> and search for the template to see a record of changes made.
If you use the export method, restore your changes by comparing the exported template and the default template, manually applying your changes.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Smart&#160;Proxy Considerations</div>
<ul>
<li>
<p>Note that Foreman&#160;server upgraded from 3.4 to 3.5 can use Smart&#160;Proxy&#160;servers still at 3.4.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">FIPS mode</div>
<p>You cannot upgrade Foreman&#160;server from a RHEL base system that is not operating in FIPS mode to a RHEL base system that is operating in FIPS mode.</p>
</div>
<div class="paragraph">
<p>To run Foreman&#160;server on a Red&#160;Hat Enterprise Linux base system operating in FIPS mode, you must install Foreman on a freshly provisioned RHEL base system operating in FIPS mode.
For more information, see <a href="https://docs.theforeman.org/3.5/Installing_Server/index-foreman-el.html#Preparing_your_Environment_for_Installation_foreman">Preparing your environment for installation</a> in <em>Installing Foreman 3.5 Server on RHEL/CentOS</em>.</p>
</div>
<div class="sect3">
<h4 id="upgrading_a_connected_satellite_server"><a class="anchor" href="#upgrading_a_connected_satellite_server"></a>2.1.1. Upgrading a Connected Foreman&#160;server</h4>
<div class="paragraph">
<p>Use this procedure for a Foreman&#160;server with access to the public internet</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
If you customize configuration files, manually or using a tool such as Hiera, these changes are overwritten when the installation script runs during upgrading or updating.
You can use the <code>--noop</code> option with the foreman-installer script to test for changes.
For more information, see the Red Hat Knowledgebase solution <a href="https://access.redhat.com/solutions/3351311">How to use the noop option to check for changes in Foreman config files during an upgrade.</a>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Upgrade Foreman&#160;server</div>
<ol class="arabic">
<li>
<p>Create a backup.</p>
<div class="ulist">
<ul>
<li>
<p>On a virtual machine, take a snapshot.</p>
</li>
<li>
<p>On a physical machine, create a backup.</p>
<div class="paragraph">
<p>For more information about backups, see <a href="https://docs.theforeman.org/3.5/Administering_Project/index-foreman-el.html#backing-up-foreman-server-and-smart-proxy_admin">Backing Up Foreman&#160;server and Smart&#160;Proxy&#160;server</a> in <em>Administering Foreman</em>.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Optional: If you made manual edits to DNS or DHCP configuration in the <code>/etc/zones.conf</code> or <code>/etc/dhcp/dhcpd.conf</code> files, back up the configuration files because the installer only supports one domain or subnet, and therefore restoring changes from these backups might be required.</p>
</li>
<li>
<p>Optional: If you made manual edits to DNS or DHCP configuration files and do not want to overwrite the changes, enter the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-installer --foreman-proxy-dns-managed=false \
--foreman-proxy-dhcp-managed=false</pre>
</div>
</div>
</li>
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>Discovered hosts</strong>.
On the Discovered Hosts page, power off and then delete the discovered hosts.
From the <strong>Select an Organization</strong> menu, select each organization in turn and repeat the process to power off and delete the discovered hosts.
Make a note to reboot these hosts when the upgrade is complete.</p>
</li>
<li>
<p>Update operating system packages:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># dnf update</pre>
</div>
</div>
</li>
<li>
<p>Update repositories</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># dnf update https://yum.theforeman.org/releases/3.5/el8/x86_64/foreman-release.rpm</pre>
</div>
</div>
</li>
<li>
<p>Ensure the module streams are enabled:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># dnf module enable foreman:el8</pre>
</div>
</div>
</li>
<li>
<p>Update the required packages:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># dnf update</pre>
</div>
</div>
</li>
<li>
<p>Stop all services:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-maintain service stop</pre>
</div>
</div>
</li>
<li>
<p>Run the installer:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-installer</pre>
</div>
</div>
</li>
<li>
<p>Determine if the system needs a reboot:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Check the version of newest installed kernel:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># rpm --query --last kernel | head -n 1</pre>
</div>
</div>
</li>
<li>
<p>Compare this to the version of currently running kernel:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># uname --kernel-release</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Optional: If the newest kernel differs from the currently running kernel, reboot the system:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># reboot</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="upgrading_capsule_server"><a class="anchor" href="#upgrading_capsule_server"></a>2.2. Upgrading Smart&#160;Proxy&#160;servers</h3>
<div class="paragraph">
<p>This section describes how to upgrade Smart&#160;Proxy&#160;servers from 3.4 to 3.5.</p>
</div>
<div class="ulist">
<div class="title">Before You Begin</div>
<ul>
<li>
<p>You must upgrade Foreman&#160;server before you can upgrade any Smart&#160;Proxy&#160;servers.
Note that you can upgrade Smart&#160;Proxies separately from Foreman.
For more information, see <a href="#Upgrading_Proxies_Separately_from_Server_upgrade-guide">Upgrading Smart&#160;Proxies Separately from Foreman</a>.</p>
</li>
<li>
<p>Ensure the Smart&#160;Proxy has the correct organization and location settings in the newly upgraded Foreman&#160;server.</p>
</li>
<li>
<p>Review and update your firewall configuration prior to upgrading your Smart&#160;Proxy&#160;server.
For more information, see <a href="https://docs.theforeman.org/3.5/Installing_Proxy/index-foreman-el.html#preparing-environment-for-capsule-installation">Preparing Your Environment for Smart&#160;Proxy Installation</a> in <em>Installing an External Smart&#160;Proxy&#160;Server 3.5</em>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Upgrading Smart&#160;Proxy&#160;servers</div>
<ol class="arabic">
<li>
<p>Create a backup.</p>
<div class="ulist">
<ul>
<li>
<p>On a virtual machine, take a snapshot.</p>
</li>
<li>
<p>On a physical machine, create a backup.</p>
<div class="paragraph">
<p>For information on backups, see <a href="https://docs.theforeman.org/3.5/Administering_Project/index-foreman-el.html#backing-up-foreman-server-and-smart-proxy_admin">Backing Up Foreman&#160;server and Smart&#160;Proxy&#160;server</a> in <em>Administering Foreman</em>.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Update repositories</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># dnf update https://yum.theforeman.org/releases/3.5/el8/x86_64/foreman-release.rpm</pre>
</div>
</div>
</li>
<li>
<p>Ensure the module streams are enabled:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># dnf module enable foreman:el8</pre>
</div>
</div>
</li>
<li>
<p>Update the required packages:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># dnf update</pre>
</div>
</div>
</li>
<li>
<p>Run the installer:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-installer</pre>
</div>
</div>
</li>
<li>
<p>Determine if the system needs a reboot:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Check the version of newest installed kernel:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># rpm --query --last kernel | head -n 1</pre>
</div>
</div>
</li>
<li>
<p>Compare this to the version of currently running kernel:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># uname --kernel-release</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Optional: If the newest kernel differs from the currently running kernel, reboot the system:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># reboot</pre>
</div>
</div>
</li>
<li>
<p>Optional: If you made manual edits to DNS or DHCP configuration files, check and restore any changes required to the DNS and DHCP configuration files using the backups made earlier.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Upgrading_the_External_Database_upgrade-guide"><a class="anchor" href="#Upgrading_the_External_Database_upgrade-guide"></a>2.3. Upgrading the External Database</h3>
<div class="paragraph">
<p>You can upgrade an external database from Enterprise Linux 7 to Enterprise Linux 8 while upgrading Foreman from 3.4 to 3.5.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Create a new Enterprise Linux 8 based host for PostgreSQL server that follows the external database on Enterprise Linux 8 documentation.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create a backup.</p>
</li>
<li>
<p>Restore the backup on the new server.</p>
</li>
<li>
<p>If Foreman reaches the new database server via the old name, no further changes are required.
Otherwise reconfigure Foreman to use the new name:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-installer \
--foreman-db-host <em>newpostgres.example.com</em> \
--katello-candlepin-db-host <em>newpostgres.example.com</em> \
--foreman-proxy-content-pulpcore-postgresql-host <em>newpostgres.example.com</em></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="performing-post-upgrade-tasks_upgrade-guide"><a class="anchor" href="#performing-post-upgrade-tasks_upgrade-guide"></a>2.4. Performing Post-Upgrade Tasks</h3>
<div class="paragraph">
<p>Some of the procedures in this section are optional.
You can choose to perform only those procedures that are relevant to your installation.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#upgrading_discovery_parent">Upgrading Discovery</a></p>
</li>
<li>
<p><a href="#migrating-ansible-content_upgrade-guide">Migrating Ansible Content</a></p>
</li>
<li>
<p><a href="#reclaiming-postgresql-space-after-an-upgrade_upgrade-guide">Reclaiming PostgreSQL Space</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="upgrading_discovery_parent"><a class="anchor" href="#upgrading_discovery_parent"></a>2.4.1. Upgrading Discovery</h4>
<div class="paragraph">
<p>If you use the PXE-based discovery process, then you must complete the discovery upgrade procedure on Foreman and on any Smart&#160;Proxy&#160;server with hosts that you want to be listed in Foreman on the <strong>Hosts</strong> &gt; <strong>Discovered hosts</strong> page.</p>
</div>
<div class="paragraph">
<p>This section describes updating the PXELinux template and the boot image passed to hosts that use PXE booting to register themselves with Foreman&#160;server.</p>
</div>
<div class="paragraph">
<p>From Foreman&#160;3.5, provisioning templates now have a separate association with a subnet, and do not default to using the TFTP Smart&#160;Proxy for that subnet.
If you create subnets after the upgrade, you must specifically enable the Foreman or a Smart&#160;Proxy to provide a proxy service for discovery templates and then configure all subnets with discovered hosts to use a specific <em>template Smart&#160;Proxy</em>.</p>
</div>
<div class="paragraph">
<p>During the upgrade, for every subnet with a TFTP proxy enabled, the template Smart&#160;Proxy is set to be the same as the TFTP Smart&#160;Proxy.
After the upgrade, check all subnets to verify this was set correctly.</p>
</div>
<div class="paragraph">
<p>These procedures are not required if you do not use PXE booting of hosts to enable Foreman to discover new hosts.</p>
</div>
<div class="sect4">
<h5 id="upgrading_discovery_satellite"><a class="anchor" href="#upgrading_discovery_satellite"></a>Upgrading Discovery on Foreman&#160;server</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Update the Discovery template in the Foreman web UI:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>Provisioning templates</strong>.</p>
</li>
<li>
<p>On the <code>PXELinux global default</code> line, click <strong>Clone</strong>.</p>
</li>
<li>
<p>Enter a new name for the template in the <strong>Name</strong> field, for example <code>ACME PXE global default</code>.</p>
</li>
<li>
<p>In the template editor field, change the line <code>ONTIMEOUT local</code> to <code>ONTIMEOUT discovery</code> and click <strong>Submit</strong>.</p>
</li>
<li>
<p>In the Foreman web UI, navigate to <strong>Administer</strong> &gt; <strong>Settings</strong>.</p>
</li>
<li>
<p>On the <strong>Provisioning</strong> tab, set <code>Default PXE global template entry</code> to a custom value for your environment.</p>
</li>
<li>
<p>Locate <code>Global default PXELinux template</code> and click on its <strong>Value</strong>.</p>
</li>
<li>
<p>Select the name of the newly created template from the menu and click <strong>Submit</strong>.</p>
</li>
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts</strong> &gt; <strong>Provisioning templates</strong>.</p>
</li>
<li>
<p>Click <strong>Build PXE Default</strong>, then click <strong>OK</strong>.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If the template is modified, a Foreman upgrade overrides it to its default version.
Once the PXE Default configuration is built, the template configured in the <strong>Settings</strong> is deployed to the TFTP.
This can result in deploying the default template if the new template is correctly set in the <strong>Settings</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>In the Foreman web UI, go to <strong>Configure</strong> &gt; <strong>Discovery Rules</strong> and associate selected organizations and locations with discovery rules.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="verify_subnets_have_a_template_capsule"><a class="anchor" href="#verify_subnets_have_a_template_capsule"></a>Verifying Subnets have a Template Smart&#160;Proxy</h5>
<div class="olist arabic">
<div class="title">Ensure all subnets with discovered hosts have a template Smart&#160;Proxy:</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Infrastructure</strong> &gt; <strong>Subnets</strong>.</p>
</li>
<li>
<p>Select the subnet you want to check.</p>
</li>
<li>
<p>On the <strong>Smart&#160;Proxies</strong> tab, ensure a <strong>Template Smart&#160;Proxy</strong> has been set for this subnet.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For more information about configuring subnets with template Smart&#160;Proxies, see <a href="https://docs.theforeman.org/3.5/Provisioning_Hosts/index-foreman-el.html#Configuring_the_Discovery_Service_provisioning">Configuring the Discovery Service</a> in <em>Provisioning Hosts</em>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="migrating-ansible-content_upgrade-guide"><a class="anchor" href="#migrating-ansible-content_upgrade-guide"></a>2.4.2. Migrating Ansible Content</h4>
<div class="paragraph">
<p>The upgrade from Enterprise Linux 7 to Enterprise Linux 8 includes an upgrade from Ansible Engine 2.9 to Ansible Core 2.12.</p>
</div>
<div class="paragraph">
<p>If you have custom Ansible content such as playbooks, job templates inside REX, roles and collections on disk, and you rely on modules being delivered by the Ansible RPM on Foreman, you have to take additional steps to adapt your Ansible installation or migrate your Ansible content.</p>
</div>
<div class="paragraph">
<p>Ansible Core contains only essential modules.
In terms of FQCN notation <code>namespace.collection.module</code>, you can continue to use <code>ansible.builtin.*</code>, but everything else is missing in Ansible Core.
That means you will be no longer able to use non-builtin Ansible modules as you were used to and you have to get them from another source, eventually.</p>
</div>
<div class="paragraph">
<p>You have the following options to handle your Ansible content after the upgrade:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You can obtain additional community-maintained collections that provide the non-essential functionality from Ansible Galaxy.
For more information, see <a href="https://docs.ansible.com/ansible/latest/galaxy/user_guide.html#installing-collections">Installing collections</a> in the <em>Galaxy User Guide</em>.</p>
</li>
<li>
<p>You can rewrite your Ansible roles, templates and other affected content.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If you want to download and install Ansible content on Smart&#160;Proxy that does not have a connection to an external Ansible Galaxy server, then you must pass the content through Foreman&#160;server instead of using the URL of the Ansible Galaxy server in the configuration on the Smart&#160;Proxy directly:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Sync the content from a Ansible Galaxy server to a custom repository on your Foreman&#160;server.</p>
</li>
<li>
<p>Configure Ansible on your Smart&#160;Proxy to download the content from Foreman&#160;server.</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To find out what content is affected after the upgrade, you can run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># ansible-lint --enable-list only-builtins -p <em>path/to/your/playbook/play.yml</em></pre>
</div>
</div>
<div class="paragraph">
<p>You need <code>ansible-lint</code> 6.1.0 or newer.
You can install it from <a href="https://pypi.org/project/ansible-lint/">pypi.org</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="reclaiming-postgresql-space-after-an-upgrade_upgrade-guide"><a class="anchor" href="#reclaiming-postgresql-space-after-an-upgrade_upgrade-guide"></a>2.4.3. Reclaiming PostgreSQL Space</h4>
<div class="paragraph">
<p>The PostgreSQL database can use a large amount of disk space especially in heavily loaded deployments.
Use this procedure to reclaim some of this disk space on Foreman.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Stop all services, except for the <code>postgresql</code> service:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-maintain service stop --exclude postgresql</pre>
</div>
</div>
</li>
<li>
<p>Switch to the <code>postgres</code> user and reclaim space on the database:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># su - postgres -c 'vacuumdb --full --all'</pre>
</div>
</div>
</li>
<li>
<p>Start the other services when the vacuum completes:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-maintain service start</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 3.5 (unsupported)<br>
Last updated Nov 2022
</div>
</div>
</body>
</html>